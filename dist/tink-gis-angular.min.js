/*! tink-gis-angular v1.0.0 */
"use strict";!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.navigation","tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination","tink.tooltip","ngAnimate","rzModule"])}JXON.config({attrPrefix:"",autoDate:!1,lowerCaseTags:!0});var originalOnTouch;L.AwesomeMarkers.Icon.prototype.options.prefix="fa";originalOnTouch=L.Draw.Polyline.prototype._onTouch,L.Draw.Polyline.prototype._onTouch=function(e){if("mouse"!=e.originalEvent.pointerType)return originalOnTouch.call(this,e)};module.factory("map",function(){var crsLambert=new L.Proj.CRS("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs",{origin:[-35872700,41422700],resolutions:[66.1459656252646,52.91677250021167,39.687579375158755,26.458386250105836,13.229193125052918,6.614596562526459,5.291677250021167,3.9687579375158752,3.3072982812632294,2.6458386250105836,1.9843789687579376,1.3229193125052918,.6614596562526459,.5291677250021167,.39687579375158755,.33072982812632296,.26458386250105836,.19843789687579377,.13229193125052918,.06614596562526459,.026458386250105836]}),map=L.map("map",{minZoom:0,maxZoom:20,crs:crsLambert,zoomControl:!1,drawControl:!1,attributionControl:!1}).setView([51.2192159,4.4028818],5);return L.control.scale({imperial:!1}).addTo(map),map.doubleClickZoom.disable(),map.featureGroup=L.featureGroup().addTo(map),map.extendFeatureGroup=L.featureGroup().addTo(map),map.on("draw:created",function(event){}),map.on("draw:drawstart",function(event){console.log("draw started")}),map.addToDrawings=function(layer){map.featureGroup.addLayer(layer)},map.clearDrawings=function(){map.featureGroup.clearLayers(),map.extendFeatureGroup.clearLayers()},map}),module.directive("preventDefaultMap",function(map){return{link:function(scope,element,attrs){L.DomEvent.disableClickPropagation(element.get(0)),element.on("dblclick",function(event){event.stopPropagation()}),element.on("mousemove",function(event){event.stopPropagation()})}}}),module.directive("preventDefault",function(map){return{link:function(scope,element,attrs){element.on("click",function(event){event.preventDefault(),event.stopPropagation()}),element.on("dblclick",function(event){event.stopPropagation()}),element.on("mousemove",function(event){event.stopPropagation()})}}}),module.directive("autoFocus",function($timeout){return{restrict:"AC",link:function(_scope,_element){$timeout(function(){_element[0].focus()},0)}}});var origOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(method,url){url.toLowerCase().includes("p_sik")&&(this.withCredentials=!0),origOpen.apply(this,arguments)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(L,undefined){L.Map.addInitHook(function(){this.whenReady(function(){L.Map.mergeOptions({preferCanvas:!0}),"exportError"in this||(this.exportError={wrongBeginSelector:"Селектор JQuery не имеет начальной скобки (",wrongEndSelector:"Селектор JQuery не заканчивается скобкой )",jqueryNotAvailable:"В опциях используется JQuery селектор, но JQuery не подключен.Подключите JQuery или используйте DOM-селекторы .class, #id или DOM-элементы",popupWindowBlocked:"Окно печати было заблокировано браузером. Пожалуйста разрешите всплывающие окна на этой странице",emptyFilename:"При выгрузке карты в виде файла не указано его имя"}),this.supportedCanvasMimeTypes=function(){if("_supportedCanvasMimeTypes"in this)return this._supportedCanvasMimeTypes;var mimeTypes={PNG:"image/png",JPEG:"image/jpeg",JPG:"image/jpg",GIF:"image/gif",BMP:"image/bmp",TIFF:"image/tiff",XICON:"image/x-icon",SVG:"image/svg+xml",WEBP:"image/webp"},canvas=document.createElement("canvas");canvas.style.display="none";var ctx=(canvas=document.body.appendChild(canvas)).getContext("2d");for(var type in ctx.fillStyle="red",ctx.fillRect(0,0,1,1),this._supportedCanvasMimeTypes={},mimeTypes){var mimeType=mimeTypes[type];mimeType===canvas.toDataURL(mimeType).replace(/^data:([^;]*).*/,"$1")&&(this._supportedCanvasMimeTypes[type]=mimeType)}return document.body.removeChild(canvas),this._supportedCanvasMimeTypes},this.export=function(options){var caption={},exclude=[],format="image/png";if("caption"in(options=options||{caption:{},exclude:[]})&&"position"in(caption=options.caption)){var position=caption.position;Array.isArray(position)||(position=[0,0]),2!=position.length&&(0===position.length&&(position[0]=0),1===position.length&&(position[1]=0)),"number"!=typeof position[0]&&"string"==typeof position[0]&&(position[0]=parseInt(position[0]),isNaN(position[0])&&(position[0]=0)),"number"!=typeof position[1]&&"string"==typeof position[1]&&(position[1]=parseInt(position[1]),isNaN(position[1])&&(position[1]=0)),caption.position=position}"exclude"in options&&Array.isArray(options.exclude)&&(exclude=options.exclude),"format"in options&&(format=options.format);var afterRender=options.afterRender;"function"!=typeof afterRender&&(afterRender=function(result){return result});var afterExport=options.afterExport;"function"!=typeof afterExport&&(afterExport=function(result){return result});for(var container=options.container||this._container,hide=[],i=0;i<exclude.length;i++){var selector=exclude[i];switch(void 0===selector?"undefined":_typeof(selector)){case"object":"tagName"in selector&&hide.push(selector);break;case"string":switch(selector.substr(0,1)){case".":for(var elements=container.getElementsByClassName(selector.substr(1)),j=0;j<elements.length;j++)hide.push(elements.item(j));break;case"#":var element=container.getElementById(selector.substr(1));element&&hide.push(element);break;case"$":var jQuerySelector=selector.trim().substr(1);if("("!==jQuerySelector.substr(0,1))throw new Error(this.exportError.wrongBeginSelector);if(")"!==(jQuerySelector=jQuerySelector.substr(1)).substr(-1))throw new Error(this.exportError.wrongEndSelector);if(jQuerySelector=jQuerySelector.substr(0,jQuerySelector.length-1),"undefined"==typeof jQuery)throw new Error(this.exportError.jqueryNotAvailable);for(elements=$(jQuerySelector,container),j=0;j<elements.length;j++)hide.push(elements[i])}}}for(i=0;i<hide.length;i++)hide[i].setAttribute("data-html2canvas-ignore","true");return html2canvas(container,{useCORS:!0}).then(afterRender).then(function(canvas){for(var i=0;i<hide.length;i++)hide[i].removeAttribute("data-html2canvas-ignore");if("text"in caption&&caption.text){var x,y;"position"in caption?(x=caption.position[0],y=caption.position[1]):y=x=0;var ctx=canvas.getContext("2d");"font"in caption&&(ctx.font=caption.font),"fillStyle"in caption&&(ctx.fillStyle=caption.fillStyle),ctx.fillText(caption.text,x,y)}return"canvas"===format?canvas:{data:canvas.toDataURL(format),width:canvas.width,height:canvas.height,type:format}},function(reason){alert(reason)}).then(afterExport)},this.printExport=function(options){options=options||{};var _this=this,images=[];return Array.isArray(options)?function _runPrintTasks(options,index){return(options[index].export||_this.export)(options[index]).then(function(result){return images.push(result),index<options.length-1?_runPrintTasks(options,index+1):images})}(options,0).then(function(result){return _this._printExport(options,result)}):(options.export||this.export)(options).then(function(result){return _this._printExport(options,[result])})},this._printExport=function(options,images){var printWindow=window.open("","_blank");if(!printWindow)throw new Error(this.exportError.popupWindowBlocked);var printDocument=printWindow.document;return printDocument.write("<html><head><style>@media print { @page { padding: 0; margin: 0; } }</style><title>"+(options.text?options.text:"")+"</title></head><body onload='window.print(); window.close();'></body></html>"),images.forEach(function(image){var img=printDocument.createElement("img");img.height=image.height-20,img.width=image.width-10,img.src=image.data,printDocument.body.appendChild(img)}),printDocument.close(),printWindow.focus(),images},this.downloadExport=function(options){return options=options||{},Array.isArray(options)?this._runDownloadTasks(options,0):this._downloadExport(options)},this._runDownloadTasks=function(options,index){var _this=this,i=index;return this._downloadExport(options[i]).then(function(result){return++i<options.length?_this._runDownloadTasks(options,i).then(function(tasksResult){return[result].concat(tasksResult)}):[result]})},this._downloadExport=function(options){if(!("fileName"in options))throw new Error(this.exportError.emptyFilename);var exportMethod=options.export||this.export,fileName=options.fileName;delete options.fileName;return exportMethod(options).then(function(result){for(var blob,fileData=atob(result.data.split(",")[1]),arrayBuffer=new ArrayBuffer(fileData.length),view=new Uint8Array(arrayBuffer),i=0;i<fileData.length;i++)view[i]=255&fileData.charCodeAt(i);if("function"==typeof Blob)blob=new Blob([arrayBuffer],{type:"application/octet-stream"});else{var blobBuilder=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);blobBuilder.append(arrayBuffer),blob=blobBuilder.getBlob("application/octet-stream")}if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(blob,fileName);else{var blobUrl=(window.URL||window.webkitURL).createObjectURL(blob),downloadLink=document.createElement("a");downloadLink.style="display: none",downloadLink.download=fileName,downloadLink.href=blobUrl,document.body.appendChild(downloadLink),downloadLink.click(),document.body.removeChild(downloadLink)}return result})}})})}(L);_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(t,e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){function t(t,e){return t(e={exports:{}},e.exports),e.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=t(function(t){!function(e){function n(t,e){return function(t){void 0===t.imagePlaceholder?w.impl.options.imagePlaceholder=M.imagePlaceholder:w.impl.options.imagePlaceholder=t.imagePlaceholder,void 0===t.cacheBust?w.impl.options.cacheBust=M.cacheBust:w.impl.options.cacheBust=t.cacheBust}(e=e||{}),Promise.resolve(t).then(function(t){return function(t,e,n){return n||!e||e(t)?Promise.resolve(t).then(function(t){return t instanceof HTMLCanvasElement?h.makeImage(t.toDataURL()):t.cloneNode(!1)}).then(function(n){return function(t,e,n){var i=t.childNodes;return 0===i.length?Promise.resolve(e):function(t,e,n){var i=Promise.resolve();return e.forEach(function(e){i=i.then(function(){return u(e,n)}).then(function(e){e&&t.appendChild(e)})}),i}(e,h.asArray(i),n).then(function(){return e})}(t,n,e)}).then(function(e){return function(t,e){return e instanceof Element?Promise.resolve().then(function(){!function(t,e){t.cssText?e.cssText=t.cssText:function(t,e){h.asArray(t).forEach(function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))})}(t,e)}(window.getComputedStyle(t),e.style)}).then(function(){function n(n){var i=window.getComputedStyle(t,n),o=i.getPropertyValue("content");if(""!==o&&"none"!==o){var r=h.uid();e.className=e.className+" "+r;var a=document.createElement("style");a.appendChild(function(t,e,n){var i="."+t+":"+e,o=n.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(n):function(t){return h.asArray(t).map(function(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(i+"{"+o+"}")}(r,n,i)),e.appendChild(a)}}[":before",":after"].forEach(function(t){n(t)})}).then(function(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}).then(function(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach(function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)}))}).then(function(){return e}):e}(t,e)}):Promise.resolve()}(t,e.filter,!0)}).then(c).then(d).then(function(t){return e.bgcolor&&(t.style.backgroundColor=e.bgcolor),e.width&&(t.style.width=e.width+"px"),e.height&&(t.style.height=e.height+"px"),e.style&&Object.keys(e.style).forEach(function(n){t.style[n]=e.style[n]}),t}).then(function(n){return function(t,e,n){return Promise.resolve(t).then(function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(t)}).then(h.escapeXhtml).then(function(t){return'<foreignObject x="0" y="0" width="100%" height="100%">'+t+"</foreignObject>"}).then(function(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+n+'">'+t+"</svg>"}).then(function(t){return"data:image/svg+xml;charset=utf-8,"+t})}(n,e.width||h.width(t),e.height||h.height(t))})}function l(t,e){function i(t){var n=document.createElement("canvas");if(n.width=e.width||h.width(t),n.height=e.height||h.height(t),e.bgcolor){var i=n.getContext("2d");i.fillStyle=e.bgcolor,i.fillRect(0,0,n.width,n.height)}return n}return n(t,e).then(h.makeImage).then(h.delay(100)).then(function(e){var n=i(t);return n.getContext("2d").drawImage(e,0,0),n})}function u(t,e,n){function i(t){return t instanceof HTMLCanvasElement?h.makeImage(t.toDataURL()):t.cloneNode(!1)}function o(t,e,n){var i=t.childNodes;return 0===i.length?Promise.resolve(e):function(t,e,n){var i=Promise.resolve();return e.forEach(function(e){i=i.then(function(){return u(e,n)}).then(function(e){e&&t.appendChild(e)})}),i}(e,h.asArray(i),n).then(function(){return e})}function r(t,e){function n(){!function(t,e){t.cssText?e.cssText=t.cssText:function(t,e){h.asArray(t).forEach(function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))})}(t,e)}(window.getComputedStyle(t),e.style)}function i(){function n(n){var i=window.getComputedStyle(t,n),o=i.getPropertyValue("content");if(""!==o&&"none"!==o){var r=h.uid();e.className=e.className+" "+r;var a=document.createElement("style");a.appendChild(function(t,e,n){var i="."+t+":"+e,o=n.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(n):function(t){function e(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}return h.asArray(t).map(e).join("; ")+";"}(n);return document.createTextNode(i+"{"+o+"}")}(r,n,i)),e.appendChild(a)}}[":before",":after"].forEach(function(t){n(t)})}function o(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}function r(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach(function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)}))}return e instanceof Element?Promise.resolve().then(n).then(i).then(o).then(r).then(function(){return e}):e}return n||!e||e(t)?Promise.resolve(t).then(i).then(function(n){return o(t,n,e)}).then(function(e){return r(t,e)}):Promise.resolve()}function c(t){return p.resolveAll().then(function(e){var n=document.createElement("style");return t.appendChild(n),n.appendChild(document.createTextNode(e)),t})}function d(t){return f.inlineAll(t).then(function(){return t})}var h=function(){function e(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function f(t,e){var n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(n){var i=e(n).toLowerCase();return function(){var t="application/font-woff",e="image/jpeg";return{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:e,jpeg:e,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[i]||""},dataAsUrl:function(t,e){return"data:"+e+";base64,"+t},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):function(t){return new Promise(function(e){for(var n=window.atob(t.toDataURL().split(",")[1]),i=n.length,o=new Uint8Array(i),r=0;r<i;r++)o[r]=n.charCodeAt(r);e(new Blob([o],{type:"image/png"}))})}(t)},resolveUrl:function(t,e){var n=document.implementation.createHTMLDocument(),i=n.createElement("base");n.head.appendChild(i);var o=n.createElement("a");return n.body.appendChild(o),i.href=e,o.href=t,o.href},getAndEncode:function(t){var e=3e4;return w.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime()),new Promise(function(n){function r(t){console.error(t),n("")}var s,a=new XMLHttpRequest;if(a.onreadystatechange=function(){if(4===a.readyState){if(200!==a.status)return void(s?n(s):r("cannot fetch resource: "+t+", status: "+a.status));var e=new FileReader;e.onloadend=function(){var t=e.result.split(/,/)[1];n(t)},e.readAsDataURL(a.response)}},a.ontimeout=function(){s?n(s):r("timeout of "+e+"ms occured while fetching resource: "+t)},a.responseType="blob",a.timeout=e,a.open("GET",t,!0),a.send(),w.impl.options.imagePlaceholder){var l=w.impl.options.imagePlaceholder.split(/,/);l&&l[1]&&(s=l[1])}})},uid:function(){var t=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+t++}}(),delay:function(t){return function(e){return new Promise(function(n){setTimeout(function(){n(e)},t)})}},asArray:function(t){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e},escapeXhtml:function(t){return t.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){e(i)},i.onerror=n,i.src=t})},width:function(t){var e=f(t,"border-left-width"),n=f(t,"border-right-width");return t.scrollWidth+e+n},height:function(t){var e=f(t,"border-top-width"),n=f(t,"border-bottom-width");return t.scrollHeight+e+n}}}(),m=function(){function t(t){return-1!==t.search(o)}function e(t){for(var e,n=[];null!==(e=o.exec(t));)n.push(e[1]);return n.filter(function(t){return!h.isDataUrl(t)})}function n(t,e,n,i){return Promise.resolve(e).then(function(t){return n?h.resolveUrl(t,n):t}).then(i||h.getAndEncode).then(function(t){return h.dataAsUrl(t,h.mimeType(e))}).then(function(n){return t.replace(function(t){return new RegExp("(url\\(['\"]?)("+h.escape(t)+")(['\"]?\\))","g")}(e),"$1"+n+"$3")})}var o=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(i,o,r){return t(i)?Promise.resolve(i).then(e).then(function(t){var e=Promise.resolve(i);return t.forEach(function(t){e=e.then(function(e){return n(e,t,o,r)})}),e}):Promise.resolve(i)},shouldProcess:t,impl:{readUrls:e,inline:n}}}(),p=function(){function e(){function n(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return m.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}return Promise.resolve(h.asArray(document.styleSheets)).then(function(t){var e=[];return t.forEach(function(t){try{h.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),e}).then(function(t){return t.filter(function(t){return t.type===CSSRule.FONT_FACE_RULE}).filter(function(t){return m.shouldProcess(t.style.getPropertyValue("src"))})}).then(function(t){return t.map(n)})}return{resolveAll:function(){return e(document).then(function(t){return Promise.all(t.map(function(t){return t.resolve()}))}).then(function(t){return t.join("\n")})},impl:{readAll:e}}}(),f=function(){function t(t){return{inline:function(e){return h.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||h.getAndEncode).then(function(e){return h.dataAsUrl(e,h.mimeType(t.src))}).then(function(e){return new Promise(function(n,i){t.onload=n,t.onerror=i,t.src=e})})}}}return{inlineAll:function e(n){return n instanceof Element?function(t){var e=t.style.getPropertyValue("background");return e?m.inlineAll(e).then(function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))}).then(function(){return t}):Promise.resolve(t)}(n).then(function(){return n instanceof HTMLImageElement?t(n).inline():Promise.all(h.asArray(n.childNodes).map(function(t){return e(t)}))}):Promise.resolve(n)},impl:{newImage:t}}}(),M={imagePlaceholder:void 0,cacheBust:!1},w={toSvg:n,toPng:function(t,e){return l(t,e||{}).then(function(t){return t.toDataURL()})},toJpeg:function(t,e){return l(t,e=e||{}).then(function(t){return t.toDataURL("image/jpeg",e.quality||1)})},toBlob:function(t,e){return l(t,e||{}).then(h.canvasToBlob)},toPixelData:function(t,e){return l(t,e||{}).then(function(e){return e.getContext("2d").getImageData(0,0,h.width(t),h.height(t)).data})},impl:{fontFaces:p,images:f,util:h,inliner:m,options:{}}};t.exports=w}()}),i=t(function(t){var n=n||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in i,a=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},u=function(t){setTimeout(function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()},4e4)},c=function(t,e,n){for(var i=(e=[].concat(e)).length;i--;){var o=t["on"+e[i]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){l(t)}}},d=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},g=function(e,l,_g){_g||(e=d(e));var h,m=this,f="application/octet-stream"===e.type,M=function(){c(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,o)return h=n().createObjectURL(e),void setTimeout(function(){var t,e;i.href=h,i.download=l,t=i,e=new MouseEvent("click"),t.dispatchEvent(e),M(),u(h),m.readyState=m.DONE});!function(){if((s||f&&a)&&t.FileReader){var i=new FileReader;return i.onloadend=function(){var e=s?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,m.readyState=m.DONE,M()},i.readAsDataURL(e),m.readyState=m.INIT}h||(h=n().createObjectURL(e)),f?t.location.href=h:t.open(h,"_blank")||(t.location.href=h),m.readyState=m.DONE,M(),u(h)}()},h=g.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=d(t)),navigator.msSaveOrOpenBlob(t,e)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(t,e,n){return new g(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||e.content);t.exports&&(t.exports.saveAs=n)});L.Control.EasyPrint=L.Control.extend({options:{title:"Print map",position:"topleft",sizeModes:["Current"],filename:"map",exportOnly:!1,hidden:!1,tileWait:500,hideControlContainer:!0,customWindowTitle:window.document.title,spinnerBgCOlor:"#0DC5C1",customSpinnerClass:"epLoader",defaultSizeTitles:{Current:"Current Size",A4Landscape:"A4 Landscape",A4Portrait:"A4 Portrait"}},onAdd:function(){this.mapContainer=this._map.getContainer(),this.options.sizeModes=this.options.sizeModes.map(function(t){return"Current"===t?{name:this.options.defaultSizeTitles.Current,className:"CurrentSize"}:"A4Landscape"===t?{height:this._a4PageSize.height,width:this._a4PageSize.width,name:this.options.defaultSizeTitles.A4Landscape,className:"A4Landscape page"}:"A4Portrait"===t?{height:this._a4PageSize.width,width:this._a4PageSize.height,name:this.options.defaultSizeTitles.A4Portrait,className:"A4Portrait page"}:t},this);var t=L.DomUtil.create("div","leaflet-control-easyPrint leaflet-bar leaflet-control");if(!this.options.hidden){this._addCss(),L.DomEvent.addListener(t,"mouseover",this._togglePageSizeButtons,this),L.DomEvent.addListener(t,"mouseout",this._togglePageSizeButtons,this);var e="leaflet-control-easyPrint-button";this.options.exportOnly&&(e+="-export"),this.link=L.DomUtil.create("a",e,t),this.link.id="leafletEasyPrint",this.link.title=this.options.title,this.holder=L.DomUtil.create("ul","easyPrintHolder",t),this.options.sizeModes.forEach(function(t){var e=L.DomUtil.create("li","easyPrintSizeMode",this.holder);e.title=t.name,L.DomUtil.create("a",t.className,e),L.DomEvent.addListener(e,"click",this.printMap,this)},this),L.DomEvent.disableClickPropagation(t)}return t},printMap:function(t,e){e&&(this.options.filename=e),this.options.exportOnly||(this._page=window.open("","_blank","toolbar=no,status=no,menubar=no,scrollbars=no,resizable=no,left=10, top=10, width=200, height=250, visible=none"),this._page.document.write(this._createSpinner(this.options.customWindowTitle,this.options.customSpinnerClass,this.options.spinnerBgCOlor))),this.originalState={mapWidth:this.mapContainer.style.width,widthWasAuto:!1,widthWasPercentage:!1,mapHeight:this.mapContainer.style.height,zoom:this._map.getZoom(),center:this._map.getCenter()},"auto"===this.originalState.mapWidth?(this.originalState.mapWidth=this._map.getSize().x+"px",this.originalState.widthWasAuto=!0):this.originalState.mapWidth.includes("%")&&(this.originalState.percentageWidth=this.originalState.mapWidth,this.originalState.widthWasPercentage=!0,this.originalState.mapWidth=this._map.getSize().x+"px"),this._map.fire("easyPrint-start",{event:t}),this.options.hidden||this._togglePageSizeButtons({type:null}),this.options.hideControlContainer&&this._toggleControls();var n="string"!=typeof t?t.target.className:t;if("CurrentSize"===n)return this._printOpertion(n);this.outerContainer=this._createOuterContainer(this.mapContainer),this.originalState.widthWasAuto&&(this.outerContainer.style.width=this.originalState.mapWidth),this._createImagePlaceholder(n)},_createImagePlaceholder:function(t){var e=this;n.toPng(this.mapContainer,{width:parseInt(this.originalState.mapWidth.replace("px")),height:parseInt(this.originalState.mapHeight.replace("px"))}).then(function(n){e.blankDiv=document.createElement("div");var i=e.blankDiv;e.outerContainer.parentElement.insertBefore(i,e.outerContainer),i.className="epHolder",i.style.backgroundImage='url("'+n+'")',i.style.position="absolute",i.style.zIndex=1011,i.style.display="initial",i.style.width=e.originalState.mapWidth,i.style.height=e.originalState.mapHeight,e._resizeAndPrintMap(t)}).catch(function(t){console.error("oops, something went wrong!",t)})},_resizeAndPrintMap:function(t){this.outerContainer.style.opacity=0;var e=this.options.sizeModes.filter(function(e){return e.className===t});e=e[0],this.mapContainer.style.width=e.width+"px",this.mapContainer.style.height=e.height+"px",this.mapContainer.style.width>this.mapContainer.style.height?this.orientation="portrait":this.orientation="landscape",this._map.setView(this.originalState.center),this._map.setZoom(this.originalState.zoom),this._map.invalidateSize(),this.options.tileLayer?this._pausePrint(t):this._printOpertion(t)},_pausePrint:function(t){var e=this,n=setInterval(function(){e.options.tileLayer.isLoading()||(clearInterval(n),e._printOpertion(t))},e.options.tileWait)},_printOpertion:function(t){var e=this,o=this.mapContainer.style.width;(this.originalState.widthWasAuto&&"CurrentSize"===t||this.originalState.widthWasPercentage&&"CurrentSize"===t)&&(o=this.originalState.mapWidth),n.toPng(e.mapContainer,{width:parseInt(o),height:parseInt(e.mapContainer.style.height.replace("px"))}).then(function(t){var n=e._dataURItoBlob(t);e.options.exportOnly?i.saveAs(n,e.options.filename+".png"):e._sendToBrowserPrint(t,e.orientation),e._toggleControls(!0),e.outerContainer&&(e.originalState.widthWasAuto?e.mapContainer.style.width="auto":e.originalState.widthWasPercentage?e.mapContainer.style.width=e.originalState.percentageWidth:e.mapContainer.style.width=e.originalState.mapWidth,e.mapContainer.style.height=e.originalState.mapHeight,e._removeOuterContainer(e.mapContainer,e.outerContainer,e.blankDiv),e._map.invalidateSize(),e._map.setView(e.originalState.center),e._map.setZoom(e.originalState.zoom)),e._map.fire("easyPrint-finished")}).catch(function(t){console.error("Print operation failed",t)})},_sendToBrowserPrint:function(t,e){this._page.resizeTo(600,800);var n=this._createNewWindow(t,e,this);this._page.document.body.innerHTML="",this._page.document.write(n),this._page.document.close()},_createSpinner:function(t,e,n){return"<html><head><title>"+t+"</title></head><body><style>\n      body{\n        background: "+n+";\n      }\n      .epLoader,\n      .epLoader:before,\n      .epLoader:after {\n        border-radius: 50%;\n      }\n      .epLoader {\n        color: #ffffff;\n        font-size: 11px;\n        text-indent: -99999em;\n        margin: 55px auto;\n        position: relative;\n        width: 10em;\n        height: 10em;\n        box-shadow: inset 0 0 0 1em;\n        -webkit-transform: translateZ(0);\n        -ms-transform: translateZ(0);\n        transform: translateZ(0);\n      }\n      .epLoader:before,\n      .epLoader:after {\n        position: absolute;\n        content: '';\n      }\n      .epLoader:before {\n        width: 5.2em;\n        height: 10.2em;\n        background: #0dc5c1;\n        border-radius: 10.2em 0 0 10.2em;\n        top: -0.1em;\n        left: -0.1em;\n        -webkit-transform-origin: 5.2em 5.1em;\n        transform-origin: 5.2em 5.1em;\n        -webkit-animation: load2 2s infinite ease 1.5s;\n        animation: load2 2s infinite ease 1.5s;\n      }\n      .epLoader:after {\n        width: 5.2em;\n        height: 10.2em;\n        background: #0dc5c1;\n        border-radius: 0 10.2em 10.2em 0;\n        top: -0.1em;\n        left: 5.1em;\n        -webkit-transform-origin: 0px 5.1em;\n        transform-origin: 0px 5.1em;\n        -webkit-animation: load2 2s infinite ease;\n        animation: load2 2s infinite ease;\n      }\n      @-webkit-keyframes load2 {\n        0% {\n          -webkit-transform: rotate(0deg);\n          transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n        }\n      }\n      @keyframes load2 {\n        0% {\n          -webkit-transform: rotate(0deg);\n          transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n        }\n      }\n      </style>\n    <div class=\""+e+'">Loading...</div></body></html>'},_createNewWindow:function(t,e,n){return"<html><head>\n        <style>@media print {\n          img { max-width: 98%!important; max-height: 98%!important; }\n          @page { size: "+e+";}}\n        </style>\n        <script>function step1(){\n        setTimeout('step2()', 10);}\n        function step2(){window.print();window.close()}\n        <\/script></head><body onload='step1()'>\n        <img src=\""+t+'" style="display:block; margin:auto;"></body></html>'},_createOuterContainer:function(t){var e=document.createElement("div");return t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t),e.appendChild(t),e.style.width=t.style.width,e.style.height=t.style.height,e.style.display="inline-block",e.style.overflow="hidden",e},_removeOuterContainer:function(t,e,n){e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(n),e.parentNode.removeChild(e))},_addCss:function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=".leaflet-control-easyPrint-button { \n      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8cGF0aCBkPSJNMTI4LDMyaDI1NnY2NEgxMjhWMzJ6IE00ODAsMTI4SDMyYy0xNy42LDAtMzIsMTQuNC0zMiwzMnYxNjBjMCwxNy42LDE0LjM5OCwzMiwzMiwzMmg5NnYxMjhoMjU2VjM1Mmg5NiAgIGMxNy42LDAsMzItMTQuNCwzMi0zMlYxNjBDNTEyLDE0Mi40LDQ5Ny42LDEyOCw0ODAsMTI4eiBNMzUyLDQ0OEgxNjBWMjg4aDE5MlY0NDh6IE00ODcuMTk5LDE3NmMwLDEyLjgxMy0xMC4zODcsMjMuMi0yMy4xOTcsMjMuMiAgIGMtMTIuODEyLDAtMjMuMjAxLTEwLjM4Ny0yMy4yMDEtMjMuMnMxMC4zODktMjMuMiwyMy4xOTktMjMuMkM0NzYuODE0LDE1Mi44LDQ4Ny4xOTksMTYzLjE4Nyw0ODcuMTk5LDE3NnoiIGZpbGw9IiMwMDAwMDAiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);\n      background-size: 16px 16px; \n      cursor: pointer; \n    }\n    .leaflet-control-easyPrint-button-export { \n      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDQzMy41IDQzMy41IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0MzMuNSA0MzMuNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnIGlkPSJmaWxlLWRvd25sb2FkIj4KCQk8cGF0aCBkPSJNMzk1LjI1LDE1M2gtMTAyVjBoLTE1M3YxNTNoLTEwMmwxNzguNSwxNzguNUwzOTUuMjUsMTUzeiBNMzguMjUsMzgyLjV2NTFoMzU3di01MUgzOC4yNXoiIGZpbGw9IiMwMDAwMDAiLz4KCTwvZz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);\n      background-size: 16px 16px; \n      cursor: pointer; \n    }\n    .easyPrintHolder a {\n      background-size: 16px 16px;\n      cursor: pointer;\n    }\n    .easyPrintHolder .CurrentSize{\n      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTZweCIgdmVyc2lvbj0iMS4xIiBoZWlnaHQ9IjE2cHgiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNjQgNjQiPgogIDxnPgogICAgPGcgZmlsbD0iIzFEMUQxQiI+CiAgICAgIDxwYXRoIGQ9Ik0yNS4yNTUsMzUuOTA1TDQuMDE2LDU3LjE0NVY0Ni41OWMwLTEuMTA4LTAuODk3LTIuMDA4LTIuMDA4LTIuMDA4QzAuODk4LDQ0LjU4MiwwLDQ1LjQ4MSwwLDQ2LjU5djE1LjQwMiAgICBjMCwwLjI2MSwwLjA1MywwLjUyMSwwLjE1NSwwLjc2N2MwLjIwMywwLjQ5MiwwLjU5NCwwLjg4MiwxLjA4NiwxLjA4N0MxLjQ4Niw2My45NDcsMS43NDcsNjQsMi4wMDgsNjRoMTUuNDAzICAgIGMxLjEwOSwwLDIuMDA4LTAuODk4LDIuMDA4LTIuMDA4cy0wLjg5OC0yLjAwOC0yLjAwOC0yLjAwOEg2Ljg1NWwyMS4yMzgtMjEuMjRjMC43ODQtMC43ODQsMC43ODQtMi4wNTUsMC0yLjgzOSAgICBTMjYuMDM5LDM1LjEyMSwyNS4yNTUsMzUuOTA1eiIgZmlsbD0iIzAwMDAwMCIvPgogICAgICA8cGF0aCBkPSJtNjMuODQ1LDEuMjQxYy0wLjIwMy0wLjQ5MS0wLjU5NC0wLjg4Mi0xLjA4Ni0xLjA4Ny0wLjI0NS0wLjEwMS0wLjUwNi0wLjE1NC0wLjc2Ny0wLjE1NGgtMTUuNDAzYy0xLjEwOSwwLTIuMDA4LDAuODk4LTIuMDA4LDIuMDA4czAuODk4LDIuMDA4IDIuMDA4LDIuMDA4aDEwLjU1NmwtMjEuMjM4LDIxLjI0Yy0wLjc4NCwwLjc4NC0wLjc4NCwyLjA1NSAwLDIuODM5IDAuMzkyLDAuMzkyIDAuOTA2LDAuNTg5IDEuNDIsMC41ODlzMS4wMjctMC4xOTcgMS40MTktMC41ODlsMjEuMjM4LTIxLjI0djEwLjU1NWMwLDEuMTA4IDAuODk3LDIuMDA4IDIuMDA4LDIuMDA4IDEuMTA5LDAgMi4wMDgtMC44OTkgMi4wMDgtMi4wMDh2LTE1LjQwMmMwLTAuMjYxLTAuMDUzLTAuNTIyLTAuMTU1LTAuNzY3eiIgZmlsbD0iIzAwMDAwMCIvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg==)\n    }\n    .easyPrintHolder .page {\n      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4xLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDQ0NC44MzMgNDQ0LjgzMyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDQ0LjgzMyA0NDQuODMzOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij4KPGc+Cgk8Zz4KCQk8cGF0aCBkPSJNNTUuMjUsNDQ0LjgzM2gzMzQuMzMzYzkuMzUsMCwxNy03LjY1LDE3LTE3VjEzOS4xMTdjMC00LjgxNy0xLjk4My05LjM1LTUuMzgzLTEyLjQ2N0wyNjkuNzMzLDQuNTMzICAgIEMyNjYuNjE3LDEuNywyNjIuMzY3LDAsMjU4LjExNywwSDU1LjI1Yy05LjM1LDAtMTcsNy42NS0xNywxN3Y0MTAuODMzQzM4LjI1LDQzNy4xODMsNDUuOSw0NDQuODMzLDU1LjI1LDQ0NC44MzN6ICAgICBNMzcyLjU4MywxNDYuNDgzdjAuODVIMjU2LjQxN3YtMTA4LjhMMzcyLjU4MywxNDYuNDgzeiBNNzIuMjUsMzRoMTUwLjE2N3YxMzAuMzMzYzAsOS4zNSw3LjY1LDE3LDE3LDE3aDEzMy4xNjd2MjI5LjVINzIuMjVWMzR6ICAgICIgZmlsbD0iIzAwMDAwMCIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=);\n    }\n    .easyPrintHolder .A4Landscape { \n      transform: rotate(-90deg);\n    }\n\n    .leaflet-control-easyPrint-button{\n      display: inline-block;\n    }\n    .easyPrintHolder{\n      margin-top:-31px;\n      margin-bottom: -5px;\n      margin-left: 30px;\n      padding-left: 0px;\n      display: none;\n    }\n\n    .easyPrintSizeMode {\n      display: inline-block;\n    }\n    .easyPrintHolder .easyPrintSizeMode a {\n      border-radius: 0px;\n    }\n\n    .easyPrintHolder .easyPrintSizeMode:last-child a{\n      border-top-right-radius: 2px;\n      border-bottom-right-radius: 2px;\n      margin-left: -1px;\n    }\n\n    .easyPrintPortrait:hover, .easyPrintLandscape:hover{\n      background-color: #757570;\n      cursor: pointer;\n    }",document.body.appendChild(t)},_dataURItoBlob:function(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),o=new DataView(i),r=0;r<e.length;r++)o.setUint8(r,e.charCodeAt(r));return new Blob([i],{type:n})},_togglePageSizeButtons:function(t){var e=this.holder.style,n=this.link.style;"mouseover"===t.type?(e.display="block",n.borderTopRightRadius="0",n.borderBottomRightRadius="0"):(e.display="none",n.borderTopRightRadius="2px",n.borderBottomRightRadius="2px")},_toggleControls:function(t){var e=document.getElementsByClassName("leaflet-control-container")[0];if(t)return e.style.display="block";e.style.display="none"},_a4PageSize:{height:715,width:1045}}),L.easyPrint=function(t){return new L.Control.EasyPrint(t)}});var Msg=function(data){this.data=[],data&&(0==data.indexOf("NTLM ")&&(data=data.substr(5)),atob(data).split("").map(function(c){this.push(c.charCodeAt(0))},this.data))};Msg.prototype.addByte=function(b){this.data.push(b)},Msg.prototype.addShort=function(s){this.data.push(255&s),this.data.push(s>>8&255)},Msg.prototype.addString=function(str,utf16){utf16&&(str=str.split("").map(function(c){return c+"\0"}).join(""));for(var i=0;i<str.length;i++)this.data.push(str.charCodeAt(i))},Msg.prototype.getString=function(offset,length){for(var result="",i=0;i<length;i++){if(offset+i>=this.data.length)return"";result+=String.fromCharCode(this.data[offset+i])}return result},Msg.prototype.getByte=function(offset){return this.data[offset]},Msg.prototype.toBase64=function(){var str=String.fromCharCode.apply(null,this.data);return btoa(str).replace(/.{76}(?=.)/g,"$&")};var Ntlm={domain:null,username:null,lmHashedPassword:null,ntHashedPassword:null,error:function(msg){console.error(msg)},message:function(msg){console.log(msg)},createMessage1:function(hostname){var msg1=new Msg;return msg1.addString("NTLMSSP\0"),msg1.addByte(1),msg1.addString("\0\0\0"),msg1.addShort(45571),msg1.addString("\0\0"),msg1.addShort(Ntlm.domain.length),msg1.addShort(Ntlm.domain.length),msg1.addShort(32+hostname.length),msg1.addString("\0\0"),msg1.addShort(hostname.length),msg1.addShort(hostname.length),msg1.addShort(32),msg1.addString("\0\0"),msg1.addString(hostname.toUpperCase()),msg1.addString(Ntlm.domain.toUpperCase()),msg1},getChallenge:function(data){var msg2=new Msg(data);return"NTLMSSP\0"!=msg2.getString(0,8)?(Ntlm.error("Invalid NTLM response header."),""):2!=msg2.getByte(8)?(Ntlm.error("Invalid NTLM response type."),""):msg2.getString(24,8)},createMessage3:function(challenge,hostname){var lmResponse=Ntlm.buildResponse(Ntlm.lmHashedPassword,challenge),ntResponse=Ntlm.buildResponse(Ntlm.ntHashedPassword,challenge),username=Ntlm.username,domain=Ntlm.domain,msg3=new Msg;return msg3.addString("NTLMSSP\0"),msg3.addByte(3),msg3.addString("\0\0\0"),msg3.addShort(24),msg3.addShort(24),msg3.addShort(64+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(24),msg3.addShort(24),msg3.addShort(88+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(2*domain.length),msg3.addShort(2*domain.length),msg3.addShort(64),msg3.addString("\0\0"),msg3.addShort(2*username.length),msg3.addShort(2*username.length),msg3.addShort(64+2*domain.length),msg3.addShort("\0\0"),msg3.addShort(2*hostname.length),msg3.addShort(2*hostname.length),msg3.addShort(64+2*(domain.length+username.length)),msg3.addString("\0\0"),msg3.addString("\0\0\0\0"),msg3.addShort(112+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(33281),msg3.addString("\0\0"),msg3.addString(domain.toUpperCase(),!0),msg3.addString(username,!0),msg3.addString(hostname.toUpperCase(),!0),msg3.addString(lmResponse),msg3.addString(ntResponse),msg3},createKey:function(str){for(var key56=[];str.length<7;)str+="\0";(str=str.substr(0,7)).split("").map(function(c){this.push(c.charCodeAt(0))},key56);var key=[0,0,0,0,0,0,0,0];key[0]=key56[0],key[1]=key56[0]<<7&255|key56[1]>>1,key[2]=key56[1]<<6&255|key56[2]>>2,key[3]=key56[2]<<5&255|key56[3]>>3,key[4]=key56[3]<<4&255|key56[4]>>4,key[5]=key56[4]<<3&255|key56[5]>>5,key[6]=key56[5]<<2&255|key56[6]>>6,key[7]=key56[6]<<1&255;for(var i=0;i<key.length;i++){for(var bit=0,k=0;k<7;k++)t=key[i]>>k,bit=1&(t^bit);key[i]=254&key[i]|bit}var result="";return key.map(function(i){result+=String.fromCharCode(i)}),result},buildResponse:function(key,text){for(;key.length<21;)key+="\0";var key1=Ntlm.createKey(key.substr(0,7)),key2=Ntlm.createKey(key.substr(7,7)),key3=Ntlm.createKey(key.substr(14,7));return des(key1,text,1,0)+des(key2,text,1,0)+des(key3,text,1,0)},getLocation:function(url){var l=document.createElement("a");return l.href=url,l},setCredentials:function(domain,username,password){for(var lmPassword=password.toUpperCase().substr(0,14);lmPassword.length<14;)lmPassword+="\0";for(var key1=Ntlm.createKey(lmPassword),key2=Ntlm.createKey(lmPassword.substr(7)),lmHashedPassword=des(key1,"KGS!@#$%",1,0)+des(key2,"KGS!@#$%",1,0),ntPassword="",i=0;i<password.length;i++)ntPassword+=password.charAt(i)+"\0";var ntHashedPassword=str_md4(ntPassword);Ntlm.domain=domain,Ntlm.username=username,Ntlm.lmHashedPassword=lmHashedPassword,Ntlm.ntHashedPassword=ntHashedPassword},isChallenge:function(xhr){if(!xhr)return!1;if(401!=xhr.status)return!1;var header=xhr.getResponseHeader("WWW-Authenticate");return header&&-1!=header.indexOf("NTLM")},authenticate:function(url){if(!(Ntlm.domain&&Ntlm.username&&Ntlm.lmHashedPassword&&Ntlm.ntHashedPassword))return Ntlm.error("No NTLM credentials specified. Use Ntlm.setCredentials(...) before making calls."),!1;var hostname=Ntlm.getLocation(url).hostname,msg1=Ntlm.createMessage1(hostname),request=new XMLHttpRequest;request.open("GET",url,!1),request.setRequestHeader("Authorization","NTLM "+msg1.toBase64()),request.send(null);var response=request.getResponseHeader("WWW-Authenticate"),challenge=Ntlm.getChallenge(response),msg3=Ntlm.createMessage3(challenge,hostname);return request.open("GET",url,!1),request.setRequestHeader("Authorization","NTLM "+msg3.toBase64()),request.send(null),200==request.status}},chrsz=8;function str_md4(s){return binl2str(core_md4(str2binl(s),s.length*chrsz))}function core_md4(x,len){x[len>>5]|=128<<len%32,x[14+(len+64>>>9<<4)]=len;for(var a=1732584193,b=-271733879,c=-1732584194,d=271733878,i=0;i<x.length;i+=16){var olda=a,oldb=b,oldc=c,oldd=d;b=md4_hh(b=md4_hh(b=md4_hh(b=md4_hh(b=md4_gg(b=md4_gg(b=md4_gg(b=md4_gg(b=md4_ff(b=md4_ff(b=md4_ff(b=md4_ff(b,c=md4_ff(c,d=md4_ff(d,a=md4_ff(a,b,c,d,x[i+0],3),b,c,x[i+1],7),a,b,x[i+2],11),d,a,x[i+3],19),c=md4_ff(c,d=md4_ff(d,a=md4_ff(a,b,c,d,x[i+4],3),b,c,x[i+5],7),a,b,x[i+6],11),d,a,x[i+7],19),c=md4_ff(c,d=md4_ff(d,a=md4_ff(a,b,c,d,x[i+8],3),b,c,x[i+9],7),a,b,x[i+10],11),d,a,x[i+11],19),c=md4_ff(c,d=md4_ff(d,a=md4_ff(a,b,c,d,x[i+12],3),b,c,x[i+13],7),a,b,x[i+14],11),d,a,x[i+15],19),c=md4_gg(c,d=md4_gg(d,a=md4_gg(a,b,c,d,x[i+0],3),b,c,x[i+4],5),a,b,x[i+8],9),d,a,x[i+12],13),c=md4_gg(c,d=md4_gg(d,a=md4_gg(a,b,c,d,x[i+1],3),b,c,x[i+5],5),a,b,x[i+9],9),d,a,x[i+13],13),c=md4_gg(c,d=md4_gg(d,a=md4_gg(a,b,c,d,x[i+2],3),b,c,x[i+6],5),a,b,x[i+10],9),d,a,x[i+14],13),c=md4_gg(c,d=md4_gg(d,a=md4_gg(a,b,c,d,x[i+3],3),b,c,x[i+7],5),a,b,x[i+11],9),d,a,x[i+15],13),c=md4_hh(c,d=md4_hh(d,a=md4_hh(a,b,c,d,x[i+0],3),b,c,x[i+8],9),a,b,x[i+4],11),d,a,x[i+12],15),c=md4_hh(c,d=md4_hh(d,a=md4_hh(a,b,c,d,x[i+2],3),b,c,x[i+10],9),a,b,x[i+6],11),d,a,x[i+14],15),c=md4_hh(c,d=md4_hh(d,a=md4_hh(a,b,c,d,x[i+1],3),b,c,x[i+9],9),a,b,x[i+5],11),d,a,x[i+13],15),c=md4_hh(c,d=md4_hh(d,a=md4_hh(a,b,c,d,x[i+3],3),b,c,x[i+11],9),a,b,x[i+7],11),d,a,x[i+15],15),a=safe_add(a,olda),b=safe_add(b,oldb),c=safe_add(c,oldc),d=safe_add(d,oldd)}return Array(a,b,c,d)}function md4_cmn(q,a,b,x,s,t){return safe_add(rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}function md4_ff(a,b,c,d,x,s){return md4_cmn(b&c|~b&d,a,0,x,s,0)}function md4_gg(a,b,c,d,x,s){return md4_cmn(b&c|b&d|c&d,a,0,x,s,1518500249)}function md4_hh(a,b,c,d,x,s){return md4_cmn(b^c^d,a,0,x,s,1859775393)}function safe_add(x,y){var lsw=(65535&x)+(65535&y);return(x>>16)+(y>>16)+(lsw>>16)<<16|65535&lsw}function rol(num,cnt){return num<<cnt|num>>>32-cnt}function str2binl(str){for(var bin=Array(),mask=(1<<chrsz)-1,i=0;i<str.length*chrsz;i+=chrsz)bin[i>>5]|=(str.charCodeAt(i/chrsz)&mask)<<i%32;return bin}function binl2str(bin){for(var str="",mask=(1<<chrsz)-1,i=0;i<32*bin.length;i+=chrsz)str+=String.fromCharCode(bin[i>>5]>>>i%32&mask);return str}function des(key,message,encrypt,mode,iv,padding){var i,j,temp,right1,right2,left,right,looping,cbcleft,cbcleft2,cbcright,cbcright2,endloop,loopinc,spfunction1=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),spfunction2=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),spfunction3=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),spfunction4=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),spfunction5=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),spfunction6=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),spfunction7=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),spfunction8=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696),keys=des_createKeys(key),m=0,len=message.length,chunk=0,iterations=32==keys.length?3:9;for(looping=3==iterations?encrypt?new Array(0,32,2):new Array(30,-2,-2):encrypt?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),2==padding?message+="        ":1==padding?(temp=8-len%8,message+=String.fromCharCode(temp,temp,temp,temp,temp,temp,temp,temp),8==temp&&(len+=8)):padding||(message+="\0\0\0\0\0\0\0\0"),result="",tempresult="",1==mode&&(cbcleft=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++),cbcright=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++),m=0);m<len;){for(left=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++),right=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++),1==mode&&(encrypt?(left^=cbcleft,right^=cbcright):(cbcleft2=cbcleft,cbcright2=cbcright,cbcleft=left,cbcright=right)),left^=(temp=252645135&(left>>>4^right))<<4,left^=(temp=65535&(left>>>16^(right^=temp)))<<16,left^=temp=858993459&((right^=temp)>>>2^left),left^=temp=16711935&((right^=temp<<2)>>>8^left),left=(left^=(temp=1431655765&(left>>>1^(right^=temp<<8)))<<1)<<1|left>>>31,right=(right^=temp)<<1|right>>>31,j=0;j<iterations;j+=3){for(endloop=looping[j+1],loopinc=looping[j+2],i=looping[j];i!=endloop;i+=loopinc)right1=right^keys[i],right2=(right>>>4|right<<28)^keys[i+1],temp=left,left=right,right=temp^(spfunction2[right1>>>24&63]|spfunction4[right1>>>16&63]|spfunction6[right1>>>8&63]|spfunction8[63&right1]|spfunction1[right2>>>24&63]|spfunction3[right2>>>16&63]|spfunction5[right2>>>8&63]|spfunction7[63&right2]);temp=left,left=right,right=temp}right=right>>>1|right<<31,right^=temp=1431655765&((left=left>>>1|left<<31)>>>1^right),right^=(temp=16711935&(right>>>8^(left^=temp<<1)))<<8,right^=(temp=858993459&(right>>>2^(left^=temp)))<<2,right^=temp=65535&((left^=temp)>>>16^right),right^=temp=252645135&((left^=temp<<16)>>>4^right),left^=temp<<4,1==mode&&(encrypt?(cbcleft=left,cbcright=right):(left^=cbcleft2,right^=cbcright2)),tempresult+=String.fromCharCode(left>>>24,left>>>16&255,left>>>8&255,255&left,right>>>24,right>>>16&255,right>>>8&255,255&right),512==(chunk+=8)&&(result+=tempresult,tempresult="",chunk=0)}return result+tempresult}function des_createKeys(key){pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);for(var lefttemp,righttemp,temp,iterations=8<key.length?3:1,keys=new Array(32*iterations),shifts=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),m=0,n=0,j=0;j<iterations;j++){left=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++),right=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++),temp=252645135&(left>>>4^right),right^=temp,left^=temp<<4,temp=65535&(right>>>-16^left),left^=temp,right^=temp<<-16,temp=858993459&(left>>>2^right),right^=temp,left^=temp<<2,temp=65535&(right>>>-16^left),left^=temp,right^=temp<<-16,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,temp=16711935&(right>>>8^left),left^=temp,right^=temp<<8,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,temp=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=temp;for(var i=0;i<shifts.length;i++)shifts[i]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,lefttemp=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],temp=65535&((righttemp=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15])>>>16^lefttemp),keys[n++]=lefttemp^temp,keys[n++]=righttemp^temp<<16}return keys}var ThemeStatus={UNMODIFIED:0,NEW:1,UPDATED:2,DELETED:3},LayerType={LAYER:0,GROUP:1},ActiveInteractieButton={GEEN:"geen",IDENTIFY:"identify",SELECT:"select",METEN:"meten",WATISHIER:"watishier"},GAAS={ReversedGeocodeUrl:"https://reversedgeocoding-app1-p.antwerpen.be/"},Gis={Arcgissql:"",BaseUrl:"https://geoint.antwerpen.be/",PublicBaseUrl:"https://geodata.antwerpen.be/",LocatieUrl:"https://geoint-a.antwerpen.be/arcgissql/rest/services/A_DA/Locaties/MapServer",GeometryUrl:"https://geoint.antwerpen.be/arcgissql/rest/services/Utilities/Geometry/GeometryServer/buffer"};Gis.Arcgissql=Gis.BaseUrl+"arcgissql/rest/";var Solr={BaseUrl:"https://esb-app1-o.antwerpen.be/v1/"},LocationPicker={BaseUrl:"https://locationpicker-app1-o.antwerpen.be/api/v2/"},DrawingOption={GEEN:"geen",NIETS:"",AFSTAND:"afstand",OPPERVLAKTE:"oppervlakte",LIJN:"lijn",VIERKANT:"vierkant",POLYGON:"polygon"},Global={Mobile:!1},ThemeType={ESRI:"esri",WMS:"wms"},Style={DEFAULT:{fillOpacity:0,color:"blue",weight:4},ADD:{fillOpacity:0,color:"green",weight:5},REMOVE:{fillOpacity:0,color:"red",weight:5},HIGHLIGHT:{weight:7,color:"red",fillOpacity:.5},COREBUFFER:{weight:7,color:"lightgreen",fillOpacity:.5},BUFFER:{fillColor:"#00cc00",color:"#00cc00",weight:1,opacity:.9,fillOpacity:.3}},Scales=[25e4,2e5,15e4,1e5,5e4,25e3,2e4,15e3,12500,1e4,7500,5e3,2500,2e3,1500,1250,1e3,750,500,250,100];!function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tinµk.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("geoPuntController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,PopupService){$scope.loading=!1,$scope.themeloading=!1,$scope.currentPage=1,$scope.geopuntError=null,$scope.data=null,$scope.status=null,$scope.url=null,$scope.canceller=null,$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.EnabledThemes.length=0,LayerManagementService.AvailableThemes.length=0,LayerManagementService.EnabledThemes=_.cloneDeep(MapData.Themes),$scope.availableThemes=[];$scope.searchTerm="";L.Browser.mobile||$scope.$on("searchChanged",function(event,searchTerm){$scope.searchTerm=searchTerm,2<$scope.searchTerm.length?($scope.clearPreview(),$scope.searchIsUrl=!1,$scope.$parent.geopuntLoading=!0,$scope.QueryGeoPunt($scope.searchTerm,1)):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0,$scope.$parent.geopuntCount=null,$scope.loading=!1,$scope.$parent.geopuntLoading=!1)}),$scope.QueryGeoPunt=function(searchTerm,page){$scope.loading=!0,$scope.clearPreview(),$scope.canceller&&$scope.canceller.resolve("cancelled"),$scope.canceller=$q.defer(),GeopuntService.getMetaData(searchTerm,5*(page-1)+1,5,$scope.canceller.promise).then(function(metadata){0==$scope.currentPage&&($scope.currentPage=1),$scope.loading=!1,$scope.$parent.geopuntLoading=!1,$scope.availableThemes=metadata.results,$scope.currentrecord=metadata.currentrecord,$scope.nextrecord=metadata.nextrecord,$scope.numberofrecordsmatched=metadata.numberofrecordsmatched,$scope.$parent.geopuntCount=metadata.numberofrecordsmatched,$scope.canceller=null},function(reason){console.log(reason),$scope.$parent.geopuntLoading=!1,$scope.$parent.geopuntCount="!",$scope.geopuntError=!0,$scope.loading=!1,$scope.data=reason.data,$scope.status=reason.status,$scope.url=reason.url,$scope.canceller=null})},$scope.pageChanged=function(page,recordsAPage){$scope.QueryGeoPunt($scope.searchTerm,page)},$scope.geopuntThemeChanged=function(theme){var questionmarkPos=theme.Url.trim().indexOf("?"),url=theme.Url.trim();-1!=questionmarkPos&&(url=theme.Url.trim().substring(0,questionmarkPos)),createWMS(url)};var createWMS=function(url){$scope.clearPreview();var wms=MapData.Themes.find(function(x){return x.cleanUrl==url});if(null==wms){var getwms=WMSService.GetThemeData(url);$scope.themeloading=!0,getwms.success(function(data,status,headers,config){if($scope.themeloading=!1,data){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,url);$scope.previewTheme(wmstheme)}else PopupService.Error("Fout bij het laden van de WMS","Er is een fout opgetreden bij opvragen van de wms met de url: "+url),$scope.error="Fout bij het laden van WMS."}).error(function(data,status,headers,config){$scope.error="Fout bij het laden van WMS.",$scope.themeloading=!1})}else $scope.previewTheme(wms)};$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){$scope.selectedTheme=theme,$scope.copySelectedTheme=_.cloneDeep(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null,$scope.geopuntError=null},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()},$scope.reportError=function(){var exception={url:$scope.url,status:$scope.status,data:$scope.data};PopupService.ExceptionFunc(exception)}}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("LayerManagerController",["$scope","$modalInstance","LayerManagementService",function($scope,$modalInstance,LayerManagementService){$scope.active="solr",$scope.searchTerm="",$scope.solrLoading=!1,$scope.solrCount=null,$scope.geopuntLoading=!1,$scope.geopuntCount=null,$scope.mobile=L.Browser.mobile,$scope.ok=function(){$modalInstance.$close()},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")},$scope.enterPressed=function(){""==$scope.searchTerm&&$scope.$broadcast("searchChanged","*")},$scope.searchChanged=function(){null!=$scope.searchTerm&&""!=$scope.searchTerm&&$scope.$broadcast("searchChanged",$scope.searchTerm)}}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("layersManagementController",["$scope","MapData","ThemeService","LayerManagementService","PopupService",function($scope,MapData,ThemeService,LayerManagementService,PopupService){$scope.pagingCount=null,$scope.numberofrecordsmatched=0,$scope.availableThemes=MapData.Themes,$scope.queryLayers=MapData.QueryLayers,$scope.allThemes=[],$scope.searchChanged=function(){},$scope.pageChanged=function(page,recordsAPage){var startItem=(page-1)*recordsAPage;$scope.availableThemes=$scope.allThemes.slice(startItem,startItem+recordsAPage)},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.query="",$scope.selectedQueryLayer=null,$scope.previewTheme=function(theme){console.log("themeChanged"),console.log(theme);var alreadyExistingTheme=MapData.Themes.find(function(x){return x.cleanUrl===theme.cleanUrl});alreadyExistingTheme&&(theme=alreadyExistingTheme),$scope.selectedTheme=theme,$scope.copySelectedTheme=_.cloneDeep(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.selectedQueryLayer=null},$scope.ThemeChanged=function(theme){$scope.selectedQueryLayer=null,$scope.previewTheme(theme),$scope.selected=theme,$scope.isActive=function(theme){return $scope.selected===theme}},$scope.QueryLayerChanged=function(queryLayer){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.selected=null,$scope.selectedQueryLayer=queryLayer,$scope.query="FROM "+queryLayer.layer.layerName+" WHERE "+queryLayer.layer.query,$scope.isActiveQueryLayer=function(queryLayer){return $scope.selectedQueryLayer===queryLayer}},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()},$scope.delQueryLayer=function(queryLayer){$scope.selectedQueryLayer===queryLayer&&$scope.clearPreview();var index=$scope.queryLayers.indexOf(queryLayer);-1!==index&&ThemeService.DeleteQueryLayer(index)},$scope.delTheme=function(theme){$scope.selectedTheme==theme&&$scope.clearPreview(),ThemeService.DeleteTheme(theme)};$scope.searchTerm="",!$scope.selected&&$scope.availableThemes[0]&&$scope.ThemeChanged($scope.availableThemes[0])}])}(),angular.module("tink.gis").controller("managementLayerController",function($scope){this.layer=$scope.layer,$scope.showLayer=!1,angular.forEach($scope.layer.Layers,function(value){1==value.enabled&&($scope.showLayer=!0),0<value.Layers.length&&angular.forEach(value.Layers,function(childvalue){1==childvalue.enabled&&($scope.showLayer=!0)})})}).$inject=[],function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("previewLayerController",["$scope",function($scope){console.log($scope.theme),0!=$scope.theme.Added||$scope.theme.AllLayers.some(function(x){return x.enabled})||($scope.theme.enabled=!1),$scope.delTheme=function(){$scope.theme.AllLayers.forEach(function(lay){lay.enabled=!1}),$scope.addorupdatefunc()}}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("previewQueryLayerController",["$scope",function($scope){console.log($scope)}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("solrGISController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","ThemeService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,ThemeService,PopupService){$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.AvailableThemes.length=0,$scope.availableThemes=[],$scope.allThemes=[],$scope.loading=!1,$scope.error=null;$scope.searchTerm="";$scope.$on("searchChanged",function(event,searchTerm){$scope.searchTerm=searchTerm.replace(/ /g,"").replace(/_/g,"").replace(/-/g,""),2<$scope.searchTerm.length?null!=$scope.searchTerm&&""!=$scope.searchTerm&&($scope.$parent.solrLoading=!0,$scope.QueryGISSOLR($scope.searchTerm,1)):"*"==$scope.searchTerm?($scope.searchTerm="arcgis",$scope.$parent.solrLoading=!0,$scope.QueryGISSOLR("arcgis",1)):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0,$scope.$parent.solrCount=null,$scope.loading=!1,$scope.$parent.solrLoading=!1)});$scope.QueryGISSOLR=function(searchterm,page){$scope.loading=!0,GISService.QuerySOLRGIS(searchterm,5*(page-1)+1,5).then(function(data){$scope.loading=!1,$scope.$parent.solrLoading=!1,$scope.currentPage=1;data.facet_counts.facet_fields.parent;var itemsMetData=data.grouped.parent.groups;$scope.$parent.solrCount=itemsMetData.length;var themes=[];itemsMetData.forEach(function(itemMetData){switch(itemMetData.doclist.docs[0].type){case"Feature":var afterservicespart=itemMetData.groupValue.split("/services/")[1].split("/"),url=itemMetData.groupValue.split("/").splice(0,itemMetData.groupValue.split("/").length-1).join("/")+"/Mapserver",themeName=afterservicespart[1],layerId=afterservicespart[2],layerName=itemMetData.doclist.docs[0].parentname;if(!(theme=themes.find(function(x){return x.name==themeName}))){var theme={layers:[],layersCount:0,name:themeName,cleanUrl:url,url:url};themes.push(theme)}var layer=theme.layers.find(function(x){return x.id==layerId});layer?layer.featuresCount=itemMetData.doclist.numFound:(layer={naam:layerName,id:layerId,features:[],featuresCount:itemMetData.doclist.numFound,isMatch:!1},theme.layers.push(layer)),itemMetData.doclist.docs.slice(0,5).forEach(function(item){var feature=item.titel.join(" ");layer.features.push(feature)});break;case"Layer":themeName=(afterservicespart=itemMetData.groupValue.split("/services/")[1].split("/"))[1],itemMetData.groupValue.split("/")[0],url=itemMetData.groupValue+"/Mapserver";(theme=themes.find(function(x){return x.name==themeName}))?theme.layersCount=itemMetData.doclist.numFound:(theme={layers:[],layersCount:itemMetData.doclist.numFound,name:themeName,cleanUrl:url,url:url},themes.push(theme)),itemMetData.doclist.docs.forEach(function(item){if(item.titel[0].replace(/ /g,"").replace(/_/g,"").replace(/-/g,"").toLowerCase().includes(searchterm.toLowerCase())){var layer=theme.layers.find(function(x){return x.id==item.key});layer?layer.isMatch=!0:(layer={naam:item.titel[0],id:item.key,isMatch:!0,featuresCount:0,features:[]},theme.layers.push(layer))}});break;default:console.log("UNKOWN TYPE:",item)}}),$scope.availableThemes=themes.slice(0,5),$scope.allThemes=themes,$scope.numberofrecordsmatched=themes.length,console.log(data)},function(reason){console.log(reason)})},$scope.pageChanged=function(page,recordsAPage){var startItem=(page-1)*recordsAPage;$scope.availableThemes=$scope.allThemes.slice(startItem,startItem+recordsAPage)},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme,layername){var alreadyExistingTheme=MapData.Themes.find(function(x){return x.cleanUrl===theme.cleanUrl});if(alreadyExistingTheme&&(theme=alreadyExistingTheme),layername){var layer=theme.AllLayers.find(function(x){return x.name==layername});layer&&(theme.enabled=!0,layer.enabled=!0,layer.AllLayers.forEach(function(x){return x.enabled=!0}),$scope.CheckAndSetParentEnabled(layer))}$scope.selectedTheme=theme,$scope.copySelectedTheme=_.cloneDeep(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null},$scope.solrThemeChanged=function(theme,layername){$scope.clearPreview(),$scope.themeloading=!0,GISService.GetThemeData(theme.cleanUrl).then(function(data,status,functie,getdata){if(data)if(data.error)PopupService.ErrorFromHTTP(data.error,status,theme.cleanUrl),$scope.error="Fout bij het laden van de mapservice.";else{var convertedTheme=ThemeCreater.createARCGISThemeFromJson(data,theme);$scope.previewTheme(convertedTheme,layername)}else{var options={timeOut:1e4};PopupService.Warning("U hebt geen rechten om het thema "+theme.name+" te raadplegen.","Klik hier om toegang aan te vragen.",function(){window.open("https://um.antwerpen.be/main.aspx","_blank").focus()},options)}$scope.themeloading=!1},function(data,status,functie,getdata){$scope.error="Fout bij het laden van de mapservice.",$scope.themeloading=!1}),$scope.selected=theme,$scope.isActive=function(theme){return $scope.selected===theme}},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()},$scope.CheckAndSetParentEnabled=function(layer){layer.parent&&(layer.parent.enabled=!0,$scope.CheckAndSetParentEnabled(layer.parent))},$scope.ok=function(){$modalInstance.$close()},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("themeUrlController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,PopupService){$scope.urlIsValid=!1,$scope.themeloading=!1,$scope.urlChanged=function(){$scope.clearPreview(),null!=$scope.url&&$scope.url.startsWith("http")?$scope.urlIsValid=!0:$scope.urlIsValid=!1},$scope.laadUrl=function(){$scope.url=$scope.url.trim().replace("?",""),$scope.clearPreview(),$scope.url.toLowerCase().endsWith("mapserver")?createTheme($scope.url):createWMS($scope.url)};var createWMS=function(url){var wms=MapData.Themes.find(function(x){return x.cleanUrl==url});if(null==wms){var getwms=WMSService.GetThemeData(url);$scope.themeloading=!0,getwms.success(function(data,status,headers,config){if($scope.themeloading=!1,data){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,url);$scope.previewTheme(wmstheme)}else $scope.error="Fout bij het laden van WMS.",PopupService.Error("Ongeldige WMS","De opgegeven url is geen geldige WMS url. ("+url+")")}).error(function(data,status,headers,config){$scope.error="Fout bij het laden van WMS.",$scope.themeloading=!1})}else $scope.previewTheme(wms)},createTheme=function(url){url.contains("http://")&&(url=url.replace("http://","https://"));var gisTheme=MapData.Themes.find(function(x){return x.cleanUrl===url});if(gisTheme)$scope.previewTheme(gisTheme);else{var getGisTheme=GISService.GetThemeData(url);$scope.themeloading=!0,getGisTheme.then(function(data){if($scope.themeloading=!1,data){var themeData={cleanUrl:url,opacity:1},gisTheme=ThemeCreater.createARCGISThemeFromJson(data,themeData);$scope.previewTheme(gisTheme)}else $scope.error="Fout bij het laden van Mapserver.",PopupService.Error("Ongeldige Mapserver","De opgegeven url is geen geldige Mapserver url. ("+url+")")},function(reason){$scope.error="Fout bij het laden van Mapserver.",$scope.themeloading=!1})}};$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){$scope.selectedTheme=theme,$scope.copySelectedTheme=_.cloneDeep(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()}}])}(),angular.module("tink.gis").directive("geoPunt",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/geoPuntTemplate.html",controller:"geoPuntController",controllerAs:"geoPuntctrl"}}),angular.module("tink.gis").directive("tinkManagementlayer",["RecursionHelper",function(RecursionHelper){return{replace:!1,scope:{layer:"="},templateUrl:"templates/layermanagement/managementLayerTemplate.html",controller:"managementLayerController",controllerAs:"lyrctrl",compile:function(element){return RecursionHelper.compile(element)}}}]),angular.module("tink.gis").directive("layersManagement",function(){return{replace:!0,templateUrl:"templates/layermanagement/layersManagementTemplate.html",controller:"layersManagementController",controllerAs:"layersManagementctrl"}}),angular.module("tink.gis").directive("previewLayer",function(){return{replace:!0,scope:{theme:"=",addorupdatefunc:"&"},templateUrl:"templates/layermanagement/previewLayerTemplate.html",controller:"previewLayerController",controllerAs:"previewctrl"}}),angular.module("tink.gis").directive("previewQueryLayer",function(){return{replace:!0,scope:{querylayer:"=",query:"="},templateUrl:"templates/layermanagement/previewQueryLayerTemplate.html",controller:"previewQueryLayerController",controllerAs:"previewQueryCtrl"}}),angular.module("tink.gis").directive("solrGis",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/solrGISTemplate.html",controller:"solrGISController",controllerAs:"solrGISctrl"}}),angular.module("tink.gis").directive("themeUrl",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/themeUrlTemplate.html",controller:"themeUrlController",controllerAs:"themeUrlctrl"}}),angular.module("tink.gis").factory("GeopuntService",["$http","map","MapData","$rootScope","$q","GisHelperService","PopupService",function($http,map,MapData,$rootScope,$q,helperService,PopupService){var _service={getMetaData:function(){var searchterm=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"water",startpos=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,recordsAPage=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,cancelProm=arguments[3],url="https://metadata.vlaanderen.be/srv/dut/csw?service=CSW&version=2.0.2&SortBy=title&request=GetRecords&namespace=xmlns(csw=http://www.opengis.net/cat/csw)&resultType=results&outputSchema=http://www.opengis.net/cat/csw/2.0.2&outputFormat=application/xml&startPosition="+startpos+"&maxRecords="+recordsAPage+"&typeNames=csw:Record&elementSetName=full&constraintLanguage=CQL_TEXT&constraint_language_version=1.1.0&constraint=AnyText%20LIKE%20%27%"+searchterm+"%%27AND%20Type%20=%20%27service%27%20AND%20Servicetype%20=%27view%27",prom=$q.defer(),proxiedurl=helperService.CreateProxyUrl(url);return $http.get(proxiedurl,{timeout:cancelProm}).success(function(data,status,headers,config){if(data){data=helperService.UnwrapProxiedData(data);var getResults=JXON.stringToJs(data)["csw:getrecordsresponse"]["csw:searchresults"],returnObject={results:[]};if(returnObject.searchTerm=searchterm,returnObject.currentrecord=startpos,returnObject.recordsAPage=recordsAPage,returnObject.nextrecord=getResults.nextrecord,returnObject.numberofrecordsmatched=getResults.numberofrecordsmatched,returnObject.numberofrecordsreturned=getResults.numberofrecordsreturned,0!=returnObject.numberofrecordsmatched){var themeArr=[];getResults["csw:record"].constructor===Array?themeArr=getResults["csw:record"]:themeArr.push(getResults["csw:record"]),themeArr.forEach(function(record){var processedTheme=procesTheme(record);returnObject.results.push(processedTheme)})}prom.resolve(returnObject)}else prom.reject(null),console.log("EMPTY RESULT")}).error(function(data,status,headers,config){var rejectdata=[];rejectdata.data=data,rejectdata.status=status,rejectdata.url=url,prom.reject(rejectdata)}),prom.promise}},procesTheme=function(record){if(record["dc:uri"]instanceof Array==0){var tmpdata=record["dc:uri"];record["dc:uri"]=[],record["dc:uri"].push(tmpdata)}var tmptheme={Added:!1};tmptheme.Naam=record["dc:title"];var wmsinfo=record["dc:uri"].find(function(x){return"WMS"==x.protocol||"OGC:WMS"==x.protocol});return wmsinfo?(tmptheme.Url=wmsinfo._,tmptheme.Type=ThemeType.WMS):tmptheme.Type="DONTKNOW",tmptheme.TMPMETADATA=record,tmptheme};return _service}]),function(){var module=angular.module("tink.gis");module.$inject=["MapData","$http","$q","GISService","ThemeCreater","ThemeService"],module.factory("LayerManagementService",function(MapData,$http,$q,GISService,ThemeCreater,ThemeService){var _service={EnabledThemes:[],AvailableThemes:[],AddOrUpdateTheme:function(selectedTheme,copySelectedTheme){console.log("AddOrUpdateTheme");for(var allChecked=!0,noneChecked=!0,hasAChange=!1,x=0;x<copySelectedTheme.AllLayers.length;x++){var copyLayer=copySelectedTheme.AllLayers[x],realLayer=selectedTheme.AllLayers[x];realLayer.enabled!=copyLayer.enabled&&(hasAChange=!0),realLayer.enabled=copyLayer.enabled,!1===copyLayer.enabled?allChecked=!1:noneChecked=!1}null!=MapData.Themes.find(function(x){return x.cleanUrl===selectedTheme.cleanUrl})?(selectedTheme.status=hasAChange?ThemeStatus.UPDATED:ThemeStatus.UNMODIFIED,noneChecked&&(selectedTheme.status=ThemeStatus.DELETED)):selectedTheme.status=ThemeStatus.NEW,allChecked&&selectedTheme!=ThemeStatus.DELETED&&(selectedTheme.Added=!0),allChecked||noneChecked||selectedTheme==ThemeStatus.DELETED||(selectedTheme.Added=null),selectedTheme==ThemeStatus.DELETED&&(selectedTheme.Added=!1),ThemeService.AddAndUpdateThemes([selectedTheme])}};return _service})}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}module.controller("layerController",function($scope){this.layer=$scope.layer,console.log(this.layer)})}(),angular.module("tink.gis").controller("layersController",function($scope,MapData,map,ThemeService,$modal,FeatureService){var vm=this;vm.themes=MapData.Themes,vm.queryLayers=MapData.QueryLayers,vm.selectedLayers=[],vm.showQueryLayers=!0,vm.sortableOptions={stop:function(e,ui){MapData.SetZIndexes()}},vm.asidetoggle=function(){if(L.Browser.mobile){var html=$("html");html.hasClass("nav-left-open")&&html.removeClass("nav-left-open")}},vm.deleteLayerButtonIsEnabled=FeatureService.deleteLayerButtonIsEnabled,$scope.$watch(function(){return FeatureService.deleteLayerButtonIsEnabled},function(newValue,oldValue){vm.deleteLayerButtonIsEnabled=newValue}),vm.layerManagementButtonIsEnabled=FeatureService.layerManagementButtonIsEnabled,$scope.$watch(function(){return FeatureService.layerManagementButtonIsEnabled},function(newValue,oldValue){vm.layerManagementButtonIsEnabled=newValue}),$scope.$watch(function(){return MapData.Themes},function(newVal,oldVal){MapData.SetZIndexes(newVal)}),vm.updatethemevisibility=function(theme){ThemeService.UpdateThemeVisibleLayers(theme)},vm.updateQueryVisibility=function(index){ThemeService.updateQueryVisibility(index)},vm.deleteQueryLayer=function(index){ThemeService.DeleteQueryLayer(index)},vm.Lagenbeheer=function(){$modal.open({templateUrl:"templates/layermanagement/layerManagerTemplate.html",controller:"LayerManagerController",resolve:{backdrop:!1,keyboard:!0}}).result.then(function(){},function(obj){console.log("Modal dismissed at: "+new Date)})}}).$inject=["MapData","map","ThemeService","$modal","FeatureService"],angular.module("tink.gis").controller("mapController",function($scope,ExternService,BaseLayersService,MapService,MapData,map,MapEvents,DrawService,GisHelperService,GISService,PopupService,$interval,TypeAheadService,UIService,tinkApi,FeatureService,$modal){var vm=this;vm.exportPNG=function(){var width=$("#map").width(),height=$("#map").height();$("#map").css("width",width),$("#map").css("height",height),vm.easyprinter.printMap("CurrentSize","Export"),$("#map").css("width","100%"),$("#map").css("height","100%")},function(){if(console.log("Tink-Gis-Angular component init!!!!!!!!!"),window.location.href.startsWith("http://localhost:9000/")){var externproj=JSON.parse('{"naam":"sorteerstraat 2","extent":{"_northEast":{"lat":"51.2302167641279","lng":"4.42211298202784"},"_southWest":{"lat":"51.2296967607896","lng":"4.42029424518419"}},"guid":"376edeed-60e1-44cc-93ff-4e149cc4d4bc","extentString":"51.2302167641279,4.42211298202784,51.2296967607896,4.42029424518419","isKaart":true,"uniqId":202,"creatorId":38,"creator":null,"createDate":"2021-02-09T10:33:01.774872","updaterId":38,"updater":null,"lastUpdated":"2021-02-09T10:33:01.774872","themes":[{"cleanUrl":"https://geoint.antwerpen.be/arcgissql/rest/services/P_Stad/Afval/Mapserver","naam":"Afval","type":"esri","visible":true,"layers":[{"id":"5","name":"sorteerstraat_ondergronds","visible":true},{"id":"2","name":"papiermand","visible":false},{"id":"0","name":"Afval-inzameling","visible":true}],"opacity":1}],"queryLayers":[{"layerId":5,"name":"sorteerstraat_ondergronds","baseUrl":"https://geoint.antwerpen.be/arcgissql/rest/services/P_Stad/Afval/Mapserver","where":"OBJECTID = \'20\' "}],"isReadOnly":false}');ExternService.Import(externproj),PopupService.Success("Dev autoload","Velo en fietspad loaded because you are in DEV.",function(){alert("onclicktestje")})}TypeAheadService.init()}(),vm.mobile=L.Browser.mobile,vm.ZoekenOpLocatie=!0,vm.activeInteractieKnop=MapData.ActiveInteractieKnop,$scope.$watch(function(){return MapData.ActiveInteractieKnop},function(data){vm.activeInteractieKnop=data},!0),vm.easyprinter=L.easyPrint({tileWait:250,exportOnly:!0,hidden:!0,hideControlContainer:!0}).addTo(map),vm.drawingType=MapData.DrawingType,$scope.$watch(function(){return MapData.DrawingType},function(data){vm.drawingType=data},!0),vm.SelectableLayers=function(){return MapData.VisibleLayers},vm.selectedLayer=MapData.SelectedLayer,$scope.$watch(function(){return MapData.SelectedLayer},function(newval,oldval){vm.selectedLayer=newval}),vm.selectedFindLayer=MapData.SelectedFindLayer,$scope.$watch(function(){return MapData.SelectedFindLayer},function(newval,oldval){vm.selectedFindLayer=newval}),$scope.$watch(function(){return MapData.ShowMetenControls},function(data){vm.showMetenControls=data},!0),vm.showMetenControls=MapData.ShowMetenControls,$scope.$watch(function(){return MapData.ShowDrawControls},function(data){vm.showDrawControls=data},!0),vm.showDrawControls=MapData.ShowDrawControls,vm.zoekLoc="",vm.addCursorAuto=function(){$(".leaflet-container").hasClass("cursor-auto")||$(".leaflet-container").addClass("cursor-auto")},vm.resetButtonBar=function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.NIETS,vm.activeInteractieKnop=ActiveInteractieButton.NIETS,MapData.DrawingType=DrawingOption.NIETS,MapData.ExtendedType=null,MapData.ShowMetenControls=!1,MapData.ShowDrawControls=!1},vm.interactieButtonChanged=function(ActiveButton){if(vm.activeInteractieKnop!=ActiveButton)switch(MapData.ActiveInteractieKnop=ActiveButton,vm.activeInteractieKnop=ActiveButton,MapData.ShowMetenControls=!1,MapData.ShowDrawControls=!1,ActiveButton){case ActiveInteractieButton.IDENTIFY:case ActiveInteractieButton.WATISHIER:MapData.ExtendedType=null,vm.addCursorAuto();break;case ActiveInteractieButton.SELECT:MapData.ShowDrawControls=!0,MapData.DrawingType=DrawingOption.GEEN,vm.selectpunt();break;case ActiveInteractieButton.METEN:MapData.ExtendedType=null,MapData.ShowMetenControls=!0,MapData.DrawingType=DrawingOption.GEEN}else vm.resetButtonBar()},vm.zoekLaag=function(search){MapData.CleanMap(),MapService.Find(search),UIService.OpenLeftSide()};var setViewAndPutDot=function(loc){MapData.PanToPoint(loc),MapData.CreateDot(loc)};vm.zoekXY=function(search){search=search.trim();var WGS84Check=GisHelperService.getWGS84CordsFromString(search);if(WGS84Check.hasCordinates)setViewAndPutDot(WGS84Check);else{var lambertCheck=GisHelperService.getLambartCordsFromString(search);if(lambertCheck.hasCordinates){var xyWGS84=GisHelperService.ConvertLambert72ToWSG84({x:lambertCheck.x,y:lambertCheck.y});setViewAndPutDot(xyWGS84)}else console.log("NIET GEVONDEN")}},vm.drawingButtonChanged=function(drawOption){MapData.RemovedUnfinishedDrawings=!1,MapData.DrawingObject&&MapData.DrawingObject._enabled&&(MapData.RemovedUnfinishedDrawings=!0,MapData.CleanDrawings()),null==MapData.ExtendedType&&(drawOption!=DrawingOption.LIJN&&drawOption!=DrawingOption.POLYGON&&drawOption!=DrawingOption.NIETS&&drawOption!=DrawingOption.VIERKANT||(MapData.CleanMap(),MapData.CleanSearch()),drawOption==DrawingOption.AFSTAND||DrawingOption.OPPERVLAKTE),MapData.DrawingType=drawOption,vm.drawingType=drawOption,DrawService.StartDraw(drawOption)},vm.Loading=0,vm.MaxLoading=0,vm.selectpunt=function(){MapData.DrawingType=DrawingOption.NIETS,vm.drawingType=DrawingOption.NIETS,null==MapData.ExtendedType&&(MapData.CleanMap(),MapData.CleanSearch()),vm.addCursorAuto()},vm.selectAdvanced=function(){MapData.DrawingType=DrawingOption.ZOEKEN,vm.drawingType=DrawingOption.ZOEKEN,null==MapData.ExtendedType&&(MapData.CleanMap(),MapData.CleanSearch()),$modal.open({templateUrl:"templates/search/searchAdvancedTemplate.html",controller:"searchAdvancedController",resolve:{backdrop:!1,keyboard:!0}}).result.then(function(){},function(obj){console.log("Modal dismissed at: "+new Date)})},vm.layerChange=function(){MapData.SelectedLayer=vm.selectedLayer},vm.findLayerChange=function(){MapData.SelectedFindLayer=vm.selectedFindLayer},vm.zoomIn=function(){map.zoomIn()},vm.zoomOut=function(){map.zoomOut()},vm.fullExtent=function(){map.setView(new L.LatLng(51.2192159,4.4028818),16)},vm.setCityView=function(){ExternService.SetCityExtent()},vm.IsBaseMap1=!0,vm.IsBaseMap2=!1,vm.IsBaseMapGeen=!1,vm.toonBaseMap1=function(){0==vm.IsBaseMapGeen&&1==vm.IsBaseMap1?(vm.IsBaseMapGeen=!0,map.removeLayer(BaseLayersService.basemap1)):(vm.IsBaseMap2=!1,vm.IsBaseMapGeen=!1,map.removeLayer(BaseLayersService.basemap2),map.addLayer(BaseLayersService.basemap1)),vm.IsBaseMap1=!0},vm.toonBaseMap2=function(){0==vm.IsBaseMapGeen&&1==vm.IsBaseMap2?(vm.IsBaseMapGeen=!0,map.removeLayer(BaseLayersService.basemap2)):(vm.IsBaseMapGeen=!1,vm.IsBaseMap1=!1,map.removeLayer(BaseLayersService.basemap1),map.addLayer(BaseLayersService.basemap2)),vm.IsBaseMap2=!0},vm.baseMap1Naam=function(){return BaseLayersService.basemap1Naam},vm.baseMap2Naam=function(){return BaseLayersService.basemap2Naam},vm.cancelPrint=function(){var html=$("html");html.hasClass("print")&&html.removeClass("print"),vm.portrait(),tinkApi.sideNavToggle.recalculate("asideNavRight"),tinkApi.sideNavToggle.recalculate("asideNavLeft")},vm.print=function(){window.print()},vm.printStyle="portrait";var style,cssPagedMedia=(style=document.createElement("style"),document.head.appendChild(style),function(rule){style.id="tempstyle",style.innerHTML=rule});cssPagedMedia.size=function(oriantation){cssPagedMedia("@page {size: A4 "+oriantation+"}")},vm.setPrintStyle=function(oriantation){vm.printStyle=oriantation,cssPagedMedia.size(oriantation)},vm.setPrintStyle("portrait"),vm.printLegendPreview=!1,vm.previewMap=function(){var html=$("html");vm.printLegendPreview=!1,html.hasClass("preview-legend")&&html.removeClass("preview-legend")},vm.previewLegend=function(){var html=$("html");vm.printLegendPreview=!0,html.hasClass("preview-legend")||html.addClass("preview-legend")},vm.portrait=function(){var html=$("html");vm.setPrintStyle("portrait"),html.hasClass("landscape")&&html.removeClass("landscape"),map.invalidateSize(!1)},vm.landscape=function(){var html=$("html");vm.setPrintStyle("landscape"),html.hasClass("landscape")||html.addClass("landscape"),map.invalidateSize(!1)},vm.ZoekenInLagen=function(){vm.ZoekenOpLocatie=!1,$(".twitter-typeahead").addClass("hide-element")},vm.fnZoekenOpLocatie=function(){if(vm.ZoekenOpLocatie=!0,!$(".twitter-typeahead").hasClass("hide-element"))return vm.ZoekenOpLocatie;$(".twitter-typeahead").removeClass("hide-element")},vm.gpstracking=!1;var gpstracktimer=null;vm.zoomToGps=function(){vm.gpstracking=!vm.gpstracking,0==vm.gpstracking?($interval.cancel(gpstracktimer),MapEvents.ClearGPS()):(map.locate({setView:!0,maxZoom:16}),gpstracktimer=$interval(function(){map.locate({setView:!1}),console.log("gps refresh")},5e3))},map.on("locationfound",function(e){MapEvents.ClearGPS();var gpsicon=L.divIcon({className:"fa fa-crosshairs fa-2x blue",style:"color: blue"});L.marker(e.latlng,{icon:gpsicon}).addTo(map)}),map.on("locationerror",function(e){vm.gpstracking=!1,$interval.cancel(gpstracktimer),MapEvents.ClearGPS(),PopupService.Warning("Browser heeft geen toegang tot locatiegegevens")})}).$inject=["BaseLayersService","ExternService","MapService","MapData","map","MapEvents","DrawService","GisHelperService","GISService","PopupService","$interval","UIService","tinkApi","FeatureService","$modal"],angular.module("tink.gis").controller("themeController",["$scope","MapService","ThemeService",function($scope,MapService,ThemeService,$timeout){var vm=this;console.log("Theme geladen"),vm.theme=$scope.theme,vm.hidedelete=$scope.hidedelete,vm.chkChanged=function(){ThemeService.UpdateThemeVisibleLayers(vm.theme)},vm.deleteTheme=function(){swal({title:"Verwijderen?",text:"U staat op het punt om "+vm.theme.Naam+" te verwijderen.",type:"warning",showCancelButton:!0,cancelButtonText:"Annuleer",confirmButtonColor:"#DD6B55",confirmButtonText:"Verwijder",closeOnConfirm:!0},function(){ThemeService.DeleteTheme(vm.theme),$scope.$applyAsync()}),console.log(vm.theme)},vm.transpSlider={value:100*vm.theme.Opacity,options:{hideLimitLabels:!0,hidePointerLabels:!0,floor:0,ceil:100,onEnd:function(){vm.theme.SetOpacity(vm.transpSlider.value/100)},onStart:function(){}}},setTimeout(function(){$scope.$broadcast("rzSliderForceRender"),$scope.$applyAsync()},1)}]),angular.module("tink.gis").directive("indeterminateCheckbox",[function(){return{scope:!0,require:"?ngModel",link:function(scope,element,attrs,modelCtrl){var childList=attrs.childList,property=attrs.property;element.bind("change",function(){scope.$applyAsync(function(){var isChecked=element.prop("checked");angular.forEach(scope.$eval(childList),function(child){child[property]=isChecked})})});var thelist=scope.$eval(childList);thelist&&scope.$watch(function(){return thelist.map(function(x){return x[property]})},function(newValue,oldValue){var hasChecked=!1,hasUnchecked=!1;angular.forEach(newValue,function(child){child?hasChecked=!0:hasUnchecked=!0}),hasChecked&&hasUnchecked?(element.prop("checked",!0),element.prop("indeterminate",!0),modelCtrl&&modelCtrl.$setViewValue(!0)):(element.prop("checked",hasChecked),element.prop("indeterminate",!1),modelCtrl&&modelCtrl.$setViewValue(hasChecked))},!0)}}}]),angular.module("tink.gis").directive("tinkLayer",["RecursionHelper",function(RecursionHelper){return{replace:!1,scope:{layer:"=",layercheckboxchange:"&"},templateUrl:"templates/other/layerTemplate.html",controller:"layerController",controllerAs:"lyrctrl",compile:function(element){return RecursionHelper.compile(element)}}}]),angular.module("tink.gis").directive("tinkLayers",function(){return{replace:!0,templateUrl:"templates/other/layersTemplate.html",controller:"layersController",controllerAs:"lyrsctrl"}}),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.directive("tinkMap",function(){return{replace:!0,templateUrl:"templates/other/mapTemplate.html",controller:"mapController",controllerAs:"mapctrl"}})}(),angular.module("tink.gis").directive("tinkTheme",function(){return{replace:!0,scope:{theme:"=",layercheckboxchange:"&",hidedelete:"="},templateUrl:"templates/other/themeTemplate.html",controller:"themeController",controllerAs:"thmctrl"}}),function(){try{var module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}module.factory("BaseLayersService",function(map){var _baseLayersService={basemap2Naam:"Geen",basemap1Naam:"Geen",setBaseMap:function(id,naam,url){var maxZoom=3<arguments.length&&void 0!==arguments[3]?arguments[3]:20,minZoom=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,layer=L.esri.tiledMapLayer({url:url,maxZoom:maxZoom,minZoom:minZoom,continuousWorld:!0});1==id?(_baseLayersService.basemap1&&map.removeLayer(_baseLayersService.basemap1),_baseLayersService.basemap1Naam=naam,_baseLayersService.basemap1=layer,_baseLayersService.basemap1.addTo(map)):2==id&&(_baseLayersService.basemap2&&map.removeLayer(_baseLayersService.basemap2),_baseLayersService.basemap2=layer,_baseLayersService.basemap2Naam=naam)}};return _baseLayersService.setBaseMap(1,"Kaart","https://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/P_basemap/MapServer"),_baseLayersService.setBaseMap(2,"Luchtfoto","https://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/Luchtfoto_2015/MapServer"),_baseLayersService})}(),L.Draw.Rectangle=L.Draw.Rectangle.extend({_getTooltipText:function(){var latLngs,area,tooltipText=L.Draw.SimpleShape.prototype._getTooltipText.call(this);return this._shape&&(latLngs=this._shape.getLatLngs(),area=L.GeometryUtil.geodesicArea(latLngs),L.GeometryUtil.readableArea(area,this.options.metric)),{text:tooltipText.text,subtext:""}}}),function(){try{var module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}module.factory("DrawService",function(MapData,map){var _service={StartDraw:function(DrawingOptie){var options={metric:!0,showArea:!0,shapeOptions:{stroke:!0,color:"#22528b",weight:2,opacity:.6,fillColor:null,fillOpacity:.4,clickable:!1}};switch(MapData.DrawingType){case DrawingOption.LIJN:case DrawingOption.AFSTAND:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Polyline(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Polyline(map,options),MapData.DrawingExtendedObject.enable());break;case DrawingOption.POLYGON:case DrawingOption.OPPERVLAKTE:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Polygon(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Polygon(map,options),MapData.DrawingExtendedObject.enable());break;case DrawingOption.VIERKANT:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Rectangle(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Rectangle(map,options),MapData.DrawingExtendedObject.enable())}}};return _service})}();var esri2geo={};!function(){function toGeoJSON(data,cb){if("string"==typeof data){if(cb)return void function(url,cb){if("undefined"!=typeof module){var request=require("request");return request(url,{json:!0},function(e,r,b){cb(e,b)})}var req=new XMLHttpRequest;req.onreadystatechange=function(){4===req.readyState&&200===req.status&&cb(null,JSON.parse(req.responseText))},req.open("GET",url),req.send()}(data,function(err,d){toGeoJSON(d,cb)});throw new TypeError("callback needed for url")}for(var geometry,outPut={type:"FeatureCollection",features:[]},fl=data.geometries.length,i=0;i<fl;){var ft=data.geometries[i],outFT={type:"Feature",properties:prop(ft.attributes)};ft.x?outFT.geometry={type:"Point",coordinates:[(geometry=ft).x,geometry.y]}:ft.points?outFT.geometry=points(ft):ft.paths?outFT.geometry=line(ft):ft.rings&&(outFT.geometry=poly(ft)),outPut.features.push(outFT),i++}return outPut}function points(geometry){return 1===geometry.points.length?{type:"Point",coordinates:geometry.points[0]}:{type:"MultiPoint",coordinates:geometry.points}}function line(geometry){return 1===geometry.paths.length?{type:"LineString",coordinates:geometry.paths[0]}:{type:"MultiLineString",coordinates:geometry.paths}}function poly(geometry){return 1===geometry.rings.length?{type:"Polygon",coordinates:geometry.rings}:function(a){var type,coords=[],len=a.length,i=0,len2=coords.length-1;for(;i<len;)ringIsClockwise(a[i])?(coords.push([a[i]]),len2++):coords[len2].push(a[i]),i++;type=1===coords.length?"Polygon":"MultiPolygon";return{type:type,coordinates:1===coords.length?coords[0]:coords}}(geometry.rings)}function ringIsClockwise(ringToTest){for(var pt2,total=0,i=0,rLength=ringToTest.length,pt1=ringToTest[i];i<rLength-1;i++)total+=((pt2=ringToTest[i+1])[0]-pt1[0])*(pt2[1]+pt1[1]),pt1=pt2;return 0<=total}function prop(a){var p={};for(var k in a)a[k]&&(p[k]=a[k]);return p}"undefined"!=typeof module?module.exports=toGeoJSON:esri2geo.toGeoJSON=toGeoJSON}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}module.factory("ExternService",function(MapData,map,GISService,ThemeCreater,WMSService,ThemeService,$q,BaseLayersService,FeatureService,ResultsData,PopupService){var _externService={GetAllThemes:function(){var legendItem={};return legendItem.EsriThemes=MapData.Themes.filter(function(x){return x.Type==ThemeType.ESRI}),legendItem.WmsThemes=MapData.Themes.filter(function(x){return x.Type==ThemeType.WMS}),legendItem},SetPrintPreview:function(){var cent=map.getCenter(),html=$("html");html.hasClass("print")||html.addClass("print"),html.hasClass("landscape")&&html.removeClass("landscape"),map.invalidateSize(!1),map.setView(cent)},Export:function(){var exportObject={},arr=MapData.Themes.map(function(theme){var returnitem={};return theme.Naam||(theme.Naam="no_title_found"),returnitem.Naam=theme.Naam,returnitem.cleanUrl=theme.cleanUrl||theme.Url,returnitem.opacity=theme.Opacity,returnitem.type=theme.Type,returnitem.visible=theme.Visible,returnitem.layers=theme.AllLayers.filter(function(x){return 1==x.enabled}).map(function(layer){var returnlayer={};return returnlayer.visible=layer.visible,theme.Type==ThemeType.ESRI?(returnlayer.name=layer.name,returnlayer.id=layer.id):(returnlayer.name=layer.title,returnlayer.id=layer.title),returnlayer}),returnitem});return exportObject.themes=arr,exportObject.extent=map.getBounds(),exportObject.isKaart=!0,MapData.QueryLayers&&(exportObject.QueryLayers=MapData.QueryLayers.map(function(queryLayer){return{LayerId:queryLayer.layer.layerId,Name:queryLayer.layer.name,BaseUrl:queryLayer.layer.baseUrl,Where:queryLayer.layer.query,LayerName:queryLayer.layer.layerName}})),exportObject},Import:function(project){console.log(project),_externService.setExtent(project.extent),ThemeService.DeleteAllQueryLayers();var themesArray=[],promises=[];project.themes.forEach(function(theme){if(theme.type==ThemeType.ESRI){var prom=GISService.GetThemeData(theme.cleanUrl);promises.push(prom),prom.then(function(data){if(data)if(data.error)PopupService.ErrorWithException("Fout bij laden van mapservice","Kan mapservice met volgende url niet laden: "+theme.cleanUrl,data.error);else{var arcgistheme=ThemeCreater.createARCGISThemeFromJson(data,theme);themesArray.push(arcgistheme)}else{var options={timeOut:1e4};PopupService.Warning("U hebt geen rechten om het thema "+theme.Naam+" te raadplegen.","Klik hier om toegang aan te vragen.",function(){window.open("https://um.antwerpen.be/main.aspx","_blank").focus()},options)}})}else{var _prom=WMSService.GetThemeData(theme.cleanUrl);promises.push(_prom),_prom.success(function(data,status,headers,config){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,theme.cleanUrl);themesArray.push(wmstheme)}).error(function(data,status,headers,config){console.log("error!!!!!!!",data,status,headers,config)})}}),_.each(project.queryLayers,function(queryLayer){var queryLayerTheme={cleanUrl:queryLayer.baseUrl,naam:"QueryLayer",type:ThemeType.ESRI,visible:!0},prom=GISService.GetThemeData(queryLayer.baseUrl);promises.push(prom),prom.then(function(data){if(data)if(data.error)PopupService.ErrorWithException("Fout bij laden van mapservice","Kan mapservice met volgende url niet laden: "+queryLayerTheme.cleanUrl,data.error);else{var arcgistheme=ThemeCreater.createARCGISThemeFromJson(data,queryLayerTheme);GISService.GetAditionalLayerInfo(arcgistheme);var layerName=queryLayer.name;queryLayer.layerName&&null!==queryLayer.layerName.match(/^ *$/)&&(layerName=queryLayer.layerName),ThemeService.AddQueryLayerFromImport(queryLayer.name,queryLayer.layerId,queryLayer.where,layerName,arcgistheme)}else{var options={timeOut:1e4};PopupService.Warning("U hebt geen rechten om het thema "+queryLayerTheme.Naam+" te raadplegen.","Klik hier om toegang aan te vragen.",function(){window.open("https://um.antwerpen.be/main.aspx","_blank").focus()},options)}})});var allpromises=$q.all(promises);return allpromises.then(function(){var orderedArray=[],errorMessages=[];if(project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.cleanUrl==theme.cleanUrl});realTheme&&(console.log(theme," vs real theme: ",realTheme),realTheme.Visible=theme.visible,realTheme.AllLayers.length==theme.layers.length?realTheme.Added=!0:realTheme.Added=null,realTheme.AllLayers.forEach(function(layer){layer.enabled=!1}),theme.layers.forEach(function(layer){var realLayer=realTheme.AllLayers.find(function(x){return x.title==layer.name});realLayer?(realLayer.visible=layer.visible,realLayer.enabled=!0):errorMessages.push('"'+layer.name+'" not found in mapserver: '+realTheme.Naam+".")}))}),project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.cleanUrl==theme.cleanUrl});realTheme&&(orderedArray.unshift(realTheme),realTheme.status=ThemeStatus.NEW)}),ThemeService.AddAndUpdateThemes(orderedArray),console.log("all loaded"),0<errorMessages.length&&PopupService.Warning("Fout bij import",errorMessages.join("\n")),FeatureService.defaultLayerName){var defaultLayer=MapData.VisibleLayers.find(function(x){return x.name==FeatureService.defaultLayerName});defaultLayer&&(MapData.SelectedLayer=defaultLayer,MapData.SelectedFindLayer=defaultLayer,MapData.DefaultLayer=defaultLayer)}}),allpromises},setExtent:function(extent){map.fitBounds([[extent._northEast.lat,extent._northEast.lng],[extent._southWest.lat,extent._southWest.lng]])},setExtendFromResults:function(){if(ResultsData.JsonFeatures&&0<ResultsData.JsonFeatures.length){var featuregrp=L.featureGroup();ResultsData.JsonFeatures.forEach(function(feature){featuregrp.addLayer(feature.mapItem)});var featureBounds=featuregrp.getBounds();map.fitBounds(featureBounds)}},SetCityExtent:function(){_externService.setExtent({_northEast:{lat:"51.3877433490741",lng:"4.75561140002421"},_southWest:{lat:"51.1324947954227",lng:"3.95971169623321"}})},CleanMapAndThemes:function(){MapData.CleanMap(),ThemeService.CleanThemes(),ThemeService.DeleteAllQueryLayers()},LoadConfig:function(config){Gis.GeometryUrl=config.Gis.GeometryUrl,Gis.BaseUrl=config.Gis.BaseUrl,Style.Default=config.Style.Default,Style.HIGHLIGHT=config.Style.HIGHLIGHT,Style.BUFFER=config.Style.BUFFER,BaseLayersService.setBaseMap(1,config.BaseKaart1.Naam,config.BaseKaart1.Url,config.BaseKaart1.MaxZoom,config.BaseKaart1.MinZoom),BaseLayersService.setBaseMap(2,config.BaseKaart2.Naam,config.BaseKaart2.Url,config.BaseKaart2.MaxZoom,config.BaseKaart2.MinZoom)}};return _externService})}(),angular.module("tink.gis").factory("FeatureService",function(){var _featureService={layerManagementButtonIsEnabled:!0,deleteLayerButtonIsEnabled:!0,exportToCSVButtonIsEnabled:!0,defaultLayerName:null,ConfigResultButton:function(isEnabled,text,callback,conditioncallback){_featureService.resultButtonText=text,_featureService.extraResultButtonIsEnabled=isEnabled,callback&&(_featureService.extraResultButtonCallBack=callback),conditioncallback&&(_featureService.extraResultButtonConditionCallBack=conditioncallback)},ConfigSecondResultButton:function(isEnabled,text,callback,conditioncallback){_featureService.secondResultButtonText=text,_featureService.secondResultButtonIsEnabled=isEnabled,callback&&(_featureService.secondResultButtonCallBack=callback),conditioncallback&&(_featureService.secondResultButtonConditionCallBack=conditioncallback)},extraResultButtonIsEnabled:!1,secondResultButtonIsEnabled:!1,resultButtonText:"extra knop text",secondResultButtonText:"extra knop text",extraResultButtonCallBack:function(){},extraResultButtonConditionCallBack:function(){return _featureService.extraResultButtonIsEnabled},secondResultButtonConditionCallBack:function(){return _featureService.secondResultButtonIsEnabled}};return _featureService}),function(){var module=angular.module("tink.gis");module.$inject=["$http","MapService","MapData"],module.factory("GeometryService",function($http,MapService,MapData){var _service={Buffer:function(loc,distance,selectedlayer){var geo=getGeo(loc.geometry);delete geo.geometry.spatialReference,geo.geometries=geo.geometry,delete geo.geometry;var sergeo=serialize(geo),url=Gis.GeometryUrl;loc.mapItem&&(loc.mapItem.isBufferedItem=!0);var prom=$http({method:"POST",url:url,data:"inSR=4326&outSR=4326&bufferSR=31370&distances="+100*distance+"&unit=109006&unionResults=true&geodesic=false&geometries=%7B"+sergeo+"%7D&f=json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8;"}});prom.success(function(response){MapData.CleanSearch();var buffer=MapData.CreateBuffer(response);return MapService.Query(buffer,selectedlayer),MapData.SetStyle(loc.mapItem,Style.COREBUFFER,L.AwesomeMarkers.icon({icon:"fa-circle-o",markerColor:"lightgreen"})),prom})},Doordruk:function(location){MapData.CleanSearch(),MapData.CleanMap(),console.log(location),MapService.Query(location,{id:""})}},getGeo=function(geometry){var geoconverted={};return geometry instanceof L.LatLngBounds?(geoconverted.geometry=L.esri.Util.boundsToExtent(geometry),geoconverted.geometryType="esriGeometryEnvelope"):(geometry.getLatLng&&(geometry=geometry.getLatLng()),geometry instanceof L.LatLng&&(geometry={type:"Point",coordinates:[geometry.lng,geometry.lat]}),geometry instanceof L.GeoJSON&&(geometry=geometry.getLayers()[0].feature.geometry,geoconverted.geometry=L.esri.Util.geojsonToArcGIS(geometry),geoconverted.geometryType=L.esri.Util.geojsonTypeToArcGIS(geometry.type)),geometry.toGeoJSON&&(geometry=geometry.toGeoJSON()),"Feature"===geometry.type?geometry=geometry.geometry:(geoconverted.geometry=L.esri.Util.geojsonToArcGIS(geometry),geoconverted.geometryType=L.esri.Util.geojsonTypeToArcGIS(geometry.type))),geoconverted},serialize=function(params){var data="";for(var key in params)if(params.hasOwnProperty(key)){var value,param=params[key],type=Object.prototype.toString.call(param);data.length&&(data+=","),value="[object Array]"===type?"[object Object]"===Object.prototype.toString.call(param[0])?JSON.stringify(param):param.join(","):"[object Object]"===type?JSON.stringify(param):"[object Date]"===type?param.valueOf():'"'+param+'"',data+="geometries"==key?encodeURIComponent('"'+key+'"')+":"+encodeURIComponent("["+value+"]"):encodeURIComponent('"'+key+'"')+":"+encodeURIComponent(value)}return data};return _service})}(),function(){var module=angular.module("tink.gis");module.$inject=["$http","GisHelperService","$q","PopupService"],module.factory("GISService",function($http,GisHelperService,$q,PopupService){var _service={ReverseGeocode:function(event){var lambert72Cords=GisHelperService.ConvertWSG84ToLambert72(event.latlng),loc=lambert72Cords.x+","+lambert72Cords.y,url=(encodeURIComponent(loc),GAAS.ReversedGeocodeUrl+"antwerpaddressbypoint?SR=31370&X="+lambert72Cords.x+"&Y="+lambert72Cords.y+"&buffer=50&count=1"),prom=$http.get(url);return prom.success(function(data,status,headers,config){}).error(function(data,status,headers,config){PopupService.ErrorFromHttp(data,status,url)}),prom},QueryCrab:function(straatnaamid,huisnummer){for(var prom=$q.defer(),query="https://geoint.antwerpen.be/arcgissql/rest/services/P_Stad/CRAB_adresposities/MapServer/0/query?where=GEMEENTE%3D%27Antwerpen%27",i=0;i<straatnaamid.length;i++)1<straatnaamid.length?query+=0==i?"%20and%20(STRAATNMID%20%3D%27"+straatnaamid[i]+"%27":"%20or%20STRAATNMID%20%3D%27"+straatnaamid[i]+"%27":query+="%20and%20STRAATNMID%20%3D%27"+straatnaamid[i]+"%27";return 1<straatnaamid.length&&(query+=")"),query+="%20and%20(HUISNR%20like%20%27"+huisnummer+"%27%20or%20Huisnr%20like%20%27"+huisnummer+"%5Ba-z%5D%27or%20Huisnr%20like%20%27"+huisnummer+"%5B_%5D%25%27)%20and%20APPTNR%20%3D%20%27%27%20and%20busnr%20%3D%20%27%27&text=&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&outFields=*&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&returnDistinctValues=false&f=pjson",$http.get(query).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},QueryCrabName:function(straatnaam,huisnummer){var prom=$q.defer(),query="https://geoint.antwerpen.be/arcgissql/rest/services/P_Stad/CRAB_adresposities/MapServer/0/query?where=GEMEENTE%3D%27Antwerpen%27";return query+="%20and%20STRAATNAAM%20%3D%27"+straatnaam+"%27",query+="%20and%20(HUISNR%20like%20%27"+huisnummer+"%27%20or%20Huisnr%20like%20%27"+huisnummer+"%5Ba-z%5D%27or%20Huisnr%20like%20%27"+huisnummer+"%5B_%5D%25%27)%20and%20APPTNR%20%3D%20%27%27%20and%20busnr%20%3D%20%27%27&text=&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&outFields=*&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&returnDistinctValues=false&f=pjson",$http.get(query).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},QuerySOLRGIS:function(search){var prom=$q.defer(),url=Solr.BaseUrl+"giszoek/solr/search?q=*"+search+"*&wt=json&indent=true&facet=true&rows=999&facet.field=parent&group=true&group.field=parent&group.limit=999&solrtype=gis";return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},QueryLocationPickerLocation:function(search){var prom=$q.defer(),url=LocationPicker.BaseUrl+"locations?search="+search+"&sort=name&limit=50&layers=all&prioritizelayer=district,straatnaam";return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},QueryLocationPickerAddress:function(streetName,houseNumber){var prom=$q.defer(),url=LocationPicker.BaseUrl+"addresses?streetname="+streetName+"&housenumber="+houseNumber;return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},QuerySOLRLocatie:function(search){var prom=$q.defer(),url=Solr.BaseUrl+"giszoek/solr/search?q=*"+search+"*&wt=json&indent=true&rows=50&solrtype=gislocaties&dismax=true&bq=exactName:DISTRICT^20000.0&bq=layer:straatnaam^20000.0";return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise}},completeUrl=function(url){return url},generateOptionsBasedOnUrl=function(url,opts){return opts||(opts={}),url.toLowerCase().includes("p_sik")&&(opts.withCredentials=!0),opts};return _service.GetThemeData=function(mapserver){var prom=$q.defer(),url=completeUrl(mapserver)+"?f=pjson";return console.log("ZZZZZ"),$http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){console.log("ZZZZZ"),url.toLocaleLowerCase().contains("p_sik")?prom.resolve(null):(prom.reject(null),PopupService.ErrorFromHttp(data,status,url))}),prom.promise},_service.GetThemeLayerData=function(cleanurl){var prom=$q.defer(),url=completeUrl(cleanurl)+"/layers?f=pjson";return $http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.GetLegendData=function(cleanurl){var prom=$q.defer(),url=completeUrl(cleanurl)+"/legend?f=pjson";return $http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.GetLayerSpecification=function(layerUrl){var prom=$q.defer(),url=layerUrl+"?f=pjson";return $http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.GetAditionalLayerInfo=function(theme){_service.GetLegendData(theme.cleanUrl).then(function(data){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.layerId==layerid});layer.legend=[],layerInfo&&(layer.legend=layerInfo.legend,layer.legend.forEach(function(legenditem){legenditem.fullurl="data:"+legenditem.contentType+";base64,"+legenditem.imageData}))})}),_service.GetThemeLayerData(theme.cleanUrl).then(function(data){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.id==layerid});layer.displayField=layerInfo.displayField,layer.fields=layerInfo.fields})})},_service})}();_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.factory("GisHelperService",function(){var _service={};proj4.defs("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs");_service.getEnvironment=function(){return window.location.href.startsWith("https://stadinkaart.antwerpen.be/")?"P":window.location.href.startsWith("https://stadinkaart-a.antwerpen.be/")?"A":window.location.href.startsWith("https://stadinkaart-o.antwerpen.be/")?"O":window.location.href.startsWith("https://localhost/")?"D":"L"},_service.CreateProxyUrl=function(url){return(window.location.href.startsWith("https://stadinkaart-a.antwerpen.be/")?"https://stadinkaart-a.antwerpen.be/digipolis.stadinkaart.api/":window.location.href.startsWith("https://stadinkaart-o.antwerpen.be/")?"https://stadinkaart-o.antwerpen.be/digipolis.stadinkaart.api/":window.location.href.startsWith("https://stadinkaart.antwerpen.be/")?"https://stadinkaart.antwerpen.be/digipolis.stadinkaart.api/":"https://localhost/digipolis.stadinkaart.api/")+"Proxy/go?url="+encodeURIComponent(url)},_service.UnwrapProxiedData=function(data){return"string"==typeof data&&data.startsWith('{"listOfString":')?data=$.parseJSON(data).listOfString:"object"==(void 0===data?"undefined":_typeof(data))&&data.listOfString&&(data=data.listOfString),"string"==typeof data&&data.startsWith("{")&&(data=JSON.parse(data)),"string"==typeof data&&data.startsWith('<?xml version="1.0" encoding="UTF-8"?>')&&(data=data.slice(38).trim()),data},_service.ConvertWSG84ToLambert72=function(coordinates){var result=proj4("EPSG:31370",[coordinates.lng||coordinates.x,coordinates.lat||coordinates.y]);return{x:result[0],y:result[1]}},_service.ConvertLambert72ToWSG84=function(coordinates){var x=coordinates.lng||coordinates.x||coordinates[0],y=coordinates.lat||coordinates.y||coordinates[1],result=proj4("EPSG:31370","WGS84",[parseFloat(x),parseFloat(y)]);return{y:result[0],x:result[1]}};var isCharDigit=function(n){return" "!=n&&-1<n};return _service.getWGS84CordsFromString=function(search){var returnobject={hasCordinates:!1,error:null,x:null,y:null},currgetal="",samegetal=!1,aantalmetcorrectesize=0,hasaseperater=!1,getals=[];if((search.contains("51.")||search.contains("51,"))&&(search.contains("4.")||search.contains("4,"))){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=search[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var char=_step.value;isCharDigit(char)?samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0):"51"!=currgetal&&"4"!=currgetal||"."!=char&&","!=char||0!=hasaseperater?(""!=currgetal&&getals.push(currgetal),currgetal="",hasaseperater=samegetal=!1):(currgetal+=char,aantalmetcorrectesize++,hasaseperater=!0)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}""!=currgetal&&getals.push(currgetal)}return 2==aantalmetcorrectesize&&2==getals.length?(returnobject.x=getals[0].replace(",","."),returnobject.y=getals[1].replace(",","."),returnobject.hasCordinates=!0):returnobject.error="Incorrect format: X,Y is required",returnobject},_service.getLambartCordsFromString=function(search){var returnobject={hasCordinates:!1,error:null,x:null,y:null},getals=[],currgetal="",samegetal=!1,aantalmet6size=0,hasaseperater=!1,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=search[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var char=_step2.value;if(isCharDigit(char))samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0);else{if(6==currgetal.length){if(!(125e3<currgetal&&currgetal<175e3||18e4<currgetal&&currgetal<24e4))return returnobject.error="Out of bounds cordinaten voor Antwerpen.",returnobject;aantalmet6size++}","!=char&&"."!=char||0!=hasaseperater?(hasaseperater=!1,getals.push(currgetal),currgetal="",samegetal=!1):(hasaseperater=!0,currgetal+=char)}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return""!=currgetal&&(6==currgetal.length&&aantalmet6size++,getals.push(currgetal)),getals=getals.filter(function(x){return""!=x.trim()}),2==aantalmet6size&&2==getals.length?(returnobject.x=getals[0].replace(",","."),returnobject.y=getals[1].replace(",","."),returnobject.hasCordinates=!0):returnobject.error="Incorrect format: Lat,Lng is required",returnobject},_service})}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi",["ui.sortable"]])}module.$inject=[],module.factory("LayersService",function(){return{}})}(),L.Control.Typeahead=L.Control.extend({options:{position:"topleft"},initialize:function(args){console.log("init"),this.arguments=[];for(var i=0;i<args.length-1;i++)this.arguments.push(args[i]);L.Util.setOptions(this,args[args.length-1])},onAdd:function(map){console.log("onadd");var that=this,container=L.DomUtil.create("div","");return container.style.position="absolute",this.typeahead=L.DomUtil.create("input","typeahead tt-input",container),this.typeahead.type="text",this.typeahead.id="okzor",this.typeahead.placeholder=this.options.placeholder,$(this.typeahead).typeahead.apply($(this.typeahead),this.arguments),["typeahead:active","typeahead:idle","typeahead:open","typeahead:close","typeahead:change","typeahead:render","typeahead:select","keyup","typeahead:autocomplete","typeahead:cursorchange","typeahead:asyncrequest","typeahead:asynccancel","typeahead:asyncreceive"].forEach(function(method){that.options[method]&&$(that.typeahead).bind(method,that.options[method])}),L.DomEvent.disableClickPropagation(container),container},onRemove:function(map){},keyup:function(e){console.log("typeahead KEYUP!!",e),13==e.keyCode&&$(".tt-suggestion:first-child",this).trigger("click"),38===e.keyCode||e.keyCode},itemSelected:function(e){console.log("item selcted"),L.DomEvent.preventDefault(e)},submit:function(e){console.log("submit"),L.DomEvent.preventDefault(e)}}),L.control.typeahead=function(args){return new L.Control.Typeahead(arguments)},function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}module.factory("LoadingService",function(){var _loadingService={Init:void 0,ShowLoading:function(){var html=$("html");html.hasClass("show-loader")||html.addClass("show-loader")},HideLoading:function(){var html=$("html");html.hasClass("show-loader")&&html.removeClass("show-loader")}};return _loadingService})}(),function(){var module=angular.module("tink.gis");module.$inject=["ResultsData","FeatureService","SearchService"],module.factory("MapData",function(map,$rootScope,GisHelperService,ResultsData,$compile,FeatureService,SearchService,$timeout){var _data={VisibleLayers:[],SelectableLayers:[],VisibleFeatures:[],TempExtendFeatures:[],IsDrawing:!1,Themes:[],defaultlayer:{id:"",name:"Alle lagen"}};_data.VisibleLayers.unshift(_data.defaultlayer),_data.SelectedLayer=_data.defaultlayer,_data.DrawLayer=null,_data.DefaultLayer=null,_data.QueryLayers=[],_data.SelectedFindLayer=_data.defaultlayer,_data.ResetVisibleLayers=function(){console.log("RestVisLayers");var curSelectedLayer=_data.SelectedLayer||_data.defaultlayer;_data.VisibleLayers.length=0,_data.Themes.filter(function(x){return x.Type===ThemeType.ESRI}).forEach(function(x){_data.VisibleLayers=_data.VisibleLayers.concat(x.VisibleLayers)}),_data.VisibleLayers=_data.VisibleLayers.sort(function(x){return x.title}),_data.VisibleLayers.unshift(_data.defaultlayer);var reselectLayer=_data.VisibleLayers.find(function(x){return x.name==curSelectedLayer.name});_data.SelectedLayer=reselectLayer||_data.defaultlayer,_data.AddQueryLayersToVisibleLayers()},_data.AddQueryLayersToVisibleLayers=function(){_data.QueryLayers.filter(function(x){return!0===x.showLayer}).forEach(function(q){_data.VisibleLayers=_data.VisibleLayers.concat({name:q.layer.name+" (query)",isQueryLayer:!0,layer:q})})},_data.ActiveInteractieKnop=ActiveInteractieButton.NIETS,_data.DrawingType=DrawingOption.NIETS,_data.ShowDrawControls=!1,_data.RemovedUnfinishedDrawings=!1,_data.ShowMetenControls=!1,_data.LastBufferedLayer=null,_data.LastBufferedDistance=50,_data.ExtendedType=null,_data.DrawingObject=null,_data.DrawingExtendedObject=null,_data.LastIdentifyBounds=null,_data.CleanDrawingExtendedObject=function(){_data.DrawingExtendedObject&&(_data.DrawingExtendedObject.layer&&(_data.DrawingExtendedObject.layer._popup=null),_data.DrawingExtendedObject.disable&&_data.DrawingExtendedObject.disable(),map.extendFeatureGroup.clearLayers(),_data.DrawingExtendedObject=null)},map.on("draw:created",function(event){var layer=event.layer;null==_data.ExtendedType?map.featureGroup.addLayer(layer):map.extendFeatureGroup.addLayer(layer)}),_data.CleanDrawings=function(){_data.CleanDrawingExtendedObject(),_data.DrawingObject&&(_data.DrawingObject.layer&&(_data.DrawingObject.layer._popup=null),_data.DrawingObject.disable&&_data.DrawingObject.disable(),_data.DrawingObject=null,_data.DrawLayer=null,map.clearDrawings())},_data.SetDrawPoint=function(latlng){var pinIcon=L.AwesomeMarkers.icon({icon:"fa-map-pin",markerColor:"orange"});_data.SetDrawLayer(L.marker(latlng,{icon:pinIcon}).addTo(map))},_data.SetDrawLayer=function(layer){_data.DrawLayer=layer,_data.DrawingObject=layer,map.addToDrawings(layer)},_data.SetStyle=function(mapItem,polyStyle,pointStyle){if(mapItem){var tmplayer=mapItem._layers[Object.keys(mapItem._layers)[0]];tmplayer._latlngs?tmplayer.setStyle(polyStyle):tmplayer.setIcon(pointStyle)}};var WatIsHierMarker=null,WatIsHierOriginalMarker=null;_data.CleanMap=function(){_data.CleanDrawings(),_data.CleanWatIsHier(),_data.CleanBuffer(),_data.CleanTempFeatures()},_data.bufferLaag=null,_data.CreateBuffer=function(gisBufferData){var esrigj=esri2geo.toGeoJSON(gisBufferData),gj=new L.GeoJSON(esrigj,{style:Style.BUFFER});return _data.bufferLaag=gj.addTo(map),map.fitBounds(_data.bufferLaag.getBounds()),_data.bufferLaag},_data.CleanBuffer=function(){for(var bufferitem={},x=0;x<_data.VisibleFeatures.length;x++)_data.VisibleFeatures[x].isBufferedItem&&(bufferitem=_data.VisibleFeatures[x],map.removeLayer(bufferitem));var index=_data.VisibleFeatures.indexOf(bufferitem);-1<index&&_data.VisibleFeatures.splice(index,1),_data.bufferLaag&&(map.removeLayer(_data.bufferLaag),_data.bufferLaag=null)},_data.CleanTempFeatures=function(){tempFeatures.forEach(function(tempfeature){map.removeLayer(tempfeature)}),tempFeatures.length=0},_data.GetZoomLevel=function(){return map.getZoom()},_data.GetScale=function(){return Scales[_data.GetZoomLevel()]},_data.CleanWatIsHier=function(){WatIsHierOriginalMarker&&(WatIsHierOriginalMarker.clearAllEventListeners(),WatIsHierOriginalMarker.closePopup(),map.removeLayer(WatIsHierOriginalMarker),WatIsHierOriginalMarker=null),WatIsHierMarker&&(map.removeLayer(WatIsHierMarker),WatIsHierMarker=null)},_data.UpdateDisplayed=function(Themes){var currentScale=_data.GetScale();_data.Themes.forEach(function(theme){theme.Type==ThemeType.ESRI&&theme.UpdateDisplayed(currentScale)})},_data.Apply=function(){console.log("apply"),$rootScope.$applyAsync()},_data.CreateOrigineleMarker=function(latlng,addressFound,straatNaam){if(addressFound){var foundMarker=L.AwesomeMarkers.icon({icon:"fa-map-marker",markerColor:"orange"});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:foundMarker,opacity:.5}).addTo(map)}else{var notFoundMarker=L.AwesomeMarkers.icon({icon:"fa-question",markerColor:"red",spin:!0});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:notFoundMarker}).addTo(map)}var convertedxy=GisHelperService.ConvertWSG84ToLambert72(latlng),html="",minwidth=0;html=straatNaam?'<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-3" align="center" ><a href="http://maps.google.com/maps?q=&layer=c&cbll='+latlng.lat+","+latlng.lng+'" + target="_blank" ><img tink-tooltip="Ga naar streetview" tink-tooltip-align="bottom" src="https://seeklogo.com/images/G/google-street-view-logo-665165D1A8-seeklogo.com.png" width="70%" height="70%" /></a></div><div class="col-sm-8"><div class="col-sm-12"><b>'+straatNaam+'</b></div><div class="col-sm-3">WGS84:</div><div id="wgs" class="col-sm-8" style="text-align: left;">{{WGS84LatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer" ng-click="CopyWGS()"  tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"  ></i></div><div class="col-sm-3">Lambert:</div><div id="lambert" class="col-sm-8" style="text-align: left;">{{LambertLatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer"  ng-click="CopyLambert()" tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div></div>':'<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-3" ><a href="http://maps.google.com/maps?q=&layer=c&cbll='+latlng.lat+","+latlng.lng+'" + target="_blank" ><img tink-tooltip="Ga naar streetview" tink-tooltip-align="bottom" src="https://seeklogo.com/images/G/google-street-view-logo-665165D1A8-seeklogo.com.png" width="70%" height="70%" /></a></div><div class="col-sm-8"><div class="col-sm-3">WGS84:</div><div id="wgs" class="col-sm-8" style="text-align: left;">{{WGS84LatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer" ng-click="CopyWGS()"  tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"  ></i></div><div class="col-sm-3">Lambert:</div><div id="lambert" class="col-sm-8" style="text-align: left;">{{LambertLatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer"  ng-click="CopyLambert()" tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div></div>',minwidth=300;var linkFunction=$compile(html),newScope=$rootScope.$new();newScope.LambertLatLng=convertedxy.x.toFixed(1)+", "+convertedxy.y.toFixed(1),newScope.CopyLambert=function(){copyToClipboard("#lambert")},newScope.CopyWGS=function(){copyToClipboard("#wgs")},newScope.WGS84LatLng=latlng.lat.toFixed(6)+", "+latlng.lng.toFixed(6);var domele=linkFunction(newScope)[0];WatIsHierOriginalMarker.bindPopup(domele,{minWidth:minwidth,closeButton:!0}).openPopup().on("popupclose",function(){_data.CleanWatIsHier()})};var copyToClipboard=function(element){var $temp=$("<input>");$("body").append($temp),$temp.val($(element).text()).select(),document.execCommand("copy"),$temp.remove()};_data.CreatePerimeterMarker=function(perimeter,surfaceArea,e){var linkFunction=$compile('<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-5">Opp (m<sup>2</sup>):</div><div id="surfacearea" class= "col-sm-6" style="text-align: left">'+surfaceArea+'</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer"  ng-click="CopySurfaceArea()" tink-tooltip="Oppervlakte kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div><div class="row row-no-padding"><div class="col-sm-5">Omtrek (m):</div><div id="perimeter" class= "col-sm-6" style="text-align: left">'+perimeter+'</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer"  ng-click="CopyPerimeter()" tink-tooltip="Omtrek kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div>'),newScope=$rootScope.$new();newScope.CopySurfaceArea=function(){copyToClipboard("#surfacearea")},newScope.CopyPerimeter=function(){copyToClipboard("#perimeter")};var domele=linkFunction(newScope)[0];e.layer.bindPopup(domele,{minWidth:150,closeButton:!0}).on("popupclose",function(event){map.removeLayer(e.layer)}),e.layer.openPopup()},_data.CreateDistanceMarker=function(distance,e){var linkFunction=$compile('<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-5">Afstand (m):</div><div id="distance" class= "col-sm-6" style="text-align: center">'+distance+'</div><div class="col-sm-1"><i class="fa fa-files-o coordinate-pointer"  ng-click="CopyDistance()" tink-tooltip="Afstand kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div>'),newScope=$rootScope.$new();newScope.CopyDistance=function(){copyToClipboard("#distance")};var domele=linkFunction(newScope)[0];e.layer.bindPopup(domele,{minWidth:150,closeButton:!0}).on("popupclose",function(event){map.removeLayer(e.layer)}),e.layer.openPopup()},_data.CreateDot=function(loc){_data.CleanWatIsHier();var dotIcon=L.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABKVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABUJ5OrAAAAYnRSTlMAAQIEBQYICgsNDg8QERITFxgaGyAhJSYoKS8wMTU2ODk7QkRPVFVXXV5fYWJkZ2lrbHF3eHyAg4aMjpSXmJ6jpqirra+wsrS3ucDByszP0dPc3uDi5Obo6evt7/P19/n7/fGWhfoAAAERSURBVBgZXcGHIoJhGIbh5+uXZO+sZK/slZ0tMwkhwn3+B+HtrxTXpapgKOj0n4slC8DX+binWrEcFe8T+uV2qXXhqcSdYvYGmurD/Ylv4M6TLwGk21QSugROVBQBjgKqcFvAmMwNPHiqclfwEpC6gB4VRdeWumQagai0CLcy7hwzK7MPe9IFzMjE8XVKisGr9AyDMhl8C5LagYA+ISLzhm9VUjPgKQvDMtv4hiR1Ak5JWJFpyGPOZMYhI03Bo4oadvKZuJNJwabUDIyqVjfQK+kICmFV1T1BWqYVuA+rIpgCIiqaBD5GVNKXAzZUso7JLkcjQ3NpzIFT2RS11lTVdkzFdbf+aJk+zH4+n813qOwHxGRbFJ0DoNgAAAAASUVORK5CYII=",iconSize:[24,24]});WatIsHierMarker=L.marker([loc.x,loc.y],{icon:dotIcon}).addTo(map)},_data.CreateFeatureLayerMarker=function(loc,iconUrl){var icon=L.icon({iconUrl:iconUrl,iconAnchor:[10,10]});return L.marker(loc,{icon:icon})},_data.CleanSearch=function(){ResultsData.CleanSearch();for(var bufferitem=null,x=0;x<_data.VisibleFeatures.length;x++)_data.VisibleFeatures[x].isBufferedItem?bufferitem=_data.VisibleFeatures[x]:map.removeLayer(_data.VisibleFeatures[x]);_data.VisibleFeatures.length=0,bufferitem&&_data.VisibleFeatures.push(bufferitem)},_data.PanToPoint=function(loc){map.setView(L.latLng(loc.x,loc.y),12)},_data.PanToFeature=function(feature){console.log("PANNING TO FEATURE");var featureBounds=feature.getBounds();map.fitBounds(featureBounds)},_data.PanToItem=function(item){var geojsonitem=item.toGeoJSON();geojsonitem.features&&(geojsonitem=geojsonitem.features[0]),"Point"==geojsonitem.geometry.type?_data.PanToPoint({x:geojsonitem.geometry.coordinates[1],y:geojsonitem.geometry.coordinates[0]}):_data.PanToFeature(item)},_data.GoToLastClickBounds=function(){map.fitBounds(_data.LastIdentifyBounds,{paddingTopLeft:L.point(0,0),paddingBottomRight:L.point(0,0)})},_data.SetZIndexes=function(){var counter=_data.Themes.length+3;_data.Themes.forEach(function(theme){theme.MapData.ZIndex=counter,theme.Type==ThemeType.ESRI?theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=counter):(theme.MapData.bringToFront(),theme.MapData.setZIndex(counter)),counter--})};var tempFeatures=[];_data.AddTempFeatures=function(featureCollection){featureCollection.features.forEach(function(feature){var mapItem=L.geoJson(feature,{style:Style.DEFAULT}).addTo(map);_data.PanToFeature(mapItem),tempFeatures.push(mapItem)})},_data.processedFeatureArray=[],_data.AddFeatures=function(features,theme,layerId,featureCount){if(features&&0!=features.features.length){if(ResultsData.EmptyResult=!1,featureCount)var featureArray=_data.GetResultsData(features,theme,layerId,featureCount);else featureArray=_data.GetResultsData(features,theme,layerId,features.features.length);null==_data.ExtendedType?featureArray.forEach(function(featureItem){0===ResultsData.JsonFeatures.filter(function(x){return x.id==featureItem.id}).length&&ResultsData.JsonFeatures.push(featureItem)}):_data.processedFeatureArray=featureArray.concat(_data.processedFeatureArray)}else ResultsData.EmptyResult=!0;$rootScope.$applyAsync()},_data.ConfirmExtendDialog=function(){var featureArray=_data.processedFeatureArray;if(0==featureArray.length)_data.TempExtendFeature=[],_data.ExtendedType=null,_data.CleanDrawingExtendedObject(),swal({title:"Oeps!",text:"Geen resultaten met de nieuwe selectie",type:"warning",showCancelButton:!1,confirmButtonColor:"#DD6B55",confirmButtonText:"Ok",closeOnConfirm:!0});else{var dialogtext="Selectie verwijderen?";"add"==_data.ExtendedType&&(dialogtext="Selectie toevoegen?"),swal({title:dialogtext,cancelButtonText:"Ja",confirmButtonText:"Nee",showCancelButton:!0,confirmButtonColor:"#b9b9b9",customClass:"leftsidemodal",closeOnConfirm:!0},function(isConfirm){isConfirm?_data.TempExtendFeatures.forEach(function(x){map.removeLayer(x)}):"add"==_data.ExtendedType?(_data.TempExtendFeatures.forEach(function(x){var item=x.setStyle(Style.DEFAULT);_data.VisibleFeatures.push(item)}),featureArray.forEach(function(featureItem){ResultsData.JsonFeatures.push(featureItem)})):"remove"==_data.ExtendedType&&(featureArray.forEach(function(featureItem){SearchService.DeleteFeature(featureItem);var itemIndex=_data.VisibleFeatures.findIndex(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName});-1<itemIndex&&_data.VisibleFeatures.splice(itemIndex,1)}),_data.TempExtendFeatures.forEach(function(x){map.removeLayer(x)})),_data.TempExtendFeatures=[],_data.ExtendedType=null,_data.processedFeatureArray=[],_data.CleanDrawingExtendedObject()})}},_data.SetDisplayValue=function(featureItem,layer){if(featureItem.displayValue=featureItem.properties[layer.displayField],!featureItem.displayValue){var displayFieldProperties=layer.fields.find(function(x){return x.name==layer.displayField});displayFieldProperties&&featureItem.properties[displayFieldProperties.alias]?featureItem.displayValue=featureItem.properties[displayFieldProperties.alias]:featureItem.displayValue="LEEG"}""==featureItem.displayValue.toString().trim()&&(featureItem.displayValue="LEEG")},_data.SetFieldsData=function(featureItem,layer){var aliasDifferentThanName=!1;layer.fields.forEach(function(field){if(field.name!=field.alias&&null==featureItem.properties[field.alias]&&(aliasDifferentThanName=!0),null==featureItem.properties[field.name]&&null==featureItem.properties[field.alias]&&(featureItem.properties[field.name]=""),"esriFieldTypeDate"==field.type&&"number"==typeof featureItem.properties[field.name]){var date=new Date(featureItem.properties[field.name]),date_string=date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear();featureItem.properties[field.name]=date_string}}),aliasDifferentThanName&&(featureItem.properties=setAliasAsDisplayName(featureItem,layer)),_data.SetDisplayValue(featureItem,layer)};var setAliasAsDisplayName=function(featureItem,layer){var newProperties={};return layer.fields.forEach(function(field){newProperties[field.alias]=featureItem.properties[field.name]}),newProperties};return _data.GetResultsData=function(features,theme,layerId,featureCount){for(var buffereditem=_data.VisibleFeatures.find(function(x){return x.isBufferedItem}),resultArray=[],x=0;x<features.features.length;x++){var featureItem=features.features[x],layer={};if(null!=featureItem.layerId?layer=theme.AllLayers.find(function(x){return x.id===featureItem.layerId}):null!=layerId?layer=theme.AllLayers.find(function(x){return x.id===layerId}):console.log("NO LAYER ID WAS GIVEN EITHER FROM FEATURE ITEM OR FROM PARAMETER"),featureItem.theme=theme,featureItem.layerName=layer.name,theme.Type===ThemeType.ESRI){!function checkforitem(){layer.fields?_data.SetFieldsData(featureItem,layer):$timeout(checkforitem,100)}(),featureItem.properties["Pixel Value"]&&(featureItem.displayValue=featureItem.properties["Pixel Value"]);var thestyle=Style.DEFAULT;if("add"==_data.ExtendedType){if(thestyle=Style.ADD,!_data.VisibleFeatures.some(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName})){var mapItem=L.geoJson(featureItem,{style:thestyle}).addTo(map);_data.TempExtendFeatures.push(mapItem),featureItem.mapItem=mapItem,resultArray.push(featureItem)}}else if("remove"==_data.ExtendedType){if(thestyle=Style.REMOVE,_data.VisibleFeatures.some(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName})){if(mapItem=L.geoJson(featureItem,{style:thestyle}).addTo(map),"Point"==featureItem.geometry.type){var myicon=L.AwesomeMarkers.icon({icon:"fa-dot-circle-o",markerColor:"red"});_data.SetStyle(mapItem,Style.HIGHLIGHT,myicon)}_data.TempExtendFeatures.push(mapItem),featureItem.mapItem=mapItem,resultArray.push(featureItem)}}else{if(buffereditem){var bufferid=buffereditem.toGeoJSON().features[0].id,bufferlayer=buffereditem.toGeoJSON().features[0].layer;bufferid&&bufferid==featureItem.id&&bufferlayer==featureItem.layer?featureItem.mapItem=buffereditem:(mapItem=L.geoJson(featureItem,{style:Style.DEFAULT}).addTo(map),featureItem.mapItem=mapItem,_data.VisibleFeatures.push(mapItem))}else mapItem=L.geoJson(featureItem,{style:thestyle}),featureItem.mapItem=mapItem,(featureCount<=1e3||null==featureCount)&&(_data.VisibleFeatures.push(mapItem),mapItem.addTo(map));resultArray.push(featureItem)}}else resultArray.push(featureItem),featureItem.displayValue=featureItem.properties[Object.keys(featureItem.properties)[0]]}return resultArray},_data})}(),function(){var module=angular.module("tink.gis");module.$inject=["map","MapService","MapData","UIService","$rootScope"],module.factory("MapEvents",function(map,MapService,MapData,UIService,$rootScope){var _mapEvents={};map.on("draw:drawstart",function(event){console.log("draw started"),MapData.IsDrawing=!0}),map.on("draw:drawstop",function(event){console.log("draw stopped"),(MapData.IsDrawing=!1)===MapData.RemovedUnfinishedDrawings&&$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN})});map.on("zoom",function(event){console.log("Zoomend!!!"),MapData.UpdateDisplayed(),MapData.Apply()}),_mapEvents.removeCursorAuto=function(){$(".leaflet-container").hasClass("cursor-auto")&&$(".leaflet-container").removeClass("cursor-auto")},map.on("click",function(event){if(event.originalEvent instanceof MouseEvent)if(console.log("click op map! Is drawing: "+MapData.IsDrawing),MapData.IsDrawing)switch(console.log("DrawingObject: "),console.log(MapData.DrawingObject),MapData.DrawingType){case DrawingOption.AFSTAND:case DrawingOption.OPPERVLAKTE:break;default:console.log("Aant drawen zonder een gekent type!!!!!!")}else switch(MapData.ActiveInteractieKnop){case ActiveInteractieButton.IDENTIFY:MapData.CleanMap(),MapData.LastIdentifyBounds=map.getBounds(),MapService.Identify(event,3),UIService.OpenLeftSide(),$rootScope.$applyAsync(function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}),_mapEvents.removeCursorAuto();break;case ActiveInteractieButton.SELECT:MapData.DrawingType!=DrawingOption.GEEN&&null==MapData.ExtendedType&&(MapData.DrawingType!=DrawingOption.VIERKANT&&MapData.CleanMap(),MapData.CleanSearch()),MapData.DrawingType===DrawingOption.NIETS&&(MapService.Select(event),null===MapData.ExtendedType&&MapData.SetDrawPoint(event.latlng),UIService.OpenLeftSide(),_mapEvents.removeCursorAuto(),$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN,MapData.ShowDrawControls=!1,MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}));break;case ActiveInteractieButton.WATISHIER:MapData.CleanWatIsHier(),MapService.WatIsHier(event),$rootScope.$applyAsync(function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN,_mapEvents.removeCursorAuto()});break;case ActiveInteractieButton.METEN:case ActiveInteractieButton.GEEN:break;default:console.log("MAG NIET!!!!!!!!")}}),map.on("draw:created",function(e){switch(console.log("draw created"),MapData.ActiveInteractieKnop){case ActiveInteractieButton.SELECT:null==MapData.ExtendedType&&(MapData.DrawLayer=e.layer),MapService.Query(e.layer),UIService.OpenLeftSide();break;case ActiveInteractieButton.METEN:switch(MapData.DrawingType){case DrawingOption.AFSTAND:var afstand=function(arrayOfPoints){for(var totalDistance=0,x=0;x!=arrayOfPoints.length-1;x++){var currpoint=arrayOfPoints[x],nextpoint=arrayOfPoints[x+1];totalDistance+=currpoint.distanceTo(nextpoint)}return totalDistance.toFixed(2)}(e.layer._latlngs);MapData.CreateDistanceMarker(afstand,e);break;case DrawingOption.OPPERVLAKTE:var omtrek=function(arrayOfPoints){for(var totalDistance=0,x=0;x!=arrayOfPoints.length;x++){var currpoint=arrayOfPoints[x];if(x==arrayOfPoints.length-1)var nextpoint=arrayOfPoints[0];else nextpoint=arrayOfPoints[x+1];totalDistance+=currpoint.distanceTo(nextpoint)}return totalDistance.toFixed(2)}(e.layer._latlngs[0]);MapData.CreatePerimeterMarker(omtrek,LGeo.area(e.layer).toFixed(2),e)}break;default:console.log("MAG NIET!!!!!!!!")}$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN,MapData.ShowDrawControls=!1,MapData.ShowMetenControls=!1,MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}),MapData.IsDrawing=!1});return _mapEvents.ClearGPS=function(){},map.on("locationerror",function(e){console.log("LOCATIONERROR",e)}),_mapEvents})}();_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}module.$inject=["$rootScope","MapData","map","ThemeCreater","$q","GISService","ResultsData","GisHelperService","PopupService"],module.factory("MapService",function($rootScope,MapData,map,ThemeCreater,$q,GISService,ResultsData,GisHelperService,PopupService){var _mapService={MaxFeatures:1e3,getJsonFromXML:function(data){var json=null;"string"!=typeof data&&(data=JXON.xmlToString(data)),data=(data=(data=data.replace(/wfs:/g,"")).replace(/gml:/g,"")).replace(/dsi:/g,"");var returnjson=JXON.stringToJs(data);if(returnjson.featureinforesponse&&(json=returnjson.featureinforesponse.fields),returnjson.featurecollection)for(var key in JSON.stringify(returnjson.featurecollection.featuremember),returnjson.featurecollection.featuremember)json=returnjson.featurecollection.featuremember[key];return json},getJsonFromPlain:function(data){var json=null,splittedtext=data.trim().split("--------------------------------------------");if(2<=splittedtext.length){var splittedcontent=splittedtext[1].trim().split(/\n|\r/g);0<splittedcontent.length&&(json={}),splittedcontent.forEach(function(line){var splittedline=line.split("=");json[splittedline[0].trim()]=splittedline[1].trim()})}return json},Identify:function(event,tolerance){MapData.CleanSearch(),void 0===tolerance&&(tolerance=3),_.each(MapData.Themes,function(theme){var identifOnThisTheme=!0;if((0===theme.VisibleLayerIds.length||1===theme.VisibleLayerIds.length&&-1===theme.VisibleLayerIds[0])&&(identifOnThisTheme=!1),identifOnThisTheme)switch(theme.Type){case ThemeType.ESRI:var visanddisplayedlayers=theme.VisibleAndDisplayedLayerIds,layersVoorIdentify="all:"+visanddisplayedlayers;0==visanddisplayedlayers.length&&(layersVoorIdentify="visible:-1"),ResultsData.RequestStarted++,theme.MapData.identify().on(map).at(event.latlng).layers(layersVoorIdentify).tolerance(tolerance).run(function(error,featureCollection){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme)});break;case ThemeType.WMS:layersVoorIdentify=theme.VisibleLayerIds,theme.VisibleLayers.forEach(function(lay){console.log(lay),1==lay.queryable&&(ResultsData.RequestStarted++,theme.MapData.getFeatureInfo(event.latlng,lay.name,theme.GetFeatureInfoType).then(function(data,status,xhr){data&&(data=GisHelperService.UnwrapProxiedData(data)),ResultsData.RequestCompleted++;var processedjson=null;switch(theme.GetFeatureInfoType){case"text/xml":processedjson=_mapService.getJsonFromXML(data);break;case"text/plain":processedjson=_mapService.getJsonFromPlain(data)}var returnitem={type:"FeatureCollection",features:[]};if(processedjson){var featureArr=[];"object"===(void 0===processedjson?"undefined":_typeof(processedjson))?featureArr.push(processedjson):featureArr=processedjson,featureArr.forEach(function(feat){var tmpitem={layerName:lay.name,name:lay.name,layerId:lay.name,properties:feat,type:"Feature"};returnitem.features.push(tmpitem)}),console.log(lay.name+" item info: "),console.log(returnitem),MapData.AddFeatures(returnitem,theme)}else $rootScope.$applyAsync()}).then(function(exception){ResultsData.RequestCompleted++}))});break;default:console.log("UNKNOW TYPE!!!!:"),console.log(Theme.Type)}}),_.each(MapData.QueryLayers.filter(function(x){return!0===x.showLayer}),function(queryLayer){queryLayer.layer.mapData&&(ResultsData.RequestStarted++,queryLayer.layer.mapData.query().where(queryLayer.layer.mapData.options.where).layer(queryLayer.layer.layerId).nearby(event.latlng,10).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,queryLayer.theme,queryLayer.layer.layerId,featureCollection.length)}))})},IdentifyProm:function(theme,latlng,layerids){return new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapData.identify().on(map).layers("visible: "+layerids).at(latlng).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,resolve({error:error,featureCollection:featureCollection,response:response})})})},Select:function(event){var queryLayers=MapData.QueryLayers;if(console.log(event),""===MapData.SelectedLayer.id){var allproms=[];MapData.Themes.filter(function(x){return x.Type==ThemeType.ESRI}).forEach(function(theme){if(0!==theme.VisibleLayerIds.length&&-1!==theme.VisibleLayerIds[0]){var prom=_mapService.IdentifyProm(theme,event.latlng,theme.VisibleLayerIds);allproms.push(prom),prom.then(function(arg){MapData.AddFeatures(arg.featureCollection,theme)})}}),null!=MapData.ExtendedType&&Promise.all(allproms).then(function(results){MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[]})}else ResultsData.RequestStarted++,!0===MapData.SelectedLayer.isQueryLayer?queryLayers=[MapData.QueryLayers.find(function(x){return x===MapData.SelectedLayer.layer})]:(queryLayers=[],MapData.SelectedLayer.theme.MapData.identify().on(map).at(event.latlng).layers("visible: "+MapData.SelectedLayer.id).run(function(error,featureCollection){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,MapData.SelectedLayer.theme),null!=MapData.ExtendedType&&(MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[])}));_.each(queryLayers,function(queryLayer){queryLayer.layer.mapData&&!0===queryLayer.showLayer&&queryLayer.layer.mapData.query().where(queryLayer.layer.mapData.options.where).layer(queryLayer.layer.layerId).nearby(event.latlng,10).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,queryLayer.theme,queryLayer.layer.layerId,featureCollection.length)})})},LayerQuery:function(theme,layerid,geometry){return new Promise(function(resolve,reject){ResultsData.RequestStarted++,null!=geometry.mapItem&&(geometry=geometry.mapItem),theme.MapDataWithCors.query().layer(layerid).intersects(geometry).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,featureCollection&&validateFeatureCollectionGeometry(featureCollection.features),resolve({error:error,featureCollection:featureCollection,response:response})})})}},validateFeatureCollectionGeometry=function(features){if(_mapService.MaxFeatures>=features.length)for(var index=0;index<features.length;index++){var element=features[index];if(null==element.geometry&&null!=element.properties.X&&null!=element.properties.Y){var search=element.properties.X.toFixed(8)+","+element.properties.Y.toFixed(8),lambertCheck=GisHelperService.getLambartCordsFromString(search),xyWGS84=GisHelperService.ConvertLambert72ToWSG84({x:lambertCheck.x,y:lambertCheck.y});element.geometry={coordinates:[xyWGS84.y,xyWGS84.x],type:"Point"}}}};return _mapService.LayerQueryCount=function(theme,layerid,geometry){return new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapDataWithCors.query().layer(layerid).intersects(geometry).count(function(error,count,response){ResultsData.RequestCompleted++,resolve({error:error,count:count,response:response})})})},_mapService.AdvancedQueryCount=function(theme,layerid,query){return new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapData.query().layer(layerid).where(query).count(function(error,count,response){ResultsData.RequestCompleted++,resolve({error:error,count:count,response:response})})})},_mapService.AdvancedLayerQuery=function(theme,layerid,query){return new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapData.query().layer(layerid).where(query).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,null!=featureCollection&&validateFeatureCollectionGeometry(featureCollection.features),resolve({error:error,featureCollection:featureCollection,response:response})})})},_mapService.AdvancedQuery=function(layer,query){layer?_mapService.AdvancedQueryCount(layer.theme,layer.id,query).then(function(arg){arg.count>_mapService.MaxFeatures&&PopupService.Warning("U selecteerde "+arg.count+" resultaten.","Bij meer dan "+_mapService.MaxFeatures+" resultaten kan het laden wat langer duren en zijn de resultaten niet zichtbaar op de kaart en in de lijst. Exporteren naar CSV blijft mogelijk."),_mapService.AdvancedLayerQuery(layer.theme,layer.id,query).then(function(arg){null==arg.error?(MapData.AddFeatures(arg.featureCollection,layer.theme,layer.id,arg.featureCollection.length),null!=MapData.ExtendedType&&(MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[])):PopupService.ErrorWithException("Fout bij het uitvoeren van de query","Code: "+arg.error.error.code+"<br/>Message:"+arg.error.error.message+"<br/>Bent u zeker dat u een geldige query opstelde?<br/>")})}):PopupService.Warning("Geen geldige laag","Kon geen laag vinden om in te zoeken")},_mapService.AutoCompleteQuery=function(layer,field,query){if(layer){if(field){var promise=new Promise(function(resolve,reject){ResultsData.RequestStarted++,layer.theme.MapData.query().layer(layer.id).where(query).returnGeometry(!1).fields(field.name).limit(20).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,resolve({error:error,featureCollection:featureCollection,response:response})})});return console.log(promise),promise}PopupService.Warning("Geen veld van laag geselecteerd","Selecteer een veld om autocomplete te kunnen starten")}else PopupService.Warning("Geen geldige laag","Kon geen laag vinden om in te zoeken")},_mapService.startAutoComplete=function(layer,field,query){return this.AutoCompleteQuery(layer,field,query)},_mapService.Query=function(box,layer){if(layer||(layer=MapData.SelectedLayer),layer&&""!==layer.id)if(layer.isQueryLayer){var queryLayer=MapData.QueryLayers.find(function(queryLayer){return queryLayer.layer.baseUrl===layer.layer.layer.baseUrl&&queryLayer.layer.layerId===layer.layer.layer.layerId&&queryLayer.layer.name===layer.layer.layer.name});queryLayer&&_mapService.QueryQueryLayer([queryLayer],box)}else _mapService.LayerQueryCount(layer.theme,layer.id,box).then(function(arg){arg.count>_mapService.MaxFeatures&&PopupService.Warning("U selecteerde "+arg.count+" resultaten.","Bij meer dan "+_mapService.MaxFeatures+" resultaten kan het laden wat langer duren en zijn de resultaten niet zichtbaar op de kaart en in de lijst. Exporteren naar CSV blijft mogelijk."),_mapService.LayerQuery(layer.theme,layer.id,box).then(function(arg){MapData.AddFeatures(arg.featureCollection,layer.theme,layer.id,arg.featureCollection.length),null!=MapData.ExtendedType&&(MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[])})});else{var featureCount=0,allcountproms=[];MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){var layerCountProm=_mapService.LayerQueryCount(theme,lay.id,box);layerCountProm.then(function(arg){featureCount+=arg.count}),allcountproms.push(layerCountProm)})}),Promise.all(allcountproms).then(function(results){console.log(results,featureCount),featureCount>_mapService.MaxFeatures&&PopupService.Warning("U selecteerde "+featureCount+" resultaten.","Bij meer dan "+_mapService.MaxFeatures+" resultaten kan het laden wat langer duren en zijn de resultaten niet zichtbaar op de kaart en in de lijst. Exporteren naar CSV blijft mogelijk.");var allproms=[];MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){var prom=_mapService.LayerQuery(theme,lay.id,box);allproms.push(prom),prom.then(function(arg){MapData.AddFeatures(arg.featureCollection,theme,lay.id,featureCount)})})}),null!=MapData.ExtendedType&&Promise.all(allproms).then(function(results){MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[]})}),_mapService.QueryQueryLayer(MapData.QueryLayers.filter(function(x){return!0===x.showLayer}),box)}},_mapService.QueryQueryLayer=function(queryLayers,box){_.each(queryLayers,function(queryLayer){queryLayer.theme&&queryLayer.theme.Type==ThemeType.ESRI&&new Promise(function(resolve,reject){ResultsData.RequestStarted++,null!=box.mapItem&&(box=box.mapItem),queryLayer.theme.MapDataWithCors.query().layer(queryLayer.layer.layerId).where(queryLayer.layer.mapData.options.where).intersects(box).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,resolve({error:error,featureCollection:featureCollection,response:response})})}).then(function(arg){MapData.AddFeatures(arg.featureCollection,queryLayer.theme,queryLayer.layer.layerId,arg.featureCollection.length)})})},_mapService.WatIsHier=function(event){GISService.ReverseGeocode(event).success(function(data,status,headers,config){if(MapData.CleanWatIsHier(),0<data.length){var converted=GisHelperService.ConvertLambert72ToWSG84(data[0].xy);MapData.CreateDot(converted),MapData.CreateOrigineleMarker(event.latlng,!0,data[0].straatnm.split("_")[0]+" "+data[0].huisnr+" ("+data[0].postcode+" "+data[0].district+")")}else MapData.CreateOrigineleMarker(event.latlng,!1)}).error(function(data,status,headers,config){console.log(data,status,headers,config)})},_mapService.FindAdvanced=function(themeName,layerName,field,parameter){var prom=$q.defer(),theme=MapData.Themes.find(function(x){return x.Naam==themeName});if(!theme)throw"No loaded theme found with the name: "+themeName;var layer=theme.AllLayers.find(function(x){return x.name==layerName});if(!layer)throw"No layer found with the name: "+layerName+" on the theme with name: "+themeName;return ResultsData.RequestStarted++,theme.MapData.find().fields(field).layers(layer.id).text(parameter).run(function(error,featureCollection,response){error?prom.reject(error):(prom.resolve(featureCollection,response),ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme,layer.id))}),prom.promise},_mapService.Find=function(query){MapData.CleanSearch(),MapData.SelectedFindLayer&&""===MapData.SelectedFindLayer.id?MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){ResultsData.RequestStarted++,theme.MapData.find().fields(lay.displayField).layers(lay.id).text(query).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme,lay.id)})})}):(ResultsData.RequestStarted++,MapData.SelectedFindLayer.theme.MapData.find().fields(MapData.SelectedFindLayer.displayField).layers(MapData.SelectedFindLayer.id).text(query).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,MapData.SelectedFindLayer.theme,MapData.SelectedFindLayer.id)}))},_mapService})}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}module.factory("PopupService",function(){var _popupService={};return _popupService.Init=(toastr.options.timeOut=0,toastr.options.extendedTimeOut=0,void(toastr.options.closeButton=!0)),_popupService.popupGenerator=function(type,title,message,callback,options){var messagetype=type.toLowerCase().trim();if("error"!=messagetype&&"warning"!=messagetype&&"info"!=messagetype&&"success"!=messagetype)throw"Invalid toastr type(info, error, warning,  success): "+messagetype;options||(options={}),options.timeOut||(options.timeOut=3e3),options.extendedTimeOut||(options.extendedTimeOut=0),callback&&(options.onclick=callback),toastr[messagetype](message,title,options)},_popupService.ExceptionFunc=function(exception){console.log(exception)},_popupService.ErrorWithException=function(title,message,exception,options){_popupService.Error(title,message,function(){_popupService.ExceptionFunc(exception)},options)},_popupService.ErrorFromHttp=function(data,status,url){_popupService.ErrorFromHTTP(data,status,url)},_popupService.ErrorFromHTTP=function(data,status,url){status||(status=data.code);var title="HTTP error ("+status+")",baseurl=url.split("/").slice(0,3).join("/"),message="Fout met het navigeren naar url: "+baseurl,exception={url:url,status:status,data:data},callback=function(){_popupService.ExceptionFunc(exception)};if(-1==status&&url.includes("reversedgeocode-p.antwerpen.be")&&(title="ReversedGeocoding Error (status "+status+")",message="Er is geen adres binnen Antwerpen in de buurt van deze coördinaten."),"https://metadata.geopunt.be"==baseurl&&(title="Geopunt Error (status "+status+")",message="De geopunt service(s) die u probeert te bevragen zijn (tijdelijk) niet bereikbaar."),403==status){title="Onvoldoende rechten",url.includes("service"),message="U hebt geen rechten om het thema "+url+" te raadplegen",callback=function(){window.open("https://um.antwerpen.be/main.aspx","_blank").focus()};var options={timeOut:1e4};_popupService.popupGenerator("Warning",title,message,callback,options)}else _popupService.Error(title,message,callback)},_popupService.Error=function(title,message,callback,options){_popupService.popupGenerator("Error",title,message+"\nKlik hier om te melden.",callback,options)},_popupService.Warning=function(title,message,callback,options){_popupService.popupGenerator("Warning",title,message,callback,options)},_popupService.Info=function(title,message,callback,options){_popupService.popupGenerator("Info",title,message,callback,options)},_popupService.Success=function(title,message,callback,options){options||(options={}),options.closeButton||(options.closeButton=!1),_popupService.popupGenerator("Success",title,message,callback,options)},_popupService})}(),function(){var module=angular.module("tink.gis");module.$inject=["map","ThemeCreater","MapData","GISService","MapService","PopupService"],module.factory("ThemeService",function(map,ThemeCreater,MapData,GISService,$q,MapService,PopupService){var _service={AddAndUpdateThemes:function(themesBatch){console.log("Themes batch for add and updates..."),console.log(themesBatch),themesBatch.forEach(function(theme){var existingTheme=MapData.Themes.find(function(x){return x.cleanUrl==theme.cleanUrl});switch(console.log("addorupdate or del theme, ",theme,theme.status),theme.status){case ThemeStatus.NEW:theme.Type==ThemeType.ESRI&&(GISService.GetAditionalLayerInfo(theme),theme.UpdateDisplayed(MapData.GetScale())),_service.AddNewTheme(theme);break;case ThemeStatus.DELETED:_service.DeleteTheme(existingTheme);break;case ThemeStatus.UNMODIFIED:break;case ThemeStatus.UPDATED:_service.UpdateTheme(theme,existingTheme),_service.UpdateThemeVisibleLayers(existingTheme);break;default:console.log("Er is iets fout, status niet bekend!!!: "+theme.status)}theme.status=ThemeStatus.UNMODIFIED}),$("#sortableThemes").sortable("refresh"),MapData.SetZIndexes()},UpdateThemeVisibleLayers:function(theme){MapData.ResetVisibleLayers(),theme.UpdateMap(map)},updateQueryVisibility:function(index,showQuery){var queryLayer=MapData.QueryLayers[index];!0===queryLayer.showLayer?map.addLayer(queryLayer.layer.mapData):map.removeLayer(queryLayer.layer.mapData),MapData.ResetVisibleLayers()},UpdateTheme:function(updatedTheme,existingTheme){for(var x=0;x<updatedTheme.AllLayers.length;x++){var updatedLayer=updatedTheme.AllLayers[x],existingLayer=existingTheme.AllLayers[x];updatedLayer.enabled&&updatedLayer.visible?(existingTheme.Type==ThemeType.ESRI&&-1==MapData.VisibleLayers.indexOf(existingLayer)&&MapData.VisibleLayers.push(existingLayer),-1==existingTheme.VisibleLayers.indexOf(existingLayer)&&existingTheme.VisibleLayers.push(existingLayer)):(existingTheme.Type==ThemeType.ESRI&&-1!=MapData.VisibleLayers.indexOf(existingLayer)&&MapData.VisibleLayers.splice(MapData.VisibleLayers.indexOf(existingLayer),1),-1!=existingTheme.VisibleLayers.indexOf(existingLayer)&&existingTheme.VisibleLayers.splice(existingTheme.VisibleLayers.indexOf(existingLayer),1)),existingLayer.enabled=updatedLayer.enabled,existingLayer.visible=updatedLayer.visible}},AddNewTheme:function(theme){switch(MapData.Themes.unshift(theme),theme.Type==ThemeType.ESRI&&(MapData.VisibleLayers=MapData.VisibleLayers.concat(theme.VisibleLayers)),theme.Type){case ThemeType.ESRI:var visLayerIds=theme.VisibleLayerIds;0==visLayerIds.length&&visLayerIds.push(-1),null!==theme.Opacity&&void 0!==theme.Opacity||(theme.Opacity=1),theme.MapData=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:theme.cleanUrl,opacity:theme.Opacity,layers:visLayerIds,continuousWorld:!0,useCors:!1,f:"image"}).addTo(map),theme.MapDataWithCors=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:theme.cleanUrl,opacity:1,layers:visLayerIds,continuousWorld:!0,useCors:!0,f:"image"}),theme.MapData.on("authenticationrequired",function(e){serverAuth(function(error,response){e.authenticate(response.token)})}),theme.MapData.on("load",function(e){theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=theme.MapData.ZIndex,console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;case ThemeType.WMS:theme.MapData=L.tileLayer.betterWms(theme.cleanUrl,{maxZoom:20,minZoom:0,format:"image/png",layers:theme.VisibleLayerIds.join(","),transparent:!0,continuousWorld:!0,useCors:!0}).addTo(map),theme.MapData.on("load",function(e){console.log("LOAD VAN "+theme.Naam),console.log(theme.MapData),theme.MapData._container.childNodes&&([].slice.call(theme.MapData._container.childNodes).forEach(function(imgNode){imgNode.style.zIndex=theme.MapData.ZIndex}),console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;default:console.log("UNKNOW TYPE")}},AddQueryLayerFromImport:function(name,layerId,query,layerName,theme){theme.MapDataWithCors=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:theme.cleanUrl,opacity:theme.Opacity,layers:layerId,continuousWorld:!0,useCors:!0,f:"image"}),_service.AddQueryLayer(name,layerId,query,layerName,theme,!1)},CheckIfQueryLayerExists:function(themeUrl,layerId,name){return MapData.QueryLayers.find(function(queryLayer){return queryLayer.layer.baseUrl===themeUrl&&queryLayer.layer.layerId===layerId&&queryLayer.layer.name===name})},AddQueryLayer:function(name,layerId,query,layerName,theme){var count=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],existingQueryLayer=_service.CheckIfQueryLayerExists(theme.cleanUrl,layerId,name);if(existingQueryLayer)swal({title:"Updaten querylaag",text:"U staat op het punt bestaande querylaag "+existingQueryLayer.layer.name+" bij te werken.",type:"warning",showCancelButton:!0,cancelButtonText:"Annuleer",confirmButtonColor:"#149142",confirmButtonText:"Update",closeOnConfirm:!0,reverseButtons:!1},function(isConfirm){existingQueryLayer.layer.mapData&&(count&&_service.QueryLayerCount(theme,layerId,query),existingQueryLayer.layer.mapData.setWhere(query),existingQueryLayer.layer.query=query)});else if(5===MapData.QueryLayers.length)PopupService.Error("Het maximum aantal toegelaten query lagen is gelimiteerd tot 5. Dit omwille de impact van een query laag op de performantie van SIK.");else{count&&_service.QueryLayerCount(theme,layerId,query);var queryLayer={layer:{baseUrl:theme.cleanUrl,name:name,layerName:layerName,layerId:layerId,query:query,legend:[]},showLayer:!0},promLegend=GISService.GetLegendData(queryLayer.layer.baseUrl),promLayerInfo=GISService.GetLayerSpecification(queryLayer.layer.baseUrl+"/"+queryLayer.layer.layerId);$q.all([promLegend,promLayerInfo]).then(function(data){var _this=this,layerInfo=data[0].layers.find(function(x){return x.layerId==layerId});if(layerInfo&&layerInfo.legend&&0<layerInfo.legend.length&&(queryLayer.layer.legend=layerInfo.legend.map(function(x){var layer=x;return layer.fullurl="data:"+x.contentType+";base64, "+x.imageData,layer})),"esriGeometryPoint"!==data[1].geometryType)if(data[1].drawingInfo.renderer.uniqueValueInfos)queryLayer.layer.colors=data[1].drawingInfo.renderer.uniqueValueInfos.map(function(uniqueValue){var fillColor="",color="",fill=!1,weight=1;switch(data[1].geometryType){case"esriGeometryPolyline":color=_service.RGBToHex(uniqueValue.symbol.color[0],uniqueValue.symbol.color[1],uniqueValue.symbol.color[2]),weight=uniqueValue.symbol.width;break;case"esriGeometryPolygon":uniqueValue.symbol.color&&(fillColor=_this.RGBToHex(uniqueValue.symbol.color[0],uniqueValue.symbol.color[1],uniqueValue.symbol.color[2]),fill=0<uniqueValue.symbol.color[3]),color=_this.RGBToHex(uniqueValue.symbol.outline.color[0],uniqueValue.symbol.outline.color[1],uniqueValue.symbol.outline.color[2]),weight=uniqueValue.symbol.outline.width}return{values:uniqueValue.value.split(","),weight:weight,color:color,fillColor:fillColor,fill:fill}});else if(data[1].drawingInfo.renderer.symbol){var fillColor="",color="",fill=!1,weight=1,drawingSymbol=data[1].drawingInfo.renderer.symbol;switch(data[1].geometryType){case"esriGeometryPolyline":color=_service.RGBToHex(drawingSymbol.color[0],drawingSymbol.color[1],drawingSymbol.color[2]),weight=drawingSymbol.width;break;case"esriGeometryPolygon":fillColor=_service.RGBToHex(drawingSymbol.color[0],drawingSymbol.color[1],drawingSymbol.color[2]),color=_service.RGBToHex(drawingSymbol.outline.color[0],drawingSymbol.outline.color[1],drawingSymbol.outline.color[2]),fill=0<drawingSymbol.color[0]||0<drawingSymbol.color[1]||0<drawingSymbol.color[2],weight=drawingSymbol.outline.width}queryLayer.layer.colors=[{values:"",weight:weight,color:color,fillColor:fillColor,fill:fill,fillOpacity:1}]}queryLayer.layer.mapData=L.esri.featureLayer({maxZoom:20,minZoom:0,url:queryLayer.layer.baseUrl+"/"+queryLayer.layer.layerId+"/query",where:query,continuousWorld:!0,useCors:!1,f:"image",style:function(feature,layer){if(queryLayer.layer.colors){var colorValue=feature.properties[data[1].drawingInfo.renderer.field1];return colorValue?queryLayer.layer.colors.find(function(x){return x.values.includes(colorValue)}):queryLayer.layer.colors.find(function(x){return x.values.includes("")})?queryLayer.layer.colors.find(function(x){return x.values.includes("")}):queryLayer.layer.colors[0]}},pointToLayer:function(feature,latlng){var legendValue=feature.properties[data[1].drawingInfo.renderer.field1],legendItem=queryLayer.layer.legend.find(function(x){return x.values&&x.values.map(function(x){return x.toLowerCase()}).includes(legendValue.toLowerCase())}),iconUrl=legendItem?legendItem.fullurl:queryLayer.layer.legend[0].fullurl;return MapData.CreateFeatureLayerMarker(latlng,iconUrl)}}).addTo(map),queryLayer.theme=theme,MapData.QueryLayers.push(queryLayer),MapData.VisibleLayers=MapData.VisibleLayers.concat({name:queryLayer.layer.name+" (query)",isQueryLayer:!0,layer:queryLayer})})}},DeleteAllQueryLayers:function(){_.each(MapData.QueryLayers,function(queryLayer){_service.DeleteQueryLayer(0)})},DeleteQueryLayer:function(index){if(-1<index){var queryLayer=MapData.QueryLayers[index];if(queryLayer){map.removeLayer(queryLayer.layer.mapData),MapData.QueryLayers.splice(index,1);var visLayer=MapData.VisibleLayers.find(function(x){return!0===x.isQueryLayer&x.layer===queryLayer});visLayer&&MapData.VisibleLayers.splice(MapData.VisibleLayers.indexOf(visLayer),1)}}},CleanThemes:function(){for(;0!=MapData.Themes.length;)console.log("DELETING THIS THEME",MapData.Themes[0]),_service.DeleteTheme(MapData.Themes[0])},DeleteTheme:function(theme){map.removeLayer(theme.MapData);var themeIndex=MapData.Themes.indexOf(theme);-1<themeIndex&&MapData.Themes.splice(themeIndex,1),theme.VisibleLayers.forEach(function(visLayer){var visLayerIndex=MapData.VisibleLayers.indexOf(visLayer);-1<visLayerIndex&&MapData.VisibleLayers.splice(visLayerIndex,1)}),MapData.CleanSearch()},QueryLayerCount:function(theme,layerId,query){MapService.AdvancedQueryCount(theme,layerId,query).then(function(arg){1e3<arg.count&&PopupService.Warning("U selecteerde "+arg.count+" resultaten.","Bij meer dan 1000 resultaten kan het laden wat langer duren en heeft dit een negatieve impact op de performantie van SIK.")})},RGBToHex:function(red,green,blue){return"#"+_service.ComponentToHex(red)+_service.ComponentToHex(green)+_service.ComponentToHex(blue)},ComponentToHex:function(c){var hex=c.toString(16);return 1==hex.length?"0"+hex:hex}};return _service})}(),angular.module("tink.gis").factory("TypeAheadService",function(map,GISService,MapData,GisHelperService){var _typeAheadService={districts:[],lastData:[],lastStreetNameId:null,lastStreetName:"",numbers:null};_typeAheadService.districts.push({postcode:2e3,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2018,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2020,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2030,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2040,district:"Berendrecht"}),_typeAheadService.districts.push({postcode:2050,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2060,district:"Antwerpen"}),_typeAheadService.districts.push({postcode:2100,district:"Deurne"}),_typeAheadService.districts.push({postcode:2140,district:"Borgerhout"}),_typeAheadService.districts.push({postcode:2170,district:"Merksem"}),_typeAheadService.districts.push({postcode:2180,district:"Ekeren"}),_typeAheadService.districts.push({postcode:2600,district:"Berchem"}),_typeAheadService.districts.push({postcode:2610,district:"Wilrijk"}),_typeAheadService.districts.push({postcode:2660,district:"Hoboken"}),_typeAheadService.init=function(){L.control.typeahead({minLength:3,highlight:!0,classNames:{open:"is-open",empty:"is-empty"}},{async:!0,limit:99,display:"name",displayKey:"name",source:function(query,syncResults,asyncResults){if(query.replace(/[^0-9]/g,"").length<6){var hasComma=query.indexOf(",");-1<hasComma&&(query=query.replace(query.substr(hasComma,query.length),""));var splitquery=query.split(" "),numbers=splitquery.filter(function(x){return isCharDigit(x[0])}),notnumbers=splitquery.filter(function(x){return!isCharDigit(x[0])});if(_typeAheadService.numbers=numbers.length,3==query.length&&(_typeAheadService.lastStreetNameId=null),1==numbers.length&&1<=notnumbers.length&&(1!==notnumbers.length||"KAAINUMMER"!==notnumbers[0].toUpperCase())){var huisnummer=numbers[0],strnmid=[];_typeAheadService.lastData.forEach(function(street){var notnumberscombined="";notnumbers.forEach(function(n){notnumberscombined+=" "+n}),notnumberscombined=notnumberscombined.trim(),_typeAheadService.lastStreetName.trim(),street.streetNameId&&strnmid.push(street.streetNameId),null!=_typeAheadService.lastStreetNameId&&(strnmid=[]).push(_typeAheadService.lastStreetNameId),street.name.toLowerCase().trim().contains(notnumberscombined.toLowerCase())||(strnmid=[])});var straatnaam=encodeURIComponent(notnumbers.join(" "));0!=strnmid.length?GISService.QueryCrab(strnmid,huisnummer).then(function(data){console.log(data);var features=data.features.map(function(feature){var obj={};return obj.straatnaam=feature.attributes.STRAATNM,obj.huisnummer=feature.attributes.HUISNR,obj.id=feature.attributes.OBJECTID,obj.x=feature.geometry.x,obj.y=feature.geometry.y,obj.name=(obj.straatnaam.split("_")[0]+" "+obj.huisnummer).trim(),obj.postcode=feature.attributes.POSTCODE,_typeAheadService.districts.forEach(function(district){district.postcode==obj.postcode&&(obj.district=district.district)}),obj.straatnaam.split("_")[1]?obj.name=obj.straatnaam.split("_")[0]+" "+obj.huisnummer+", "+obj.postcode+" "+obj.district:obj.name=obj.straatnaam+" "+obj.huisnummer+", "+obj.postcode+" "+obj.district,obj}).slice(0,10);asyncResults(features)}):GISService.QueryLocationPickerAddress(straatnaam,huisnummer).then(function(data){var features=data.map(function(feature){var obj={};return obj.straatnaam=feature.street.streetName,obj.huisnummer=feature.houseNumber.houseNumber,obj.id=feature.id,obj.x=feature.addressPosition.lambert72.x,obj.y=feature.addressPosition.lambert72.y,obj.name=feature.formattedAddress,obj.postcode=feature.municipalityPost.postCode,obj.district=feature.municipalityPost.antwerpDistrict,obj}).slice(0,10);asyncResults(features)})}else GISService.QueryLocationPickerLocation(query.trim()).then(function(data){var arr=data.map(function(feature){var obj={};return obj.key=feature.id,obj.id=feature.fullId,obj.name=feature.name,obj.layer=feature.layer,obj.layerString=feature.layer,null!==feature.antwerpDistrict&&null===feature.antwerpDistrict.match(/^ *$/)&&(obj.districts=[feature.antwerpDistrict]),feature.position&&(feature.position.geometry&&(obj.geometry=feature.position.geometry),feature.position.lambert72&&(obj.x=feature.position.lambert72.x,obj.y=feature.position.lambert72.y)),obj});_typeAheadService.lastData=arr,asyncResults(arr)})}else syncResults([]),zoekXY(query)},templates:{suggestion:suggestionfunc,notFound:['<div class="empty-message"><b>Geen resultaten gevonden</b></div>'],empty:['<div class="empty-message"><b>Zoek naar straten, POI en districten</b></div>']}},{placeholder:"Geef een X,Y / locatie of POI in.","typeahead:select":function(ev,suggestion){if(MapData.CleanWatIsHier(),MapData.CleanTempFeatures(),suggestion.streetNameId&&(_typeAheadService.lastStreetNameId=suggestion.streetNameId,_typeAheadService.lastStreetName=suggestion.name),suggestion.x&&suggestion.y){var cors={x:suggestion.x,y:suggestion.y},xyWGS84=GisHelperService.ConvertLambert72ToWSG84(cors);setViewAndPutDot(xyWGS84)}else if(suggestion.id){var layerid=suggestion.id.split("/")[3];QueryForTempFeatures(layerid,"ObjectID="+suggestion.key)}}}).addTo(map),$(".typeahead").on("keyup",function(e){13==e.which&&1==$(".tt-suggestion").length&&($(".tt-suggestion:first-child").trigger("click"),0<_typeAheadService.numbers&&(_typeAheadService.lastStreetNameId=null))})};var zoekXY=function(search){search=search.trim();var WGS84Check=GisHelperService.getWGS84CordsFromString(search);if(WGS84Check.hasCordinates)setViewAndPutDot(WGS84Check);else{var lambertCheck=GisHelperService.getLambartCordsFromString(search);if(lambertCheck.hasCordinates){var xyWGS84=GisHelperService.ConvertLambert72ToWSG84({x:lambertCheck.x,y:lambertCheck.y});setViewAndPutDot(xyWGS84)}else console.log("NIET GEVONDEN")}},QueryForTempFeatures=function(layerid,where){locatieMapData.query().layer(layerid).where(where).run(function(error,featureCollection,response){error?console.log("ERRRORRRRRRRRRRR",error):(console.log(error,featureCollection,response),MapData.AddTempFeatures(featureCollection))})},locatieMapData=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:Gis.LocatieUrl,opacity:1,layers:0,continuousWorld:!0,useCors:!1}),isCharDigit=function(n){return" "!=n&&-1<n},suggestionfunc=function(item){if(item.districts)var output="<div>"+item.name+" ("+item.districts[0]+")";else output="<div>"+item.name;return item.attribute1value&&(output+="<p>"+item.attribute1name+": "+item.attribute1value+"</p>"),item.attribute2value&&(output+="<p>"+item.attribute2name+": "+item.attribute2value+"</p>"),item.layer&&(output+="<p>Laag: "+item.layer+"</p>"),output+="</div>"},setViewAndPutDot=function(loc){MapData.PanToPoint(loc),MapData.CreateDot(loc)};return _typeAheadService}),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.factory("UIService",function(){var _service={OpenLeftSide:function(){var html=$("html");html.hasClass("nav-left-open")||html.addClass("nav-left-open")},CloseLeftSide:function(){var html=$("html");html.hasClass("nav-left-open")&&html.removeClass("nav-left-open")},OpenRightSide:function(){var html=$("html");html.hasClass("nav-right-open")||html.addClass("nav-right-open")},CloseRightSide:function(){var html=$("html");html.hasClass("nav-right-open")&&html.removeClass("nav-right-open")}};return _service})}(),function(){var module=angular.module("tink.gis");module.$inject=["$http","GisHelperService","$q","PopupService"],module.factory("WMSService",function($http,GisHelperService,$q,PopupService){var _service={GetThemeData:function(url){var fullurl=url+"?request=GetCapabilities&service=WMS",proxiedurl=GisHelperService.CreateProxyUrl(fullurl);return $http({method:"GET",url:proxiedurl,timeout:1e4,transformResponse:function(data){return data&&((data=GisHelperService.UnwrapProxiedData(data)).listOfHttpError||(data=JXON.stringToJs(data).wms_capabilities)),data}}).success(function(data,status,headers,config){}).error(function(data,status,headers,config){PopupService.ErrorFromHttp(data,status,fullurl)})}};return _service})}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("BufferController",["$scope","$modalInstance","MapData",function($scope,$modalInstance,MapData){$scope.buffer=MapData.LastBufferedDistance,$scope.SelectableLayers=_.cloneDeep(MapData.VisibleLayers),$scope.SelectableLayers.shift();var bufferDefault=MapData.LastBufferedLayer||MapData.DefaultLayer;if(bufferDefault){var selectedLayer=$scope.SelectableLayers.find(function(x){return x.name==bufferDefault.name});$scope.selectedLayer=selectedLayer||$scope.SelectableLayers[0]}else $scope.selectedLayer=$scope.SelectableLayers[0];$scope.ok=function(){MapData.LastBufferedDistance=$scope.buffer,MapData.LastBufferedLayer=$scope.selectedLayer,$modalInstance.$close({buffer:$scope.buffer,layer:$scope.selectedLayer})},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("searchAdvancedController",["$scope","$modalInstance","SearchAdvancedService","MapData","GISService","UIService","ResultsData","ThemeService",function($scope,$modalInstance,SearchAdvancedService,MapData,GISService,UIService,ResultsData,ThemeService){$scope.editor=!1,$scope.selectedLayer=null,$scope.operations=[],$scope.queryLayerName="",null==$scope.query&&($scope.query=null),$scope.openQueryEditor=function(){$scope.editor=!0,$scope.selectedLayer&&SearchAdvancedService.BuildQuery($scope.selectedLayer.name)},$scope.SelectedLayers=function(){var layers=MapData.VisibleLayers.filter(function(data){return"Alle lagen"!==data.name&&data.fields});return 1===layers.length&&($scope.selectedLayer?($scope.selectedLayer=layers[0],SearchAdvancedService.UpdateFields($scope.selectedLayer)):($scope.selectedLayer=layers[0],$scope.updateFields())),layers},$scope.updateFields=function(){if(null!=$scope.selectedLayer&&null!=$scope.selectedLayer){var numberOfQueryLayers=MapData.QueryLayers.filter(function(x){return x.layer.layerId===$scope.selectedLayer.id&&x.layer.layerName===$scope.selectedLayer.name}).length;$scope.queryLayerName=0<numberOfQueryLayers?$scope.selectedLayer.name+" ("+numberOfQueryLayers+")":$scope.selectedLayer.name,SearchAdvancedService.UpdateFields($scope.selectedLayer)}},$scope.checkAddOrUpdate,$scope.$on("queryBuild",function(event,data){$scope.query=data}),$scope.$on("queryOperationUpdated",function(event,data){$scope.query=data,$scope.editor=!1}),$scope.$on("deleteOperation",function(){$scope.editor=!1}),$scope.addOperation=function(){$scope.editor=!1,SearchAdvancedService.newAddOperation()},$scope.orOperation=function(){$scope.editor=!1,SearchAdvancedService.newOrOperation()},$scope.ok=function(){$modalInstance.$close()},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")},$scope.QueryAPI=function(){if($scope.editor){var rawQueryResult=SearchAdvancedService.MakeNewRawQuery($scope.query);if(SearchAdvancedService.UpdateQuery($scope.query),null!=rawQueryResult.layer)SearchAdvancedService.ExecuteQuery(rawQueryResult.layer,rawQueryResult.query)}else{SearchAdvancedService.BuildQuery($scope.selectedLayer.name);var query=SearchAdvancedService.TranslateOperations($scope.operations);if(""!==query)SearchAdvancedService.ExecuteQuery($scope.selectedLayer,query)}UIService.OpenLeftSide(),$modalInstance.$close()},$scope.FilterQueriedLayer=function(){var closeModal=!0;if($scope.editor){var rawQueryResult=SearchAdvancedService.MakeNewRawQuery($scope.query);SearchAdvancedService.UpdateQuery($scope.query),$scope.selectedLayer?ThemeService.AddQueryLayer($scope.queryLayerName,$scope.selectedLayer.id,rawQueryResult.query,$scope.selectedLayer.name,$scope.selectedLayer.theme):rawQueryResult.layer?ThemeService.AddQueryLayer($scope.queryLayerName,rawQueryResult.layer.id,rawQueryResult.query,rawQueryResult.layer.name,rawQueryResult.layer.theme):closeModal=!1}else{SearchAdvancedService.BuildQuery($scope.selectedLayer.name);var query=SearchAdvancedService.TranslateOperations($scope.operations);$scope.selectedLayer&&""!==query&&ThemeService.AddQueryLayer($scope.queryLayerName,$scope.selectedLayer.id,query,$scope.selectedLayer.name,$scope.selectedLayer.theme)}closeModal&&$modalInstance.$close()},null!=$scope.query&&""!=$scope.query&&$scope.openQueryEditor()}]).$inject=["$scope","$modalInstance","SearchAdvancedService","MapData","UIService","GISService","ResultsData","ThemeService"]}(),angular.module("tink.gis").controller("searchController",function($scope,ResultsData,map,$interval){var vm=this;vm.features=ResultsData.JsonFeatures,vm.EmptyResult=ResultsData.EmptyResult,vm.LoadingCompleted=!0,vm.loadingPercentage=100,$interval(function(){vm.loadingPercentage=ResultsData.GetRequestPercentage(),vm.LoadingCompleted=100<=vm.loadingPercentage},333),vm.asidetoggle=function(){if(L.Browser.mobile){var html=$("html");html.hasClass("nav-right-open")&&html.removeClass("nav-right-open")}}}).$inject=["$scope","ResultsData","map","$interval"],function(module){try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("searchOperationsController",["$scope","SearchAdvancedService","MapService",function($scope,SearchAdvancedService,MapService){$scope.attributes=null,$scope.operators=["=","<>","<",">","<=",">=","LIKE","NOT LIKE"],$scope.operator="=",$scope.selectedAttribute=null,$scope.value=null,$scope.layer=null,$scope.autoCompleteActive=!1,$scope.autoComplete=[{collection:[],element:null}],$scope.index=null,$scope.operations=[{addition:null,attribute:null,operator:"=",value:null}],$scope.updateOperation=function(index){$scope.index=index,$scope.autoCompleteActive=!1,$scope.changeoperation();var op=$scope.operations[index];document.activeElement!=document.getElementById("input_waarde_"+index)&&null!=op.attribute&&ExecuteEmptyAutoCompleteQuery().then(function(arg){if(arg&&null==arg.error&&null!=arg.featureCollection.features){var result=GetAutoCompleteValue(arg.featureCollection.features);$scope.autoComplete[$scope.index].collection=result.filter(onlyUnique)}else $scope.autoComplete[$scope.index].collection=[];refreshTypeahead()})},$scope.$on("updateFields",function(event,data){$scope.attributes=data.fields;for(var index=0;index<$scope.attributes.length;index++){var element=$scope.attributes[index];element.name.toLowerCase()!=element.alias.toLowerCase()?element.displayName=element.name+" ("+element.alias+")":element.displayName=element.name}}),$scope.$on("addOperation",function(){$scope.operations.push({addition:"AND",attribute:"",operator:"=",value:""}),$scope.autoComplete.push({collection:[],element:null}),$scope.changeoperation()}),$scope.$on("orOperation",function(){$scope.operations.push({addition:"OR",attribute:"",operator:"=",value:""}),$scope.autoComplete.push({collection:[],element:null}),$scope.changeoperation()}),$scope.delete=function(index){0!==index&&($scope.operations.splice(index,1),$scope.autoComplete.splice(index,1)),$scope.changeoperation()},$scope.up=function(index){var op=$scope.operations[index],ac=$scope.autoComplete[index];1==index&&(op.addition=null,$scope.operations[0].addition="AND"),$scope.operations.splice(index,1),$scope.operations.splice(index-1,0,op),$scope.autoComplete.splice(index,1),$scope.autoComplete.splice(index-1,0,ac),$scope.changeoperation()},$scope.down=function(index){var op=$scope.operations[index],ac=$scope.autoComplete[index];0==index&&(op.addition="AND",$scope.operations[1].addition=null),$scope.operations.splice(index,1),$scope.operations.splice(index+1,0,op),$scope.autoComplete.splice(index,1),$scope.autoComplete.splice(index+1,0,ac),$scope.changeoperation()},$scope.changeoperation=function(){$scope.$emit("addedOperation",$scope.operations),setTimeout(function(){var op=$scope.operations[$scope.index];null==op.attribute||null!=op.value&&""!=op.value||initializeTypeahead()},100)},$scope.valueChanged=function(index){$scope.index=index};var ExecuteEmptyAutoCompleteQuery=function(){var queryParams=SearchAdvancedService.BuildAutoCompleteQuery("",$scope.index);return MapService.startAutoComplete(queryParams.layer,queryParams.attribute,queryParams.query)},FillAutoComplete=function(query,syncResults,asyncResults){var docId=document.activeElement.id.replace("input_waarde_","");parseInt(docId)!==$scope.index&&($scope.index=parseInt(docId),query=document.activeElement.value,document.getElementById("input_waarde_"+docId).value=document.activeElement.value);if(null!=$scope.index){var queryParams=SearchAdvancedService.BuildAutoCompleteQuery(query,$scope.index);MapService.startAutoComplete(queryParams.layer,queryParams.attribute,queryParams.query).then(function(arg){if(arg&&null==arg.error&&null!=arg.featureCollection.features){var result=GetAutoCompleteValue(arg.featureCollection.features);$scope.autoComplete[$scope.index].collection=result.filter(onlyUnique)}else $scope.autoComplete[$scope.index].collection=[];asyncResults($scope.autoComplete[$scope.index].collection)})}else syncResults($scope.autoComplete[$scope.index].collection)};function onlyUnique(value,index,self){return self.indexOf(value)===index}var GetAutoCompleteValue=function(collection){var returnCollection=[],op=$scope.operations[$scope.index];return collection.forEach(function(element){"esriFieldTypeDate"==op.attribute.type?returnCollection.push(FormatTimestamp(element.properties[op.attribute.name])):returnCollection.push(element.properties[op.attribute.name])}),returnCollection},FormatTimestamp=function(timestamp){var date=new Date(timestamp),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();return month<10?year+"-0"+month+"-"+day:year+"-"+month+"-"+day},suggestionfunc=function(item){return"<div>"+item+"</div>"},initializeTypeahead=function(){null==$scope.index&&($scope.index=0),null==$scope.autoComplete[$scope.index].element&&createTypeahead()},refreshTypeahead=function(){$("#input_waarde_"+$scope.index).typeahead("destroy"),createTypeahead()},createTypeahead=function(){var acElement=$("#input_waarde_"+$scope.index);acElement.typeahead({minLength:0},{async:!0,name:"autoComplete",limit:10,source:FillAutoComplete,templates:{suggestion:suggestionfunc,notFound:['<div class="empty-message"><b>Geen resultaten gevonden</b></div>']}}),acElement.on("focus",function(ev){console.log(acElement[0].value),acElement.typeahead("val",acElement[0].value)}),acElement.bind("typeahead:select",function(ev,suggestion){$scope.operations[$scope.index].value=suggestion}),$scope.autoComplete[$scope.index].element=acElement};setTimeout(function(){initializeTypeahead()},100)}]).$inject=["$scope","SearchAdvancedService","MapService"]}(),angular.module("tink.gis").controller("searchResultsController",function($scope,ResultsData,map,SearchService,MapData,FeatureService,$modal,GeometryService){var vm=this;vm.features=ResultsData.JsonFeatures,vm.featureLayers=null,vm.selectedResult=null,vm.layerGroupFilter="geenfilter",vm.collapsestatepergroup={},vm.drawLayer=null,$scope.$watchCollection(function(){return ResultsData.JsonFeatures},function(newValue,oldValue){vm.featureLayers=_.uniq(_.map(vm.features,"layerName")),vm.featureLayers.forEach(function(lay){void 0!==vm.collapsestatepergroup[lay]&&null!==vm.collapsestatepergroup[lay]||(vm.collapsestatepergroup[lay]=!1)}),vm.layerGroupFilter="geenfilter"}),$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){vm.selectedResult=newVal}),$scope.$watch(function(){return MapData.DrawLayer},function(newdrawobject,oldVal){vm.drawLayer=newdrawobject||null}),vm.mobile=L.Browser.mobile,vm.zoom2Drawing=function(){MapData.PanToItem(vm.drawLayer)},vm.deleteDrawing=function(){MapData.CleanDrawings()},vm.bufferFromDrawing=function(){MapData.ExtendedType=null,MapData.CleanBuffer(),$modal.open({templateUrl:"templates/search/bufferTemplate.html",controller:"BufferController",resolve:{backdrop:!1,keyboard:!0}}).result.then(function(returnobj){vm.drawLayer.toGeoJSON().features?vm.drawLayer.toGeoJSON().features.forEach(function(feature){GeometryService.Buffer(feature,returnobj.buffer,returnobj.layer)}):GeometryService.Buffer(vm.drawLayer.toGeoJSON(),returnobj.buffer,returnobj.layer)},function(obj){console.log("Modal dismissed at: "+new Date)})},vm.extendedType=null,$scope.$watch(function(){return MapData.ExtendedType},function(newValue,oldValue){vm.extendedType=newValue}),vm.addSelection=function(){"add"!=vm.extendedType?(MapData.ActiveInteractieKnop=ActiveInteractieButton.SELECT,MapData.DrawingType=DrawingOption.NIETS,MapData.ShowDrawControls=!0,MapData.ShowMetenControls=!1,vm.extendedType="add",MapData.ExtendedType="add"):(vm.extendedType=null,MapData.ExtendedType=null)},vm.removeSelection=function(){"remove"!=vm.extendedType?(MapData.ActiveInteractieKnop=ActiveInteractieButton.SELECT,MapData.DrawingType=DrawingOption.NIETS,MapData.ShowDrawControls=!0,MapData.ShowMetenControls=!1,vm.extendedType="remove",MapData.ExtendedType="remove"):(vm.extendedType=null,MapData.ExtendedType=null)},vm.deleteFeature=function(feature){SearchService.DeleteFeature(feature)},vm.aantalFeaturesMetType=function(type){return vm.features.filter(function(x){return x.layerName==type}).length},vm.isOpenGroup=function(type){return vm.features.filter(function(x){return x.layerName==type})},vm.deleteFeatureGroup=function(featureGroupName){vm.collapsestatepergroup[featureGroupName]=void 0,SearchService.DeleteFeatureGroup(featureGroupName)},vm.showDetails=function(feature){if(!MapData.VisibleFeatures.some(function(x){return x.toGeoJSON().features[0].id==feature.id&&x.toGeoJSON().features[0].layerName==feature.layerName})){var mapItem=L.geoJson(feature,{style:Style.DEFAULT}).addTo(map);MapData.TempExtendFeatures.push(mapItem),feature.mapItem=mapItem}ResultsData.SelectedFeature=feature},vm.exportToCSV=function(){SearchService.ExportToCSV()},vm.exportToCSVButtonIsEnabled=FeatureService.exportToCSVButtonIsEnabled,$scope.$watch(function(){return FeatureService.exportToCSVButtonIsEnabled},function(newValue,oldValue){vm.exportToCSVButtonIsEnabled=newValue}),$scope.$watch(function(){return FeatureService.extraResultButtonIsEnabled},function(newValue,oldValue){vm.extraResultButtonIsEnabled=FeatureService.extraResultButtonIsEnabled,vm.extraResultButton=FeatureService.extraResultButtonCallBack,vm.resultButtonText=FeatureService.resultButtonText}),$scope.$watch(function(){return FeatureService.secondResultButtonIsEnabled},function(newValue,oldValue){vm.secondResultButtonIsEnabled=FeatureService.secondResultButtonIsEnabled,vm.secondResultButton=FeatureService.secondResultButtonCallBack,vm.secondResultButtonText=FeatureService.secondResultButtonText}),$scope.$watch(function(){return FeatureService.extraResultButtonConditionCallBack()},function(newValue,oldValue){vm.extraResultButtonIsEnabled=newValue}),$scope.$watch(function(){return FeatureService.secondResultButtonConditionCallBack()},function(newValue,oldValue){vm.secondResultButtonIsEnabled=newValue}),vm.extraResultButtonIsEnabled=FeatureService.extraResultButtonIsEnabled,vm.extraResultButton=FeatureService.extraResultButtonCallBack,vm.resultButtonText=FeatureService.resultButtonText,vm.secondResultButtonIsEnabled=FeatureService.secondResultButtonIsEnabled,vm.secondResultButton=FeatureService.secondResultButtonCallBack,vm.secondResultButtonText=FeatureService.secondResultButtonText}).$inject=["$scope","ResultsData","map","SearchService","MapData","FeatureService","$modal","GeometryService"],angular.module("tink.gis").controller("searchSelectedController",function($scope,ResultsData,MapData,SearchService,GeometryService,$modal,FeatureService,map){var vm=this;vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,vm.props=[],vm.mobile=L.Browser.mobile,$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){if(oldVal&&oldVal!=newVal&&oldVal.mapItem)if(oldVal.mapItem.isBufferedItem)MapData.SetStyle(oldVal.mapItem,Style.COREBUFFER,L.AwesomeMarkers.icon({icon:"fa-circle-o",markerColor:"lightgreen"}));else{var myicon=L.icon({iconUrl:"bower_components/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"bower_components/leaflet/dist/images/marker-icon-2x.png",shadowUrl:"bower_components/leaflet/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});"wms"!==oldVal.theme.Type&&MapData.SetStyle(oldVal.mapItem,Style.DEFAULT,myicon)}if(newVal){newVal.mapItem&&"wms"!==newVal.theme.Type&&(myicon=L.AwesomeMarkers.icon({icon:"fa-dot-circle-o",markerColor:"red"}),MapData.SetStyle(newVal.mapItem,Style.HIGHLIGHT,myicon)),vm.selectedResult=newVal;var item=Object.getOwnPropertyNames(newVal.properties).map(function(k){return{key:k,value:newVal.properties[k]}});if("wms"!==newVal.theme.Type)var geo=Object.getOwnPropertyNames(newVal.geometry).map(function(k){return{key:k,value:newVal.geometry[k]}});vm.props=item,"wms"!==newVal.theme.Type&&(vm.props.push(geo[0]),vm.props.push(geo[1])),vm.prevResult=SearchService.GetPrevResult(),vm.nextResult=SearchService.GetNextResult()}else vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null}),vm.toonFeatureOpKaart=function(){"esri"===vm.selectedResult.theme.Type?MapData.PanToFeature(vm.selectedResult.mapItem):MapData.GoToLastClickBounds()},vm.volgende=function(){console.log(ResultsData.SelectedFeature),ResultsData.SelectedFeature=vm.nextResult},vm.vorige=function(){ResultsData.SelectedFeature=vm.prevResult},vm.buffer=1,vm.doordruk=function(){MapData.ExtendedType=null,console.log(ResultsData.SelectedFeature),ResultsData.SelectedFeature.mapItem.toGeoJSON().features.forEach(function(feature){GeometryService.Doordruk(feature)})},vm.buffer=function(){MapData.ExtendedType=null,MapData.CleanDrawings(),MapData.CleanBuffer(),MapData.SetDrawLayer(ResultsData.SelectedFeature.mapItem),$modal.open({templateUrl:"templates/search/bufferTemplate.html",controller:"BufferController",resolve:{backdrop:!1,keyboard:!0}}).result.then(function(returnobj){ResultsData.SelectedFeature.mapItem.toGeoJSON().features.forEach(function(feature){GeometryService.Buffer(feature,returnobj.buffer,returnobj.layer)})},function(obj){console.log("Modal dismissed at: "+new Date)})},vm.exportToCSV=function(){SearchService.ExportOneToCSV(vm.selectedResult)},vm.delete=function(){var prev=SearchService.GetPrevResult(),next=SearchService.GetNextResult();SearchService.DeleteFeature(vm.selectedResult),ResultsData.SelectedFeature=next||prev||null},vm.close=function(feature){vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,ResultsData.SelectedFeature=null},vm.exportToCSVButtonIsEnabled=FeatureService.exportToCSVButtonIsEnabled,$scope.$watch(function(){return FeatureService.exportToCSVButtonIsEnabled},function(newValue,oldValue){vm.exportToCSVButtonIsEnabled=newValue})}).$inject=["$scope","ResultsData","GeometryService","$modal","FeatureService","map"],angular.module("tink.gis").directive("tinkSearchAdvanced",function(){return{replace:!0,templateUrl:"templates/search/searchAdvancedTemplate.html",controller:"searchAdvancedController",controllerAs:"srchadvctrl"}}),angular.module("tink.gis").directive("tinkSearch",function(){return{replace:!0,templateUrl:"templates/search/searchTemplate.html",controller:"searchController",controllerAs:"srchctrl"}}),angular.module("tink.gis").directive("searchOperations",function(){return{replace:!0,templateUrl:"templates/search/searchOperationsTemplate.html",controller:"searchOperationsController",controllerAs:"srchoprnctrl"}}),angular.module("tink.gis").directive("tinkSearchResults",function(){return{replace:!0,templateUrl:"templates/search/searchResultsTemplate.html",controller:"searchResultsController",controllerAs:"srchrsltsctrl"}}),angular.module("tink.gis").directive("tinkSearchSelected",function(){return{replace:!0,templateUrl:"templates/search/searchSelectedTemplate.html",controller:"searchSelectedController",controllerAs:"srchslctdctrl"}}),angular.module("tink.gis").factory("ResultsData",function(){var _data={SelectedFeature:null,JsonFeatures:[],RequestCompleted:0,RequestStarted:0,GetRequestPercentage:function(){var percentage=Math.round(_data.RequestCompleted/_data.RequestStarted*100);return isNaN(percentage)&&(percentage=100),percentage},EmptyResult:!1,CleanSearch:function(){_data.SelectedFeature=null,_data.JsonFeatures.length=0,_data.RequestStarted=_data.RequestStarted-_data.RequestCompleted,_data.RequestCompleted=0}};return _data}),function(){var module=angular.module("tink.gis");module.factory("SearchAdvancedService",function($rootScope,MapData,MapService,PopupService,$q,UIService){var _service={};$rootScope.attribute=null,$rootScope.operations=[],$rootScope.query="",$rootScope.selectedLayer=null,$rootScope.operators=["=","<>","<",">","<=",">=","LIKE","NOT LIKE"],$rootScope.autoComplete=[],_service.newOrOperation=function(){$rootScope.$broadcast("orOperation")},_service.newAddOperation=function(){$rootScope.$broadcast("addOperation")},$rootScope.$on("addedOperation",function(event,data){$rootScope.operations=data,$rootScope.$broadcast("queryOperationUpdated",$rootScope.operations)}),$rootScope.$on("deleteOperation",function(){$rootScope.$emit("deleteOperation")}),$rootScope.$on("alteredOperation",function(){$rootScope.$emit("alteredOperation")}),_service.UpdateFields=function(layer){$rootScope.selectedLayer=layer,$rootScope.$broadcast("updateFields",layer)};var checkOperator=function(value){var returnValue="";return"LIKE"==value.operator||"NOT LIKE"==value.operator?returnValue+=value.operator+" '%"+value.value+"%' ":returnValue+=value.operator+" '"+value.value+"' ",returnValue};return _service.BuildQuery=function(layer){$rootScope.query="",$rootScope.query+="FROM "+layer,angular.forEach($rootScope.operations,function(value,key){null==value.addition?$rootScope.query+=" WHERE "+value.attribute.name+" "+checkOperator(value):$rootScope.query+=value.addition+" "+value.attribute.name+" "+checkOperator(value)}),$rootScope.$broadcast("queryBuild",$rootScope.query)},_service.UpdateQuery=function(query){$rootScope.query=query,$rootScope.$broadcast("queryBuild",$rootScope.query)},_service.ExecuteQuery=function(layer,query){MapService.AdvancedQuery(layer,query),MapData.ShowDrawControls=!1,MapData.ActiveInteractieKnop=ActiveInteractieButton.NIETS},_service.TranslateOperations=function(operations){var query="";return operations.forEach(function(operation){null!=operation.addition&&(query+=" "+operation.addition+" ("),null!=operation.attribute&&(query+=operation.attribute.name+" "),null!=operation.value&&(query+=_service.HandleOperator(operation)),null!=operation.addition&&(query+=")")}),""===query&&PopupService.Warning("Ongeldige query","Kijk na of u een geldige query heeft samengesteld."),query},_service.HandleOperator=function(operation){switch(operation.value.toString().contains("'")&&(operation.value=operation.value.toString().substring(1).slice(0,-1)),operation.operator){case"LIKE":if(!operation.value.contains("%"))return operation.operator+" '%"+operation.value+"%'";default:return operation.operator+" '"+operation.value+"'"}},_service.MakeNewRawQuery=function(rawQuery){var whereIndex=rawQuery.indexOf("WHERE"),beforeWhere=rawQuery.substring(0,whereIndex);this.GetLayerIdIfValid(beforeWhere);var newQuery=rawQuery.substring(whereIndex);return newQuery=newQuery.replace("WHERE ",""),{layer:$rootScope.selectedLayer,query:newQuery}},_service.GetLayerIdIfValid=function(layerstring){return $rootScope.selectedLayer=null,MapData.VisibleLayers.forEach(function(layer){layerstring.contains(layer.name)&&($rootScope.selectedLayer=layer)}),$rootScope.selectedLayer||PopupService.Warning("Laag niet gevonden","Kijk na of u de laag juist heeft geschreven of deze laag in de selectie van lagen zit"),$rootScope.selectedLayer},_service.IsLayerField=function(currentLayer,fieldname){var isLayerField=!1;return currentLayer.fields.forEach(function(field){field.name==fieldname&&(isLayerField=!0)}),isLayerField},_service.GetLayerField=function(currentLayer,fieldname,line){var selectedField=null;return currentLayer.fields.forEach(function(field){field.name==fieldname&&((selectedField=field).$$hashKey=currentLayer.$$hashKey)}),null==selectedField?$rootScope.operations[line].attribute:selectedField},_service.BuildAutoCompleteQuery=function(val,index){if(0!=$rootScope.operations.length){var op=$rootScope.operations[index],query="";return query=""==val?op.attribute.name+" is not null":op.attribute.name+" like '%"+val+"%'",{layer:$rootScope.selectedLayer,attribute:op.attribute,query:query}}return{}},_service.IsOperator=function(element){var isOperator=!1;return $rootScope.operators.forEach(function(operator){operator==element&&(isOperator=!0)}),isOperator},_service}),module.$inject=["$rootScope","MapService","PopupService","$q","UIService"]}(),angular.module("tink.gis").factory("SearchService",function(ResultsData,map){var _service={DeleteFeature:function(feature){var featureOfArray=ResultsData.JsonFeatures.find(function(x){return x.layerName==feature.layerName&&x.id==feature.id}),featureIndex=ResultsData.JsonFeatures.indexOf(featureOfArray);-1<featureIndex&&(featureOfArray.mapItem&&map.removeLayer(featureOfArray.mapItem),ResultsData.JsonFeatures.splice(featureIndex,1))},DeleteFeatureGroup:function(featureGroupName){var toDelFeatures=[];ResultsData.JsonFeatures.forEach(function(feature){feature.layerName===featureGroupName&&toDelFeatures.push(feature)}),toDelFeatures.forEach(function(feat){_service.DeleteFeature(feat)})},ExportToCSV:function(){var csvContent="",dataString="",layName="";csvContent+="sep=;\n",csvContent+="Laag;\n",_.sortBy(ResultsData.JsonFeatures,function(x){return x.layerName}).forEach(function(feature,index){if(layName!==feature.layerName){layName=feature.layerName.replace(";",",");var tmparr=[];for(var name in feature.properties)tmparr.push(name.replace(";",","));tmparr.push("TYPE"),tmparr.push("Geometry");var layfirstline=tmparr.join(";");csvContent+=layName+";"+layfirstline+"\n"}var infoArray=_.values(feature.properties);infoArray.push(feature.geometry.type),infoArray.push(feature.geometry.coordinates),infoArray.unshift(layName),dataString=infoArray.join(";"),console.log(dataString),csvContent+=index<ResultsData.JsonFeatures.length?dataString+"\n":dataString});var a=document.createElement("a");a.href="data:attachment/csv,"+escape(csvContent),a.target="_blank",a.download="exportsik.csv",document.body.appendChild(a),a.click()},ExportOneToCSV:function(result){var props=Object.getOwnPropertyNames(result.properties).map(function(k){return{key:k,value:result.properties[k]}}),geo=Object.getOwnPropertyNames(result.geometry).map(function(k){return{key:k,value:result.geometry[k]}});props.push(geo[0]),props.push(geo[1]);var csvContent="";csvContent+="sep=;\n",csvContent+="Laag;"+result.layerName+"\n",props.forEach(function(prop){prop.key&&(prop.key=prop.key.toString().replace(";",",")),prop.value&&(prop.value=prop.value.toString().replace(";",",")),csvContent+=prop.key+";"+prop.value+"\n"});var a=document.createElement("a");a.href="data:attachment/csv,"+escape(csvContent),a.target="_blank",a.download="exportsik.csv",document.body.appendChild(a),a.click()},GetNextResult:function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(index<ResultsData.JsonFeatures.length-1){var nextItem=ResultsData.JsonFeatures[index+1];if(nextItem.layerName===layerName)return nextItem}return null},GetPrevResult:function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(0<index){var prevItem=ResultsData.JsonFeatures[index-1];if(prevItem.layerName===layerName)return prevItem}return null}};return _service}),L.TileLayer.BetterWMS=L.TileLayer.WMS.extend({getFeatureInfo:function(latlng,layers,requestype){var GisHelperService=angular.element(document.body).injector().get("GisHelperService"),url=this.getFeatureInfoUrl(latlng,layers,requestype);return url=GisHelperService.CreateProxyUrl(url),$.ajax({url:url,transformResponse:function(data){return data},success:function(data,status,xhr){},error:function(xhr,status,_error){}})},getFeatureInfoUrl:function(latlng,layers,requestype){var point=this._map.latLngToContainerPoint(latlng,this._map.getZoom()),size=this._map.getSize(),params={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:size.y,width:size.x,layers:layers,query_layers:layers,buffer:100,info_format:requestype};return params["1.3.0"===params.version?"i":"x"]=Math.floor(point.x),params["1.3.0"===params.version?"j":"y"]=Math.floor(point.y),this._url+L.Util.getParamString(params,this._url,!0)}}),L.tileLayer.betterWms=function(url,options){return new L.TileLayer.BetterWMS(url,options)},L.drawVersion="0.3.0-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Tekenen annuleren",text:"Annuleren"},finish:{title:"Tekenen beëindigen",text:"Tekenen beëindigen"},undo:{title:"Verwijder laatst getekende punt",text:"Verwijder laatste punt"},buttons:{polyline:"Teken een lijn",polygon:"Teken een veelhoek",rectangle:"Teken een rechthoek",circle:"Teken een cirkel",marker:"Teken een markering"}},handlers:{circle:{tooltip:{start:"Klik en sleep om een cirkel te tekenen."},radius:"Straal"},marker:{tooltip:{start:"Klik om een markering te plaatsen."}},polygon:{tooltip:{start:"Klik om een veelhoek  te tekenen.",cont:"Klik om de veelhoek verder te tekenen.",end:"Klik op het eerste punt om de veelhoek te sluiten."}},polyline:{error:"<strong>Error:</strong> figuur randen mogen niet kruisen!",tooltip:{start:"Klik om een lijn te tekenen.",cont:"Klik om de lijn verder te tekenen.",end:"Klik op het laatste punt om de lijn af te sluiten."}},rectangle:{tooltip:{start:"Klik en sleep om een rechthoek te tekenen."}},simpleshape:{tooltip:{end:"Laat de muis los om het tekenen te beëindigen."}}}},edit:{toolbar:{actions:{save:{title:"Aanpassingen bewaren.",text:"Bewaren"},cancel:{title:"Tekenen annuleren, aanpassingen verwijderen.",text:"Annuleren"}},buttons:{edit:"Lagen bewerken.",editDisabled:"Geen lagen om te bewerken.",remove:"Lagen verwijderen.",removeDisabled:"Geen lagen om te verwijderen."}},handlers:{edit:{tooltip:{text:"Versleep ankerpunt of markering om het object aan te passen.",subtext:"Klink Annuleer om de aanpassingen ongedaan te maken."}},remove:{tooltip:{text:"Klik op object om te verwijderen"}}}}},angular.module("tink.gis").factory("RecursionHelper",["$compile",function($compile){return{compile:function(element,link){angular.isFunction(link)&&(link={post:link});var compiledContents,contents=element.contents().remove();return{pre:link&&link.pre?link.pre:null,post:function(scope,element){compiledContents||(compiledContents=$compile(contents)),compiledContents(scope,function(clone){element.append(clone)}),link&&link.post&&link.post.apply(null,arguments)}}}}}]),angular.module("tink.gis").run(["$templateCache",function($templateCache){$templateCache.put("templates/external/streetView.html","<html>\n<head>\n<meta charset=utf-8>\n<title>Street View side-by-side</title>\n<style>\nhtml, body {\r\n        height: 100%;\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n      #map,  {\r\n        float: left;\r\n        height: 0%;\r\n        width: 0%;\r\n      }\r\n       #pano {\r\n        float: left;\r\n        height: 100%;\r\n        width: 100%;\r\n      }\n</style>\n</head>\n<body>\n<div id=map></div>\n<div id=pano></div>\n<script>\nfunction initialize() {\r\n        \r\n        var urlLat = parseFloat((location.search.split('lat=')[1]||'').split('&')[0]);\r\n        var urlLng = parseFloat((location.search.split('lng=')[1]||'').split('&')[0]);\r\n        var fenway = {lat:urlLat, lng: urlLng};\r\n        var map = new google.maps.Map(document.getElementById('map'), {\r\n          center: fenway,\r\n          zoom: 14\r\n        });\r\n        var panorama = new google.maps.StreetViewPanorama(\r\n            document.getElementById('pano'), {\r\n              position: fenway,\r\n              pov: {\r\n                heading: 34,\r\n                pitch: 10\r\n              }\r\n            });\r\n        map.setStreetView(panorama);\r\n      }\n<\/script>\n<script async defer src=\"https://maps.googleapis.com/maps/api/js?callback=initialize\">\n<\/script>\n</body>\n</html>"),$templateCache.put("templates/layermanagement/geoPuntTemplate.html",'<div class="gepoPuntTemplate row relative-container flex-grow-1">\n<div class="col-xs-4 flex-column flex-grow-1 margin-top margin-bottom border-right">\n<div ng-show="loading == false" class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom">\n<div ng-if="geopuntError === true">\n<p>De geopunt service(s) die u probeert te bevragen zijn (tijdelijk) niet bereikbaar.</p>\n<p>Indien dit probleem zich blijft voordoen, gelieve dit <a href=# ng-click=reportError()>hier</a> te melden.</p>\n</div>\n<div ng-if=!searchIsUrl ng-repeat="theme in availableThemes">\n<dl ng-class="{active: isActive(theme)}" ng-class="{\'not-allowed\': theme.Type != \'wms\' &&  theme.Type != \'esri\'}">\n<a href=# class=theme-layer ng-click=geopuntThemeChanged(theme)>\n<dt>{{theme.Naam}}</dt>\n</a>\n<i ng-if="theme.Added == true" class="fa fa-check-circle"></i>\n<i ng-if="theme.Added == null" class="fa fa-check-circle-o"></i>\n</dl>\n</div>\n</div>\n<div ng-show="loading == false">\n<tink-pagination ng-hide="numberofrecordsmatched <= 5" tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div ng-if="loading == true" class=loader>\n</div>\n</div>\n<div class="col-xs-8 flex-column flex-grow-1 margin-top margin-bottom">\n<preview-layer ng-show="themeloading == false" class=margin-top ng-if=copySelectedTheme addorupdatefunc=AddOrUpdateTheme() theme=copySelectedTheme>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/layerManagerTemplate.html",'<div class="layermanagerTemplate modal-header">\n<div class="row margin-bottom">\n<div class=col-xs-10>\n<h4>Zoeken in geodata</h4>\n</div>\n<div class=col-xs-2>\n<button class="close pull-right" type=button data-ng-click=cancel()></button>\n</div>\n</div>\n</div>\n<div class="modal-body height-lg width-lg flex-column flex-grow-1">\n<div class="row margin-top margin-bottom">\n<div class="col-xs-12 col-sm-6">\n<form>\n<input auto-focus type=search ng-keydown="$event.keyCode === 13 && enterPressed()" ng-model=searchTerm ng-change=searchChanged() ng-model-options="{debounce: 500}" placeholder="Geef een trefwoord in (minimum 3 tekens)">\n</form>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<ul class=nav-tabs>\n<li role=presentation ng-class="{\'active\': active==\'solr\'}"><a href="" ng-click="active=\'solr\'">Stad <span ng-if="solrLoading==true" class=loader></span><span ng-if="solrLoading==false && solrCount != null">({{solrCount}})</span></a></li>\n<li ng-show=!mobile role=presentation ng-class="{\'active\': active==\'geopunt\'}"><a href="" ng-click="active=\'geopunt\'">GeoPunt <span ng-if="geopuntLoading==true" class=loader></span><span ng-if="geopuntLoading==false && geopuntCount != null">({{geopuntCount}})</span></a></li>\n<li role=presentation class=pull-right ng-class="{\'active\': active==\'beheer\'}"><a href="" ng-click="active=\'beheer\'">Lagenbeheer</a></li>\n<li ng-show=!mobile role=presentation class=pull-right ng-class="{\'active\': active==\'themeurl\'}"><a href="" ng-click="active=\'themeurl\'">URL ingeven</a></li>\n</ul>\n</div>\n</div>\n<solr-gis ng-show="active==\'solr\'"></solr-gis>\n<geo-punt ng-show="active==\'geopunt\'"></geo-punt>\n<theme-url ng-show="active==\'themeurl\'"></theme-url>\n<layers-management ng-if="active==\'beheer\'"></layers-management></div>'),$templateCache.put("templates/layermanagement/layersManagementTemplate.html",'<div class="layersManagementTemplate row relative-container flex-grow-1">\n<div class="col-xs-4 flex-column flex-grow-1 margin-top margin-bottom">\n<div class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom border-right">\n<div ng-repeat="queryLayer in queryLayers">\n<dl ng-class="{active: isActiveQueryLayer(queryLayer)}">\n<a href=# class=theme-layer ng-click=QueryLayerChanged(queryLayer)>\n<dt>{{queryLayer.layer.name}} (query)<button class="trash pull-right" prevent-default ng-click=delQueryLayer(queryLayer)></button></dt>\n</a>\n</dl>\n</div>\n<div ng-repeat="theme in availableThemes | filter:{name: searchTerm}">\n<dl ng-class="{active: isActive(theme)}">\n<a href=# class=theme-layer ng-click=ThemeChanged(theme)>\n<dt>{{theme.name}}<button class="trash pull-right" prevent-default ng-click=delTheme(theme)></button>\n</dt>\n</a>\n</dl>\n</div>\n</div>\n</div>\n<div class="col-xs-8 flex-column flex-grow-1 margin-top margin-bottom">\n<preview-query-layer ng-if=selectedQueryLayer querylayer=selectedQueryLayer query=query></preview-query-layer>\n<preview-layer ng-if=copySelectedTheme theme=copySelectedTheme addorupdatefunc=AddOrUpdateTheme()>\n</preview-layer>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/managementLayerTemplate.html",'<div ng-if=lyrctrl.layer.hasLayers>\n<div class="layercontroller-checkbox managementLayerTemplate">\n<div class=can-open ng-class="{\'open\': showLayer}">\n<input indeterminate-checkbox child-list=lyrctrl.layer.AllLayers property=enabled type=checkbox ng-model=lyrctrl.layer.enabled id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}>\n<label for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}> {{lyrctrl.layer.title | limitTo: 99}}</label>\n<span class=show-layer ng-click="showLayer = !showLayer"></span>\n</div>\n<div ng-show=showLayer ng-repeat="lay in lyrctrl.layer.Layers">\n<tink-managementlayer layer=lay>\n</tink-managementlayer>\n</div>\n</div>\n</div>\n<div ng-if=!lyrctrl.layer.hasLayers>\n<div class="layercontroller-checkbox managementLayerTemplate">\n<input type=checkbox ng-model="lyrctrl.layer.enabled " id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}>\n<label for="{{lyrctrl.layer.name}}{{lyrctrl.layer.id}} "> {{lyrctrl.layer.title | limitTo: 99}}</label>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/previewLayerTemplate.html",'<div class="previewLayerTemplate flex-column flex-grow-1">\n<div class=margin-top>\n<p>{{theme.Description}}</p>\n<p><small><a ng-href={{theme.cleanUrl}} target=_blank>Details</a></small></p>\n</div>\n<div class="layercontroller-checkbox overflow-wrapper margin-bottom flex-grow-1">\n<input indeterminate-checkbox child-list=theme.AllLayers property=enabled type=checkbox ng-model=theme.enabled id={{theme.name}}>\n<label for={{theme.name}}>{{theme.name}}</label>\n<div ng-repeat="mainlayer in theme.Layers">\n<tink-managementlayer layer=mainlayer></tink-managementlayer>\n</div>\n</div>\n<div class=text-align-right ng-show="theme !== null">\n<button class="btn-sm btn-primary" ng-if="theme.Added == false" ng-disabled=!theme.enabled ng-click=addorupdatefunc()>Toevoegen</button>\n<button class=btn-sm ng-if="theme.Added != false" ng-click=addorupdatefunc()>Bijwerken</button>\n<button class=btn-sm ng-if="theme.Added != false" ng-click=delTheme()>Verwijderen</button>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/previewQueryLayerTemplate.html",'<div class="flex-column flex-grow-1">\n<div class=margin-top>\n<h4>{{querylayer.layer.name}}</h4>\n<p>Laag: {{querylayer.layer.layerName}}</p>\n<p><small>Query laag opgemaakt op basis van onderstaande query</small></p>\n<textarea ng-readonly=true class=text-cursor rows=4>{{query}}</textarea>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/solrGISTemplate.html",'<div class="solrGISTemplate row relative-container flex-grow-1">\n<div class="col-xs-5 flex-column flex-grow-1">\n<div class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom border-right">\n<div ng-show="loading == false" ng-repeat="theme in availableThemes">\n<dl ng-class="{active: isActive(theme)}">\n<dt>\n<a href=# class=theme-layer ng-click=solrThemeChanged(theme)>\n{{theme.name}} <i ng-if="theme.cleanUrl.toLowerCase().includes(\'p_sik\')" class="fa fa-key" aria-hidden=true tink-tooltip="Secured mapservice" tink-tooltip-align=right></i>\n</a>\n</dt>\n<dd ng-repeat="layer in theme.layers">\n<a href=# class=theme-layer ng-click="solrThemeChanged(theme, layer.naam)">\n<span>{{layer.naam}}\n<span ng-show="layer.featuresCount > 0"> ({{layer.featuresCount}})</span>\n</span>\n<div class=featureinsolr>\n{{layer.features.join(\', \')}}\n</div>\n</a>\n</dd>\n</dl>\n</div>\n</div>\n<div ng-show="loading == false">\n<tink-pagination ng-hide="numberofrecordsmatched <= 5" tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div ng-if="loading == true" class=loader>\n</div>\n</div>\n<div class="col-xs-7 flex-column flex-grow-1">\n<preview-layer ng-if=copySelectedTheme theme=copySelectedTheme addorupdatefunc=AddOrUpdateTheme()>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/themeUrlTemplate.html",'<div class="themeUrlTemplate row relative-container">\n<div class="col-xs-6 flex-column flex-grow-1 margin-top margin-bottom">\n<div>\n<input class=searchbox ng-model=url ng-change=urlChanged() placeholder="Geef een URL in van een webmapservice (wms) of ArcGIS mapservice (enkel arcgissql)" style=width:100%>\n</div>\n</div>\n<div class="col-xs-6 flex-column flex-grow-1 margin-top margin-bottom">\n<div>\n<button ng-disabled=!urlIsValid ng-click=laadUrl()>Laad url</button>\n</div>\n<preview-layer ng-show="themeloading == false" class=margin-top ng-if=copySelectedTheme addorupdatefunc=AddOrUpdateTheme() theme=copySelectedTheme>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>\n'),$templateCache.put("templates/other/layersTemplate.html",'<div data-tink-nav-aside="" id=rightaside data-auto-select=true data-toggle-id=asideNavRight class="nav-aside nav-right">\n<aside class="flex-column flex-grow-1">\n<div class=nav-aside-section>\n<p class=nav-aside-title>Lagenoverzicht</p>\n</div>\n<button ng-click=lyrsctrl.asidetoggle class=nav-right-toggle data-tink-sidenav-collapse=asideNavRight>\n<a href=# title="Open menu"><span class=sr-only>Open right menu</span></a>\n</button>\n<div class="flex-column flex-grow-1">\n<div class=layer-management ng-if=lyrsctrl.layerManagementButtonIsEnabled>\n<div class="col-xs-12 margin-top margin-bottom">\n<button class="btn btn-primary btn-layermanagement center-block" ng-click=lyrsctrl.Lagenbeheer()>Lagenbeheer</button>\n</div>\n</div>\n<div class="overflow-wrapper flex-grow-1 extra-padding">\n<div class="can-open margin-bottom" ng-show="lyrsctrl.queryLayers.length > 0" ng-class="{\'open\': lyrsctrl.showQueryLayers}">\n<label class=black-label>Query lagen:</label>\n<span class=show-layer ng-click="lyrsctrl.showQueryLayers = !lyrsctrl.showQueryLayers"></span>\n<ul class=ul-level id=queryLayers ng-show="lyrsctrl.showQueryLayers && lyrsctrl.queryLayers.length > 0">\n<li class="li-item querylayer-item" ng-repeat="queryLayer in lyrsctrl.queryLayers track by $index">\n<div class=can-open-second ng-class="{\'open\': showMultiLegend}">\n<img class=layer-icon ng-if="queryLayer.layer.legend.length ===1 && queryLayer.layer.legend[0].fullurl" class=layer-icon ng-src="{{queryLayer.layer.legend[0].fullurl}} ">\n<input class="visible-box hidden-print" type=checkbox id=queryDataChk{{$index}} ng-model=queryLayer.showLayer ng-change=lyrsctrl.updateQueryVisibility($index)>\n<label for=queryDataChk{{$index}} title="{{ queryLayer.layer.name }}"> {{ queryLayer.layer.name }}</label>\n<span style=color:#76b9f4 class=show-layer-second ng-show="queryLayer.layer.legend.length>1" ng-click="showMultiLegend = !showMultiLegend"></span>\n<span class="label-info hidden-print">Query</span>\n<button style="flex-grow: 2" class="trash hidden-print pull-right" ng-click=lyrsctrl.deleteQueryLayer($index)></button>\n<ul class=querylayer-legend ng-show="showMultiLegend && queryLayer.layer.legend.length>1">\n<li ng-repeat="legend in queryLayer.layer.legend"><img class=layer-icon ng-src={{legend.fullurl}}><span>{{legend.label}}</span></li>\n</ul>\n</div>\n</li>\n</ul>\n<hr>\n</div>\n<ul class=ul-level id=sortableThemes ui-sortable=lyrsctrl.sortableOptions ng-model=lyrsctrl.themes>\n<li class=li-item ng-repeat="theme in lyrsctrl.themes">\n<tink-theme theme=theme layercheckboxchange=lyrsctrl.updatethemevisibility(theme) hidedelete=!lyrsctrl.deleteLayerButtonIsEnabled>\n</tink-theme>\n</li>\n</ul>\n</div>\n</div>\n</aside>\n</div>\n'),$templateCache.put("templates/other/layerTemplate.html",'<div ng-class="{\'hidden-print\': lyrctrl.layer.IsEnabledAndVisible == false}">\n<div ng-if=lyrctrl.layer.hasLayers>\n<li class="li-item toc-item-without-icon can-open" ng-class="{\'open\': showLayer}">\n<div>\n<input class="visible-box hidden-print" type=checkbox id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}} ng-model=lyrctrl.layer.visible ng-change=layercheckboxchange(lyrctrl.layer.theme)>\n<label title={{lyrctrl.layer.name}} for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}}>{{lyrctrl.layer.name}}</label>\n</div>\n<div>\n<span class=show-layer ng-click="showLayer = !showLayer"></span>\n</div>\n</li>\n<ul ng-show=showLayer ng-repeat="layer in lyrctrl.layer.Layers | filter :  { enabled: true }">\n<tink-layer layer=layer layercheckboxchange=layercheckboxchange(layer.theme)>\n</tink-layer>\n</ul>\n</div>\n<li class="li-item toc-item-with-icon" ng-if=!lyrctrl.layer.hasLayers>\n<img class=layer-icon ng-if="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length===1" class=layer-icon ng-src="{{lyrctrl.layer.legend[0].fullurl}} ">\n<div class=can-open ng-class="{\'open\': showLayer2 || showMultiLegend}">\n<input class="visible-box hidden-print" type=checkbox ng-model=lyrctrl.layer.visible ng-change=layercheckboxchange(lyrctrl.layer.theme) id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}}>\n<label ng-class="{ \'greytext\': lyrctrl.layer.displayed==false} " for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}} title={{lyrctrl.layer.title}}>{{lyrctrl.layer.title}}\n<span class="hidden-print greytext" ng-show="lyrctrl.layer.theme.Type==\'wms\' && lyrctrl.layer.queryable"> <i class="fa fa-info"></i></span>\n</label>\n<span style=color:#76b9f4 class=show-layer ng-show="lyrctrl.layer.theme.Type==\'wms\'" ng-click="showLayer2 = !showLayer2"></span>\n<span style=color:#76b9f4 class=show-layer ng-show="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length>1" ng-click="showMultiLegend = !showMultiLegend"></span>\n<ul ng-show="showMultiLegend && lyrctrl.layer.legend.length>1" ng-repeat="legend in lyrctrl.layer.legend" ng-class="{\'open\': showMultiLegend}">\n<img class=layer-icon ng-src="{{legend.fullurl}} "><span>{{legend.label}}</span>\n</ul>\n<img class=normal-size ng-src={{lyrctrl.layer.legendUrl}} onerror="this.style.display=\'none\'" ng-show=showLayer2>\n</div>\n</li>\n<ul class=li-item ng-if="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length>1" ng-show=showLayer>\n<li ng-repeat="legend in lyrctrl.layer.legend">\n<img style="width:20px; height:20px" ng-src="{{legend.fullurl}} "><span title={{legend.label}}>{{legend.label}}</span>\n</li>\n</ul>\n</div>\n'),$templateCache.put("templates/other/mapTemplate.html",'<div class=tink-map>\n<div class="margin-print-content hidden-print">\n</div>\n<div class=print-content>\n<div class=print-content-header>\n<div class=col-xs-12>\n<h4>Stad in kaart</h4>\n</div>\n</div>\n<div class=print-map>\n<tink-search class=tink-search></tink-search>\n<div id=map class=leafletmap>\n<div class=map-buttons-left>\n<div class="ll drawingbtns" ng-show=mapctrl.showDrawControls>\n<div class=btn-group>\n<button ng-click=mapctrl.selectpunt() ng-class="{active: mapctrl.drawingType==\'\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een punt" tink-tooltip-align=bottom><i class="fa fa-circle" style="font-size: 0.75em"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'lijn\')" ng-class="{active: mapctrl.drawingType==\'lijn\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een lijn" tink-tooltip-align=bottom><i class="fa fa-minus"></i></button>\n<button ng-hide=mapctrl.mobile ng-click="mapctrl.drawingButtonChanged(\'vierkant\')" ng-class="{active: mapctrl.drawingType==\'vierkant\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een rechthoek" tink-tooltip-align=bottom><i class="fa fa-square-o"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'polygon\')" ng-class="{active: mapctrl.drawingType==\'polygon\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een veelhoek" tink-tooltip-align=bottom><i class="fa fa-star-o"></i></button>\n<button ng-click=mapctrl.selectAdvanced() ng-class="{active: mapctrl.drawingType==\'zoeken\'}" type=button class=btn prevent-default-map tink-tooltip="Geavanceerde opzoeking" tink-tooltip-align=bottom><i class="fa fa-search"></i></button>\n</div>\n<div class=select>\n<select ng-options="layer as layer.name for layer in mapctrl.SelectableLayers()" ng-model=mapctrl.selectedLayer ng-show="mapctrl.SelectableLayers().length > 1 && !mapctrl.mobile" ng-change=mapctrl.layerChange() prevent-default-map></select>\n</div>\n</div>\n<div class="btn-group btn-group-vertical ll interactiebtns">\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'identify\')" ng-class="{active: mapctrl.activeInteractieKnop==\'identify\'}" tink-tooltip=Identificeren tink-tooltip-align=bottom prevent-default-map><i class="fa fa-info"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'select\')" ng-class="{active: mapctrl.activeInteractieKnop==\'select\'}" tink-tooltip=Selecteren tink-tooltip-align=bottom prevent-default-map><i class="fa fa-mouse-pointer"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'meten\')" ng-class="{active: mapctrl.activeInteractieKnop==\'meten\'}" tink-tooltip=Meten tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-ruler"><use xlink:href=#icon-sik-ruler></use></svg>\n</button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'watishier\')" ng-class="{active: mapctrl.activeInteractieKnop==\'watishier\'}" tink-tooltip="Wat is hier" tink-tooltip-align=bottom prevent-default-map>\n<i class="fa fa-thumb-tack"></i>\n</button>\n</div>\n<div class="btn-group ll kaarttypes">\n<button class=btn ng-class="{active: mapctrl.IsBaseMap1==true && mapctrl.IsBaseMapGeen==false}" ng-click=mapctrl.toonBaseMap1() prevent-default-map>{{mapctrl.baseMap1Naam()}}</button>\n<button class=btn ng-class="{active: mapctrl.IsBaseMap2==true && mapctrl.IsBaseMapGeen==false}" ng-click=mapctrl.toonBaseMap2() prevent-default-map>{{mapctrl.baseMap2Naam()}}</button>\n</div>\n<div class="btn-group ll metenbtns" ng-show=mapctrl.showMetenControls>\n<button ng-click="mapctrl.drawingButtonChanged(\'afstand\')" ng-class="{active: mapctrl.drawingType==\'afstand\'}" type=button tink-tooltip="Meten afstand" tink-tooltip-align=bottom class=btn prevent-default-map>\n<svg class="icon icon-sik-measure-line"><use xlink:href=#icon-sik-measure-line></use></svg>\n</button>\n<button ng-click="mapctrl.drawingButtonChanged(\'oppervlakte\')" ng-class="{active: mapctrl.drawingType==\'oppervlakte\'}" type=button tink-tooltip="Meten oppervlakte en omtrek" tink-tooltip-align=bottom class=btn prevent-default-map>\n<svg class="icon icon-sik-measure-shape"><use xlink:href=#icon-sik-measure-shape></use></svg>\n</button>\n</div>\n<div class="btn-group ll searchbtns">\n<button type=button class="btn tooltip-margin-left" ng-class="{active: mapctrl.ZoekenOpLocatie==true}" ng-click=mapctrl.fnZoekenOpLocatie() tink-tooltip="Zoeken naar locatie" tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-location-search"><use xlink:href=#icon-sik-location-search></use></svg>\n</button>\n<button type=button class=btn ng-class="{active: mapctrl.ZoekenOpLocatie==false}" ng-click=mapctrl.ZoekenInLagen() tink-tooltip="Zoeken binnen lagen" tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-layers-search"><use xlink:href=#icon-sik-layers-search></use></svg>\n</button>\n</div>\n<form id=zoekbalken class="form-force-inline ll zoekbalken">\n<select ng-options="layer as layer.name for layer in mapctrl.SelectableLayers()" ng-model=mapctrl.selectedFindLayer ng-show="mapctrl.SelectableLayers().length > 1 && mapctrl.SelectableLayers()" ng-change=mapctrl.findLayerChange() prevent-default-map></select>\n<input type=search ng-show="mapctrl.ZoekenOpLocatie == false" placeholder="Geef een zoekterm" prevent-default-map ng-keyup="$event.keyCode == 13 && mapctrl.zoekLaag(mapctrl.laagquery)" ng-model=mapctrl.laagquery>\n</form>\n</div>\n<div class=map-buttons-right>\n<div class="btn-group btn-group-vertical ll viewbtns">\n<button type=button class=btn ng-click=mapctrl.setCityView() tink-tooltip="Stad weergeven" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-home"></i>\n</button>\n<button type=button class=btn ng-click=mapctrl.zoomIn() tink-tooltip="Zoom in" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-plus"></i>\n</button>\n<button type=button class=btn ng-click=mapctrl.zoomOut() tink-tooltip="Zoom uit" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-minus"></i>\n</button>\n<button type=button class=btn ng-click=mapctrl.zoomToGps() ng-class="{active: mapctrl.gpstracking==true}" tink-tooltip="Huidige locatie" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-crosshairs"></i>\n</button>\n</div>\n<div class="ll loading" ng-show="mapctrl.Loading > 0">\n<div class=loader></div> {{mapctrl.MaxLoading - mapctrl.Loading}}/ {{mapctrl.MaxLoading}}\n</div>\n</div>\n</div>\n<tink-layers class=tink-layers></tink-layers>\n</div>\n<div class=print-content-footer>\n<div class=col-xs-2>\n<img class=print-corner-image src=https://www.antwerpen.be/assets/aOS/gfx/gui/a-logo.svg alt="Antwerpen logo">\n</div>\n<div class=col-xs-8>\nVoorbehoud: De kaart is een reproductie zonder juridische waarde. Zij bevat kaartmateriaal en info afkomstig van het stadsbestuur Antwerpen, IV, AAPD, Provinciebesturen en mogelijk nog andere organisaties.\n</div>\n<div class=col-xs-2>\n<img class="print-corner-image pull-right" src=http://images.vectorhq.com/images/previews/111/north-arrow-orienteering-137692.png alt="Noord pijl oriëntatielopen">\n</div>\n</div>\n</div>\n<div class="margin-print-content hidden-print">\n</div>\n<svg style="position: absolute; width: 0; height: 0; overflow: hidden" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink>\n<defs>\n<symbol id=icon-sik-file-csv viewBox="0 0 32 32">\n<title>sik-file-csv</title>\n<path d="M4 0c-0.476 0-0.881 0.167-1.214 0.5s-0.5 0.738-0.5 1.214v28.571c0 0.476 0.167 0.881 0.5 1.214s0.738 0.5 1.214 0.5h24c0.476 0 0.881-0.167 1.214-0.5s0.5-0.738 0.5-1.214v-20.571c0-0.476-0.119-1-0.357-1.571s-0.524-1.024-0.857-1.357l-5.571-5.571c-0.333-0.333-0.786-0.619-1.357-0.857s-1.095-0.357-1.571-0.357h-16zM4.571 2.286h13.714v7.429c0 0.476 0.167 0.881 0.5 1.214s0.738 0.5 1.214 0.5h7.429v18.286h-22.857v-27.429zM20.571 2.429c0.345 0.119 0.589 0.25 0.732 0.393l5.589 5.589c0.143 0.143 0.274 0.387 0.393 0.732h-6.714v-6.714zM9.363 18.845c-0.995 0-1.798 0.328-2.409 0.984-0.611 0.653-0.916 1.57-0.916 2.753 0 1.118 0.304 2 0.911 2.646 0.607 0.643 1.383 0.964 2.326 0.964 0.762 0 1.391-0.187 1.885-0.562 0.498-0.378 0.853-0.955 1.066-1.73l-1.391-0.441c-0.12 0.52-0.317 0.901-0.591 1.144s-0.603 0.363-0.984 0.363c-0.517 0-0.937-0.191-1.26-0.572s-0.485-1.021-0.485-1.919c0-0.846 0.163-1.459 0.489-1.837 0.33-0.378 0.758-0.567 1.284-0.567 0.381 0 0.704 0.107 0.969 0.32 0.268 0.213 0.444 0.504 0.528 0.872l1.42-0.339c-0.162-0.569-0.404-1.005-0.727-1.309-0.543-0.514-1.249-0.771-2.118-0.771zM15.93 18.845c-0.546 0-1.013 0.082-1.401 0.247-0.384 0.165-0.68 0.405-0.887 0.722-0.204 0.313-0.305 0.651-0.305 1.013 0 0.562 0.218 1.039 0.654 1.43 0.31 0.278 0.85 0.512 1.619 0.703 0.598 0.149 0.981 0.252 1.149 0.31 0.246 0.087 0.417 0.191 0.514 0.31 0.1 0.116 0.15 0.258 0.15 0.426 0 0.262-0.118 0.491-0.354 0.688-0.233 0.194-0.58 0.291-1.042 0.291-0.436 0-0.783-0.11-1.042-0.33-0.255-0.22-0.425-0.564-0.509-1.032l-1.396 0.136c0.094 0.795 0.381 1.401 0.863 1.817 0.481 0.414 1.171 0.62 2.069 0.62 0.617 0 1.132-0.086 1.546-0.257 0.414-0.174 0.733-0.439 0.96-0.795s0.339-0.737 0.339-1.144c0-0.449-0.095-0.825-0.286-1.129-0.187-0.307-0.449-0.548-0.785-0.722-0.333-0.178-0.848-0.349-1.546-0.514s-1.137-0.323-1.318-0.475c-0.142-0.12-0.213-0.263-0.213-0.431 0-0.184 0.076-0.331 0.228-0.441 0.236-0.171 0.562-0.257 0.979-0.257 0.404 0 0.706 0.081 0.906 0.242 0.204 0.158 0.336 0.42 0.397 0.785l1.435-0.063c-0.023-0.653-0.26-1.174-0.712-1.565-0.449-0.391-1.12-0.586-2.011-0.586zM19.346 18.967l2.54 7.105h1.531l2.544-7.105h-1.522l-1.74 5.258-1.798-5.258h-1.556z"></path>\n</symbol>\n<symbol id=icon-sik-measure-shape viewBox="0 0 32 32">\n<title>sik-measure-shape</title>\n<path d="M18.533 0.018c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v2.955l-5.695 2.445c-0.080-0.33-0.249-0.623-0.506-0.881-0.373-0.373-0.823-0.56-1.348-0.56h-5.513c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v5.513c0 0.526 0.187 0.975 0.56 1.348s0.823 0.56 1.348 0.56h0.658l-0.99 7.437h-0.626c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v5.513c0 0.526 0.187 0.975 0.56 1.348s0.823 0.56 1.348 0.56h5.513c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-1.134l12.198-4.496c0.090 0.277 0.246 0.528 0.469 0.751 0.373 0.373 0.823 0.56 1.348 0.56h5.513c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-5.513c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-2.342l-2.353-7.254c0.193-0.092 0.371-0.22 0.535-0.383 0.373-0.373 0.56-0.823 0.56-1.348v-5.513c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-5.513zM19.63 1.874h3.319c0.317 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.316-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.317 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.317 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM16.625 7.471c0.008 0.512 0.194 0.95 0.56 1.316 0.373 0.373 0.823 0.56 1.348 0.56h3.808l2.296 7.078h-0.595c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v3.562l-12.108 4.463v-1.797c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-2.373l0.99-7.437h2.341c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-3.414l5.641-2.422zM4.66 7.742h3.319c0.316 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.316-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.316 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.316 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM25.139 18.281h3.319c0.317 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.317-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.316 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.316 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM3.702 24.509h3.319c0.316 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.317-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.317 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.317 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337z"></path>\n</symbol>\n<symbol id=icon-sik-measure-line viewBox="0 0 32 32">\n<title>sik-measure-line</title>\n<path d="M24.752 0.172c-0.512 0-0.95 0.182-1.314 0.546s-0.546 0.802-0.546 1.314v5.371c0 0.055 0.002 0.109 0.006 0.162l-15.22 15.22c-0.137-0.031-0.28-0.047-0.43-0.047h-5.371c-0.512 0-0.95 0.182-1.314 0.546s-0.546 0.802-0.546 1.314v5.371c0 0.512 0.182 0.95 0.546 1.314s0.802 0.546 1.314 0.546h5.371c0.512 0 0.95-0.182 1.314-0.546s0.546-0.802 0.546-1.314v-5.371c0-0.005-0-0.009-0-0.013l15.345-15.345c0.097 0.015 0.197 0.022 0.3 0.022h5.371c0.512 0 0.95-0.182 1.314-0.546s0.546-0.802 0.546-1.314v-5.371c0-0.512-0.182-0.95-0.546-1.314s-0.802-0.546-1.314-0.546h-5.371zM25.82 1.98h3.234c0.308 0 0.572 0.11 0.791 0.328s0.328 0.483 0.328 0.791v3.234c0 0.308-0.109 0.572-0.328 0.791s-0.483 0.328-0.791 0.328h-3.234c-0.308 0-0.572-0.109-0.791-0.328s-0.328-0.483-0.328-0.791v-3.234c0-0.308 0.11-0.572 0.328-0.791s0.483-0.328 0.791-0.328zM2.946 24.547h3.234c0.308 0 0.572 0.11 0.791 0.328s0.328 0.483 0.328 0.791v3.234c0 0.308-0.109 0.572-0.328 0.791s-0.483 0.328-0.791 0.328h-3.234c-0.308 0-0.572-0.109-0.791-0.328s-0.328-0.483-0.328-0.791v-3.234c0-0.308 0.109-0.572 0.328-0.791s0.483-0.328 0.791-0.328z"></path>\n</symbol>\n<symbol id=icon-sik-ruler viewBox="0 0 32 32">\n<title>sik-ruler</title>\n<path d="M25.28 0.018c-0.698 0-1.295 0.249-1.794 0.747l-22.721 22.721c-0.498 0.498-0.747 1.096-0.747 1.794s0.249 1.295 0.747 1.794l3.588 3.588c0.001 0.001 0.001 0.001 0.002 0.002l0.572 0.572c0.498 0.498 1.096 0.747 1.794 0.747s1.296-0.249 1.794-0.747l22.721-22.721c0.498-0.498 0.747-1.096 0.747-1.794s-0.249-1.295-0.747-1.794l-4.161-4.161c-0.498-0.498-1.096-0.747-1.794-0.747zM25.243 2.374c0.48-0.001 0.882 0.161 1.206 0.485l2.67 2.67c0.371 0.371 0.529 0.843 0.475 1.417s-0.306 1.085-0.755 1.533l-20.458 20.458c-0.449 0.449-0.96 0.7-1.534 0.755s-1.046-0.104-1.417-0.475l-2.67-2.67c-0.371-0.371-0.529-0.843-0.475-1.417s0.306-1.085 0.755-1.534l0.289-0.289 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.128 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 3.436 3.436c0.080 0.080 0.168 0.126 0.265 0.141s0.175-0.008 0.234-0.067l0.426-0.426c0.059-0.059 0.082-0.137 0.067-0.234s-0.061-0.185-0.141-0.265l-3.436-3.436 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 3.436 3.436c0.080 0.080 0.168 0.126 0.265 0.141s0.175-0.008 0.234-0.067l0.426-0.426c0.059-0.059 0.082-0.137 0.067-0.234s-0.061-0.185-0.141-0.265l-3.436-3.436 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 0.938-0.938c0.449-0.449 0.96-0.7 1.534-0.755 0.072-0.007 0.142-0.010 0.21-0.010z"></path>\n</symbol>\n<symbol id=icon-sik-layers-search viewBox="0 0 32 32">\n<title>sik-layers-search</title>\n<path d="M16.105 1.196c-0.725 0-1.341 0.152-1.85 0.456l-12.581 7.525c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.704 1.85 0.704s1.341-0.4 1.85-0.704l12.581-7.525c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-12.581-7.525c-0.509-0.304-1.126-0.456-1.85-0.456zM16.105 2.448c0.146 0 0.27 0.030 0.37 0.090l12.581 7.525c0.1 0.060 0.15 0.134 0.15 0.221s-0.050 0.162-0.15 0.221l-12.499 7.443c-0.1 0.060-0.306 0.172-0.453 0.172s-0.352-0.113-0.453-0.172l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l12.581-7.525c0.1-0.060 0.224-0.090 0.37-0.090zM3.524 13.383l-1.85 1.107c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.622 1.85 0.622 0.093 0 0.184-0.005 0.273-0.015-0.032-0.238-0.052-0.515-0.056-0.797 0-0.246 0.013-0.486 0.037-0.722-0.087 0.056-0.179 0.076-0.255 0.076-0.146 0-0.352-0.071-0.453-0.131l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l1.85-1.107-1.48-0.885zM28.687 13.383l-1.48 0.885 1.85 1.107c0.1 0.060 0.15 0.134 0.15 0.221s-0.050 0.162-0.15 0.221l-3.214 1.914c0.572 0.248 1.064 0.544 1.512 0.895l3.181-1.923c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-1.85-1.107zM23.284 18.403c-0.756 0-1.479 0.147-2.169 0.44s-1.285 0.69-1.784 1.189c-0.5 0.5-0.896 1.094-1.19 1.784s-0.44 1.413-0.44 2.169c0 0.756 0.147 1.479 0.44 2.169s0.69 1.285 1.19 1.784c0.5 0.5 1.094 0.896 1.784 1.189s1.413 0.44 2.169 0.44c1.163 0 2.218-0.328 3.164-0.983l2.72 2.712c0.19 0.201 0.428 0.301 0.714 0.301 0.275 0 0.513-0.1 0.714-0.301s0.301-0.439 0.301-0.714c0-0.28-0.098-0.518-0.293-0.714l-2.72-2.72c0.656-0.946 0.983-2.001 0.983-3.164 0-0.756-0.147-1.479-0.44-2.169s-0.69-1.285-1.19-1.784c-0.5-0.5-1.094-0.896-1.784-1.189s-1.413-0.44-2.169-0.44zM3.535 18.677l-1.85 1.107c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.622 1.85 0.622s1.341-0.317 1.85-0.622l0.647-0.387c-0.389-0.349-0.733-0.734-1.030-1.155l-1.015 0.574c-0.1 0.060-0.306 0.131-0.453 0.131s-0.352-0.072-0.453-0.131l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l1.85-1.107-1.48-0.885zM28.698 18.677l-0.759 0.454c0.486 0.472 0.9 1.014 1.228 1.61 0.021 0.040 0.024 0.045 0.027 0.051 0.259 0.472 0.474 1.019 0.616 1.594l0.738-0.389c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-1.85-1.107zM23.284 20.433c0.978 0 1.815 0.348 2.51 1.043s1.043 1.532 1.043 2.51c0 0.978-0.348 1.814-1.043 2.51s-1.532 1.043-2.51 1.043c-0.978 0-1.815-0.348-2.51-1.043s-1.043-1.532-1.043-2.51c0-0.978 0.348-1.814 1.043-2.51s1.532-1.043 2.51-1.043z"></path>\n</symbol>\n<symbol id=icon-sik-location-search viewBox="0 0 32 32">\n<title>sik-location-search</title>\n<path d="M15.299 0.018c-2.941 0-5.452 1.040-7.533 3.122s-3.122 4.592-3.122 7.533c0 1.512 0.229 2.754 0.687 3.725l7.596 16.107c0.208 0.458 0.531 0.819 0.968 1.082s0.905 0.395 1.405 0.395c0.499 0 0.968-0.132 1.405-0.395s0.767-0.624 0.988-1.082l0.555-1.18c-1.416-1.328-2.3-3.21-2.303-5.298 0-0.001 0-0.001 0-0.001 0-4.018 3.258-7.276 7.276-7.276 0 0 0 0 0 0 0.324 0.003 0.639 0.026 0.949 0.069l1.098-2.42c0.458-0.971 0.687-2.213 0.687-3.725 0-2.941-1.041-5.452-3.122-7.533s-4.592-3.122-7.533-3.122zM15.299 5.345c1.471 0 2.726 0.52 3.767 1.561s1.561 2.296 1.561 3.767c0 1.471-0.52 2.726-1.561 3.767s-2.296 1.561-3.767 1.561c-1.471 0-2.726-0.52-3.767-1.561s-1.561-2.296-1.561-3.767c0-1.471 0.52-2.726 1.561-3.767s2.296-1.561 3.767-1.561zM23.276 18.352c-0.762 0-1.49 0.148-2.186 0.444s-1.295 0.695-1.798 1.199c-0.503 0.503-0.903 1.103-1.199 1.798s-0.444 1.424-0.444 2.186c0 0.762 0.148 1.49 0.444 2.186s0.695 1.295 1.199 1.798c0.503 0.503 1.103 0.903 1.798 1.199s1.424 0.444 2.186 0.444c1.172 0 2.235-0.33 3.189-0.991l2.741 2.733c0.192 0.202 0.431 0.304 0.719 0.304 0.277 0 0.517-0.101 0.719-0.304s0.304-0.442 0.304-0.719c0-0.282-0.099-0.522-0.296-0.719l-2.741-2.741c0.661-0.954 0.991-2.016 0.991-3.189 0-0.762-0.148-1.49-0.444-2.186s-0.695-1.295-1.199-1.798c-0.503-0.503-1.103-0.903-1.798-1.199s-1.424-0.444-2.186-0.444zM23.276 20.397c0.986 0 1.829 0.35 2.529 1.051s1.051 1.544 1.051 2.529c0 0.986-0.35 1.829-1.051 2.529s-1.544 1.051-2.529 1.051c-0.986 0-1.829-0.35-2.529-1.051s-1.051-1.544-1.051-2.529c0-0.986 0.35-1.829 1.051-2.529s1.544-1.051 2.529-1.051z"></path>\n</symbol>\n<symbol id=icon-sik-buffer viewBox="0 0 32 32">\n<title>sik-buffer</title>\n<path d="M6.538 0.018c-1.801 0-3.341 0.639-4.62 1.918s-1.918 2.819-1.918 4.62v18.888c0 1.801 0.639 3.341 1.918 4.62s2.819 1.918 4.62 1.918h18.888c1.801 0 3.341-0.639 4.62-1.918s1.918-2.819 1.918-4.62v-18.888c0-1.801-0.639-3.341-1.918-4.62s-2.819-1.918-4.62-1.918h-18.888zM6.538 2.924h18.888c0.999 0 1.854 0.356 2.565 1.067s1.067 1.566 1.067 2.565v18.888c0 0.999-0.356 1.854-1.067 2.565s-1.566 1.067-2.565 1.067h-18.888c-0.999 0-1.854-0.356-2.565-1.067s-1.067-1.566-1.067-2.565v-18.888c0-0.999 0.356-1.854 1.067-2.565s1.566-1.067 2.565-1.067zM9.696 5.091c-1.199 0-2.224 0.426-3.075 1.277s-1.277 1.876-1.277 3.075v12.573c0 1.199 0.426 2.224 1.277 3.075s1.876 1.277 3.075 1.277h12.573c1.199 0 2.224-0.426 3.075-1.277s1.277-1.876 1.277-3.075v-12.573c0-1.199-0.426-2.224-1.277-3.075s-1.876-1.277-3.075-1.277h-12.573zM9.696 7.025h12.573c0.665 0 1.234 0.237 1.708 0.71s0.71 1.043 0.71 1.708v12.573c0 0.665-0.237 1.234-0.71 1.708s-1.043 0.71-1.708 0.71h-12.573c-0.665 0-1.234-0.237-1.708-0.71s-0.71-1.043-0.71-1.708v-12.573c0-0.665 0.237-1.234 0.71-1.708s1.043-0.71 1.708-0.71z"></path>\n</symbol>\n<symbol id=icon-sik-press-through viewBox="0 0 32 32">\n<title>sik-press-through</title>\n<path d="M6.556 0.018c-1.801 0-3.341 0.639-4.62 1.918s-1.918 2.819-1.918 4.62v18.888c0 1.801 0.639 3.341 1.918 4.62s2.819 1.918 4.62 1.918h18.888c1.801 0 3.341-0.639 4.62-1.918s1.918-2.819 1.918-4.62v-18.888c0-1.801-0.639-3.341-1.918-4.62s-2.819-1.918-4.62-1.918h-18.888zM6.556 2.924h18.888c0.999 0 1.854 0.356 2.565 1.067s1.067 1.566 1.067 2.565v18.888c0 0.999-0.356 1.854-1.067 2.565s-1.566 1.067-2.565 1.067h-18.888c-0.999 0-1.854-0.356-2.565-1.067s-1.067-1.566-1.067-2.565v-18.888c0-0.999 0.356-1.854 1.067-2.565s1.566-1.067 2.565-1.067zM9.714 5.091c-1.199 0-2.224 0.426-3.075 1.277s-1.277 1.876-1.277 3.075v12.573c0 1.199 0.426 2.224 1.277 3.075s1.876 1.277 3.075 1.277h12.573c1.199 0 2.224-0.426 3.075-1.277s1.277-1.876 1.277-3.075v-12.573c0-1.199-0.426-2.224-1.277-3.075s-1.876-1.277-3.075-1.277h-12.573zM9.714 7.025h4.953l-7.371 7.371v-4.953c0-0.665 0.237-1.234 0.71-1.708s1.043-0.71 1.708-0.71zM18.777 7.025h3.51c0.168 0 0.33 0.015 0.486 0.046l-15.423 15.473c-0.036-0.169-0.054-0.345-0.054-0.529v-3.51l11.481-11.481zM24.7 9.288c0.003 0.051 0.005 0.103 0.005 0.155v3.96l-11.031 11.030h-3.96c-0.089 0-0.176-0.004-0.262-0.013l15.248-15.133zM24.704 17.512v4.503c0 0.665-0.237 1.234-0.71 1.708s-1.043 0.71-1.708 0.71h-4.503l6.921-6.921z"></path>\n</symbol>\n</defs>\n</svg>\n</div>\n'),$templateCache.put("templates/other/themeTemplate.html",'<div>\n<div style=display:flex>\n<input class="visible-box hidden-print" type=checkbox id=chk{{thmctrl.theme.Naam}} ng-model=thmctrl.theme.Visible ng-change=layercheckboxchange(thmctrl.theme)>\n<label for=chk{{thmctrl.theme.Naam}} title={{thmctrl.theme.Naam}}> {{thmctrl.theme.Naam}}\n<span class="label-info hidden-print" ng-show="thmctrl.theme.Type==\'esri\'">ArcGIS</span>\n<span class="label-info hidden-print" ng-hide="thmctrl.theme.Type==\'esri\'">{{thmctrl.theme.Type}}</span>\n</label>\n<button ng-hide="hidedelete == true" style="flex-grow: 2" class="trash hidden-print pull-right" ng-click=thmctrl.deleteTheme()></button>\n</div>\n<div style=display:flex class=hidden-print ng-show="thmctrl.theme.Type==\'esri\'">\n<rzslider class="custom-slider hidden-print" rz-slider-model=thmctrl.transpSlider.value rz-slider-options=thmctrl.transpSlider.options></rzslider>\n</div>\n<ul class="ul-level no-theme-layercontroller-checkbox" ng-repeat="layer in thmctrl.theme.Layers | filter: { enabled: true }">\n<tink-layer layer=layer layercheckboxchange=layercheckboxchange(layer.theme)>\n</tink-layer>\n</ul>\n</div>'),$templateCache.put("templates/search/bufferTemplate.html",'<div class=modal-header>\n<div class="row margin-bottom">\n<div class=col-xs-10>\n<h4>Buffer instellen</h4>\n</div>\n<div class=col-xs-2>\n<button class="close pull-right" type=button data-ng-click=cancel()></button>\n</div>\n</div>\n</div>\n<div class="modal-body width-sm flex-column flex-grow-1">\n<div class="row margin-top">\n<div class=col-xs-12>\n<div class=form-group>\n<label for=select>Selecteer de laag:</label>\n<div class=select>\n<select ng-options="layer as layer.name for layer in SelectableLayers" ng-keydown="$event.keyCode === 13 && ok()" ng-model=selectedLayer prevent-default></select>\n</div>\n</div>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<div class=form-group>\n<label for=input-number>Geef de bufferafstand (m):</label>\n<input type=number ng-keydown="$event.keyCode === 13 && ok()" class=hide-spin-button ng-model=buffer auto-focus>\n</div>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<div class=text-right>\n<button type=submit data-ng-click=ok()>Klaar</button>\n</div>\n</div>\n</div>\n</div>\n'),$templateCache.put("templates/search/searchAdvancedTemplate.html",'<div class="searchAdvancedTemplate modal-header">\n<div class="row margin-bottom">\n<div class=col-xs-10>\n<h4>Geavanceerd zoeken</h4>\n</div>\n<div class=col-xs-2>\n<button class="close pull-right" type=button data-ng-click=cancel()></button>\n</div>\n</div>\n</div>\n<div class="modal-body width-lg flex-column flex-grow-1">\n<div class="row margin-top">\n<div class=col-xs-12>\n<h4>Query Builder</h4>\n</div>\n<div class="form-group col-xs-3 margin-top">\n<select ng-model=selectedLayer ng-options="layer as layer.name for layer in SelectedLayers()" ng-change=updateFields()></select>\n</div>\n<div class=col-xs-9>\n<search-operations></search-operations>\n</div>\n<div class="margin-top margin-bottom col-xs-12">\n<button ng-click=addOperation()>AND</button>\n<button ng-click=orOperation()>OR</button>\n<button class=pull-right ng-click=openQueryEditor()>Query Genereren</button>\n</div>\n</div>\n</div>\n<div class="row margin-top" ng-show=editor>\n<span class="empty-message col-xs-12">* Opgelet! Aanpassingen in de editor zijn niet omkeerbaar naar de Query Builder *</span>\n<div class=col-xs-12>\n<h4>Editor</h4>\n</div>\n<div class=col-xs-12>\n<textarea rows=4 ng-model=query ng-change=updateQuery()>{{query}}</textarea>\n</div>\n</div>\n<div class="searchAdvancedTemplate modal-footer">\n<div class="margin-top row">\n<button type=button class="btn btn-info" ng-click=QueryAPI()>Pas toe</button>\n<button type=button class=btn ng-click=cancel()> Annuleer</button>\n<button type=button class="btn btn-info" ng-click=FilterQueriedLayer()>Query laag maken/bijwerken</button>\n<label for=queryLayerName class="margin-left black-label">Query laag naam:</label>\n<input class=small-input id=queryLayerName ng-model=queryLayerName>\n</div>\n</div>'),$templateCache.put("templates/search/searchOperationsTemplate.html",'<div>\n<div class=form-group ng-repeat="operation in operations track by $index">\n<div class="formgroup col-xs-4">\n<div ng-show="operation.addition != null && !$first" class=andOr>{{operation.addition}}</div>\n<select ng-model=operation.attribute ng-change=updateOperation($index) ng-options="attr as attr.displayName for attr in attributes" value={{operation.attribute}}></select>\n</div>\n<div class="form-group col-xs-2" ng-class="{\'col-xs-4\': operations.length == 1}">\n<select ng-model=operation.operator ng-options="x for x in operators" ng-change=updateOperation($index)></select>\n</div>\n<div class="form-group col-xs-4 querybuild">\n<input class=typeaheadsearchoperations ng-class=waarde_$index type=search value={{operation.value}} placeholder=Waarde ng-model=operation.value ng-change=updateOperation($index) ng-click=valueChanged($index) ng-model-options="{ debounce: 500 }" id=input_waarde_{{$index}}>\n</div>\n<div class="form-group col-xs-2">\n<button type=button class=up ng-show=!$first ng-click=up($index)></button>\n<button type=button class=down ng-show=!$last ng-click=down($index)></button>\n<button type=button class=closetransparant ng-show=!$first ng-click=delete($index)></button>\n</div>\n</div>\n</div>\n'),$templateCache.put("templates/search/searchResultsTemplate.html",'<div class="SEARCHRESULT flex-column">\n<div class=flex-column ng-if="!srchrsltsctrl.selectedResult && srchrsltsctrl.featureLayers.length == 0">\n<div class="col-xs-12 flex-grow-1 margin-top">\nGeen resultaten.\n</div>\n</div>\n<div class="flex-column flex-grow-1 margin-top" ng-if="!srchrsltsctrl.selectedResult && srchrsltsctrl.featureLayers.length > 0">\n<div class="row extra-padding">\n<div class="col-xs-12 margin-bottom text-right">\n<button class=btn tink-tooltip="Exporteer naar CSV" tink-tooltip-align=top ng-if=srchrsltsctrl.exportToCSVButtonIsEnabled ng-click=srchrsltsctrl.exportToCSV()>\n<svg class="icon icon-sik-file-csv"><use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-sik-file-csv></use></svg>\n</button>\n<button class=btn ng-class="{active: srchrsltsctrl.extendedType ==\'add\'}" tink-tooltip="Selectie toevoegen" tink-tooltip-align=top ng-click=srchrsltsctrl.addSelection()>\n<i class="fa fa-plus" aria-hidden=true></i>\n</button>\n<button class=btn ng-class="{active: srchrsltsctrl.extendedType==\'remove\'}" tink-tooltip="Selectie verwijderen" tink-tooltip-align=top ng-click=srchrsltsctrl.removeSelection()>\n<i class="fa fa-minus" aria-hidden=true></i>\n</button>\n<button class=btn-sm ng-if=srchrsltsctrl.extraResultButtonIsEnabled ng-click=srchrsltsctrl.extraResultButton()>{{srchrsltsctrl.resultButtonText}}</button>\n<button class=btn-sm ng-if=srchrsltsctrl.secondResultButtonIsEnabled ng-click=srchrsltsctrl.secondResultButton()>{{srchrsltsctrl.secondResultButtonText}}</button>\n</div>\n<div class=col-xs-12>\n<select ng-model=srchrsltsctrl.layerGroupFilter>\n<option value=geenfilter selected>Geen filter ({{srchrsltsctrl.features.length}})</option>\n<option ng-repeat="feat in srchrsltsctrl.featureLayers" value={{feat}}>{{feat}} ({{srchrsltsctrl.aantalFeaturesMetType(feat)}})</option>\n</select>\n</div>\n</div>\n<div class="overflow-wrapper margin-top">\n<ul ng-repeat="layerGroupName in srchrsltsctrl.featureLayers">\n<tink-accordion ng-if="srchrsltsctrl.layerGroupFilter==\'geenfilter\' || srchrsltsctrl.layerGroupFilter==layerGroupName " data-one-at-a-time=false>\n<div class="tink-accordion-panel xl-panel" ng-show="srchrsltsctrl.aantalFeaturesMetType(layerGroupName) >= 1000">\n<data-header>\n<p class=nav-aside-title style="pointer-events: none; align-content: center">{{layerGroupName}} ({{srchrsltsctrl.aantalFeaturesMetType(layerGroupName)}})\n<button prevent-default ng-click=srchrsltsctrl.deleteFeatureGroup(layerGroupName) class="trash pull-right trash-xl" style=pointer-events:all></button>\n</p>\n</data-header>\n<data-content ng-show="srchrsltsctrl.aantalFeaturesMetType(layerGroupName) <= 1000">\n<li ng-repeat="feature in srchrsltsctrl.features | filter: { layerName:layerGroupName } :true" ng-mouseover=srchrsltsctrl.HoverOver(feature)>\n<div class=mouse-over>\n<a tink-tooltip={{feature.displayValue}} tink-tooltip-align=top ng-click=srchrsltsctrl.showDetails(feature)>{{ feature.displayValue| limitTo : 40 }}\n</a>\n<button class="trash pull-right mouse-over-toshow" prevent-default ng-click=srchrsltsctrl.deleteFeature(feature)></button>\n</div>\n</li>\n</data-content>\n</div>\n<tink-accordion-panel data-is-collapsed=srchrsltsctrl.collapsestatepergroup[layerGroupName] ng-show="srchrsltsctrl.aantalFeaturesMetType(layerGroupName) <= 1000">\n<data-header>\n<p class=nav-aside-title>{{layerGroupName}} ({{srchrsltsctrl.aantalFeaturesMetType(layerGroupName)}})\n<button prevent-default ng-click=srchrsltsctrl.deleteFeatureGroup(layerGroupName) class="trash pull-right"></button>\n</p>\n</data-header>\n<data-content ng-show="srchrsltsctrl.aantalFeaturesMetType(layerGroupName) <= 1000">\n<li ng-repeat="feature in srchrsltsctrl.features | filter: { layerName:layerGroupName } :true" ng-mouseover=srchrsltsctrl.HoverOver(feature)>\n<div class=mouse-over>\n<a tink-tooltip={{feature.displayValue}} tink-tooltip-align=top ng-click=srchrsltsctrl.showDetails(feature)>{{ feature.displayValue| limitTo : 40 }}\n</a>\n<button class="trash pull-right mouse-over-toshow" prevent-default ng-click=srchrsltsctrl.deleteFeature(feature)></button>\n</div>\n</li>\n</data-content>\n</tink-accordion-panel>\n</tink-accordion>\n</ul>\n</div>\n</div>\n</div>'),$templateCache.put("templates/search/searchSelectedTemplate.html",'<div class="SEARCHSELECTED flex-column flex-grow-1 extra-padding" ng-if=srchslctdctrl.selectedResult>\n<div class="margin-top margin-bottom">\n<div class="col-xs-12 text-right">\n<button class=btn tink-tooltip=Doordruk tink-tooltip-align=top ng-click=srchslctdctrl.doordruk() ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\' || srchslctdctrl.mobile">\n<svg class="icon icon-sik-press-through"><use xlink:href=#icon-sik-press-through></use></svg>\n</button>\n<button class=btn tink-tooltip=Buffer tink-tooltip-align=top ng-click=srchslctdctrl.buffer() ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\' || srchslctdctrl.mobile">\n<svg class="icon icon-sik-buffer"><use xlink:href=#icon-sik-buffer></use></svg>\n</button>\n<button class=btn tink-tooltip="Exporteer naar CSV" tink-tooltip-align=top ng-if=srchslctdctrl.exportToCSVButtonIsEnabled ng-click=srchslctdctrl.exportToCSV()>\n<svg class="icon icon-sik-file-csv"><use xlink:href=#icon-sik-file-csv></use></svg>\n</button>\n<button class=btn tink-tooltip=Verwijderen tink-tooltip-align=top ng-click=srchslctdctrl.delete()>\n<i class="fa fa-trash-o"></i>\n</button>\n</div>\n</div>\n<div class="col-xs-12 overflow-wrapper flex-grow-1">\n<dl ng-repeat="prop in srchslctdctrl.props">\n<dt>{{ prop.key}}</dt>\n<div ng-if="prop.value.toLowerCase() != \'null\'">\n<a ng-if="prop.value.indexOf(\'https://\')==0 || prop.value.indexOf( \'http://\')==0 " ng-href={{prop.value}} target=_blank>% Link</a>\n<dd ng-if="prop.value.indexOf(\'https://\') !=0 && prop.value.indexOf( \'http://\') !=0 "><pre>{{ prop.value }}</pre></dd>\n</div>\n</dl>\n</div>\n<div class=margin-top>\n<div class=col-xs-12>\n<div class=btn-group>\n<button type=button class=btn ng-disabled=!srchslctdctrl.prevResult ng-click=srchslctdctrl.vorige()>\n<i class="fa fa-chevron-left"></i>\n</button>\n<button type=button class=btn ng-disabled=!srchslctdctrl.nextResult ng-click=srchslctdctrl.volgende()>\n<i class="fa fa-chevron-right"></i>\n</button>\n</div>\n<button class="btn-primary pull-right" ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\'" ng-click=srchslctdctrl.toonFeatureOpKaart()>Tonen</button>\n</div>\n<div class="col-xs-12 margin-top margin-bottom">\n<a class=pull-right ng-click=srchslctdctrl.close(srchslctdctrl.selectedResult)>Terug naar resultaten</a>\n</div>\n</div>\n</div>\n'),$templateCache.put("templates/search/searchTemplate.html",'<div data-tink-nav-aside="" id=leftaside data-auto-select=true data-toggle-id=asideNavLeft class="nav-aside nav-left">\n<aside class="flex-column flex-grow-1">\n<div class=buffer-panel ng-show="srchrsltsctrl.drawLayer && !srchrsltsctrl.selectedResult">\n<div class=nav-aside-section>\n<p class=nav-aside-title>\nSelectievorm\n</p>\n</div>\n<div class="row extra-padding margin-top">\n<div class="col-xs-12 text-right">\n<button ng-click=srchrsltsctrl.deleteDrawing() tink-tooltip="Verwijder de selectievorm" tink-tooltip-align=right class=btn><i class="fa fa-trash" aria-hidden=true></i></button>\n<button ng-hide=srchrsltsctrl.mobile class=btn ng-click=srchrsltsctrl.bufferFromDrawing() tink-tooltip="Buffer rond selectievorm" tink-tooltip-align=right>\n<svg class="icon icon-sik-buffer"><use xlink:href=#icon-sik-buffer></use></svg>\n</button>\n<button class="btn btn-primary" ng-click=srchrsltsctrl.zoom2Drawing()>Tonen</button>\n</div>\n</div>\n</div>\n<div class=nav-aside-section>\n<p class=nav-aside-title>Resultaten</p>\n</div>\n<button ng-click=srchctrl.asidetoggle class=nav-left-toggle data-tink-sidenav-collapse=asideNavLeft>\n<a href=# title="Open menu"><span class=sr-only>Open left menu</span></a>\n</button>\n<div class="flex-column flex-grow-1" ng-show=srchctrl.LoadingCompleted>\n<tink-search-results></tink-search-results>\n<tink-search-selected></tink-search-selected>\n</div>\n<div class="loader-advanced center-block margin-top margin-bottom" ng-show="srchctrl.LoadingCompleted == false">\n<span class=loader></span>\n<span class=loader-percentage>{{srchctrl.loadingPercentage}}%</span>\n</div>\n</aside>\n</div>\n')}]);var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}!function(TinkGis){var LayerJSON=function LayerJSON(){_classCallCheck(this,LayerJSON)};TinkGis.LayerJSON=LayerJSON;var Layer=function(_LayerJSON){function Layer(){_classCallCheck(this,Layer);var _this=_possibleConstructorReturn(this,(Layer.__proto__||Object.getPrototypeOf(Layer)).apply(this,arguments));return _this.parent=null,_this.Layers=[],_this.UpdateDisplayed=function(currentScale){(0<_this.maxScale||0<_this.minScale)&&(currentScale>=_this.maxScale&&currentScale<=_this.minScale?_this.displayed=!0:_this.displayed=!1)},_this.toString=function(){return"Lay: (id: "+_this.name+")"},_this}return _inherits(Layer,LayerJSON),_createClass(Layer,[{key:"hasLayers",get:function(){return!!this.Layers&&0<this.Layers.length}},{key:"ShouldBeVisible",get:function(){return!(!this.IsEnabledAndVisible||this.hasLayers||this.parent&&!this.parent.IsEnabledAndVisible)}},{key:"IsEnabledAndVisible",get:function(){return!!(this.theme.enabled&&this.enabled&&this.visible)&&(!this.parent||this.parent.IsEnabledAndVisible)}},{key:"AllLayers",get:function(){var allLay=this.Layers;return this.Layers.forEach(function(lay){allLay=allLay.concat(lay.AllLayers)}),allLay}}]),Layer}();TinkGis.Layer=Layer;var wmslayer=function(_Layer){function wmslayer(layerData,parenttheme){_classCallCheck(this,wmslayer);var _this2=_possibleConstructorReturn(this,(wmslayer.__proto__||Object.getPrototypeOf(wmslayer)).call(this));return Object.assign(_this2,layerData),_this2.visible=!0,_this2.enabled=!1,_this2.displayed=!0,_this2.theme=parenttheme,_this2.queryable=layerData.queryable,_this2.id=_this2.name,_this2}return _inherits(wmslayer,Layer),_createClass(wmslayer,[{key:"legendUrl",get:function(){return this.theme.cleanUrl+"?Service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER="+this.id}}]),wmslayer}();TinkGis.wmslayer=wmslayer;var argislegend=function argislegend(label,url){_classCallCheck(this,argislegend),this.label=label,this.url=url};TinkGis.argislegend=argislegend;var arcgislayer=function(_Layer2){function arcgislayer(layerData,parenttheme){_classCallCheck(this,arcgislayer);var _this3=_possibleConstructorReturn(this,(arcgislayer.__proto__||Object.getPrototypeOf(arcgislayer)).call(this));return Object.assign(_this3,layerData),_this3.visible=layerData.defaultVisibility,_this3.enabled=!1,_this3.title=layerData.name,_this3.theme=parenttheme,_this3.displayed=!0,_this3.queryable=!1,_this3}return _inherits(arcgislayer,Layer),_createClass(arcgislayer,[{key:"legends",get:function(){return this.legend.map(function(x){return new argislegend(x.label,x.fullurl)})}}]),arcgislayer}();TinkGis.arcgislayer=arcgislayer}(TinkGis||(TinkGis={}));var TinkGis;_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}!function(TinkGis){var Theme=function(){function Theme(){var _this=this;_classCallCheck(this,Theme),this.Layers=[],this.UpdateDisplayed=function(currentScale){_this.EnabledLayers.forEach(function(layer){console.log("updating displayed status for layer: ",layer),layer.UpdateDisplayed(currentScale)})}}return _createClass(Theme,[{key:"VisibleLayers",get:function(){return this.Visible?this.AllLayers.filter(function(x){return x.ShouldBeVisible}):[]}},{key:"VisibleAndDisplayedLayerIds",get:function(){return this.Visible?this.AllLayers.filter(function(x){return x.ShouldBeVisible&&x.displayed}).map(function(x){return x.id}):[]}},{key:"EnabledLayers",get:function(){return this.Visible?this.AllLayers.filter(function(x){return x.enabled}):[]}},{key:"VisibleLayerIds",get:function(){return this.VisibleLayers.map(function(x){return x.id})}},{key:"AllLayers",get:function(){var allLay=this.Layers;return this.Layers.forEach(function(lay){allLay=allLay.concat(lay.AllLayers)}),allLay}}]),Theme}();TinkGis.Theme=Theme;var ArcGIStheme=function(_Theme){function ArcGIStheme(rawdata,themeData){_classCallCheck(this,ArcGIStheme);var _this2=_possibleConstructorReturn(this,(ArcGIStheme.__proto__||Object.getPrototypeOf(ArcGIStheme)).call(this)),urlParts=themeData.cleanUrl.split("/"),nameFromUrl=2<urlParts.length?urlParts[urlParts.length-2]:"",rawlayers=rawdata.layers;_this2.name=_this2.Naam=""===rawdata.documentInfo.Title?nameFromUrl:rawdata.documentInfo.Title,_this2.Description=rawdata.documentInfo.Subject,_this2.cleanUrl=themeData.cleanUrl,_this2.Opacity=themeData.opacity,_this2.Url=themeData.cleanUrl,_this2.Visible=!0,_this2.Added=!1,_this2.enabled=!0,_this2.Type=ThemeType.ESRI,_this2.status=ThemeStatus.UNMODIFIED,_this2.MapData={};var convertedLayers=rawlayers.map(function(x){return new TinkGis.arcgislayer(x,_this2)});return convertedLayers.forEach(function(argislay){if(-1===argislay.parentLayerId)_this2.Layers.push(argislay);else{var parentlayer=convertedLayers.find(function(x){return x.id===argislay.parentLayerId});(argislay.parent=parentlayer).Layers.push(argislay)}}),_this2}return _inherits(ArcGIStheme,Theme),_createClass(ArcGIStheme,[{key:"UpdateMap",value:function(){0!==this.VisibleLayerIds.length?this.MapData.setLayers(this.VisibleLayerIds):this.MapData.setLayers([-1])}},{key:"SetOpacity",value:function(opacity){this.Opacity=opacity,this.MapData.setOpacity(opacity)}}]),ArcGIStheme}();TinkGis.ArcGIStheme=ArcGIStheme;var wmstheme=function(_Theme2){function wmstheme(data,url){_classCallCheck(this,wmstheme);var _this3=_possibleConstructorReturn(this,(wmstheme.__proto__||Object.getPrototypeOf(wmstheme)).call(this));_this3.Version=data.version,_this3.name=_this3.Naam=data.service.title,_this3.enabled=!0,_this3.Visible=!0,_this3.cleanUrl=url,_this3.Added=!1,_this3.status=ThemeStatus.NEW,_this3.Description=data.service.abstract,_this3.Type=ThemeType.WMS;var layers=data.capability.layer;layers.layer&&(layers=layers.layer),layers.layer&&(layers=layers.layer);var lays=[];if(layers)if(void 0===layers.length)lays.push(layers);else{var tempLayers=[];layers.forEach(function(element){element.layer?tempLayers=[].concat(_toConsumableArray(tempLayers),_toConsumableArray(element.layer)):tempLayers.push(element)}),lays=tempLayers}else lays.push(data.capability.layer);return lays.forEach(function(layer){1==layer.queryable&&(data.capability.request.getfeatureinfo.format.some(function(x){return"text/xml"===x})?_this3.GetFeatureInfoType="text/xml":data.capability.request.getfeatureinfo.format.some(function(x){return"text/plain"===x})&&(_this3.GetFeatureInfoType="text/plain"),_this3.GetFeatureInfoType||(layer.queryable=!1));var lay=new TinkGis.wmslayer(layer,_this3);_this3.Layers.push(lay)}),_this3}return _inherits(wmstheme,Theme),_createClass(wmstheme,[{key:"UpdateMap",value:function(map){0!==this.VisibleLayerIds.length?(map.hasLayer(this.MapData)||map.addLayer(this.MapData),this.MapData.options.layers=this.MapData.wmsParams.layers=this.VisibleLayerIds.join(","),this.MapData.redraw()):map.hasLayer(this.MapData)&&map.removeLayer(this.MapData)}}]),wmstheme}();TinkGis.wmstheme=wmstheme}(TinkGis||(TinkGis={})),function(TinkGis){angular.module("tink.gis").factory("ThemeCreater",function(){var ThemeCreater={createARCGISThemeFromJson:function(rawdata,themeData){return new TinkGis.ArcGIStheme(rawdata,themeData)},createWMSThemeFromJSON:function(data,url){return new TinkGis.wmstheme(data,url)}};return ThemeCreater})}(TinkGis||(TinkGis={}));
//# sourceMappingURL=tink-gis-angular.min.js.map