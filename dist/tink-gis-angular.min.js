/*! tink-gis-angular v1.0.0 */
"use strict";!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.constant("appConfig",{templateUrl:"/digipolis.stadinkaart.webui",apiUrl:"/digipolis.stadinkaart.api/",enableDebug:!0,enableLog:!0}),module.directive("preventDefault",function(){return function(scope,element,attrs){angular.element(element).bind("click",function(event){event.preventDefault(),event.stopPropagation()}),angular.element(element).bind("dblclick",function(event){event.preventDefault(),event.stopPropagation()}),angular.element(element).bind("ondrag",function(event){event.preventDefault(),event.stopPropagation()}),angular.element(element).bind("ondragstart",function(event){event.preventDefault(),event.stopPropagation()})}}),JXON.config({attrPrefix:"",autoDate:!1});var mapObject=(function(){L.AwesomeMarkers.Icon.prototype.options.prefix="fa"}(),function(){var crsLambert=new L.Proj.CRS("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs",{origin:[-35872700,41422700],resolutions:[66.1459656252646,52.91677250021167,39.687579375158755,26.458386250105836,13.229193125052918,6.614596562526459,5.291677250021167,3.9687579375158752,3.3072982812632294,2.6458386250105836,1.9843789687579376,1.3229193125052918,.6614596562526459,.5291677250021167,.39687579375158755,.33072982812632296,.26458386250105836,.19843789687579377,.13229193125052918,.06614596562526459,.026458386250105836]}),map=L.map("map",{crs:crsLambert,zoomControl:!1,drawControl:!1}).setView([51.2192159,4.4028818],5);map.doubleClickZoom.disable();var drawnItems=L.featureGroup().addTo(map);return map.on("draw:created",function(event){var layer=event.layer;drawnItems.addLayer(layer)}),map.on("draw:drawstart",function(event){}),map.clearDrawings=function(){console.log("clearingDrawings"),console.log(drawnItems),drawnItems.clearLayers()},map});module.factory("map",mapObject)}();var ThemeStatus={UNMODIFIED:0,NEW:1,UPDATED:2,DELETED:3},LayerType={LAYER:0,GROUP:1},ActiveInteractieButton={IDENTIFY:"identify",SELECT:"select",METEN:"meten",WATISHIER:"watishier"},DrawingOption={NIETS:"",AFSTAND:"afstand",OPPERVLAKTE:"oppervlakte",LIJN:"lijn",VIERKANT:"vierkant",POLYGON:"polygon"},ThemeType={ESRI:"esri",WMS:"wms"},Style={DEFAULT:{fillOpacity:0,color:"blue",weight:5},HIGHLIGHT:{weight:7,color:"red",fillOpacity:.5}},Scales=[25e4,2e5,15e4,1e5,5e4,25e3,2e4,15e3,12500,1e4,7500,5e3,2500,2e3,1500,1250,1e3,750,500,250,100];!function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("geoPuntController",["$scope","ThemeHelper","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService",function($scope,ThemeHelper,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService){$scope.searchIsUrl=!1,$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.EnabledThemes.length=0,LayerManagementService.AvailableThemes.length=0,LayerManagementService.EnabledThemes=angular.copy(MapData.Themes),$scope.availableThemes=[];(function(){$scope.searchTerm="",$scope.searchIsUrl=!1})();$scope.searchChanged=function(){null!=$scope.searchTerm&&""!=$scope.searchTerm&&$scope.searchTerm.length>2?($scope.clearPreview(),$scope.searchTerm.startsWith("http")?$scope.searchIsUrl=!0:($scope.searchIsUrl=!1,$scope.QueryGeoPunt($scope.searchTerm,1))):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0)},$scope.QueryGeoPunt=function(searchTerm,page){var prom=GeopuntService.getMetaData(searchTerm,5*(page-1)+1,5);prom.then(function(metadata){$scope.availableThemes=metadata.results,$scope.currentrecord=metadata.currentrecord,$scope.nextrecord=metadata.nextrecord,$scope.numberofrecordsmatched=metadata.numberofrecordsmatched,console.log(metadata)},function(reason){console.log(reason)})},$scope.pageChanged=function(page,recordsAPage){$scope.QueryGeoPunt($scope.searchTerm,page)},$scope.laadUrl=function(){if($scope.searchTerm=$scope.searchTerm.trim().replace("?",""),void 0==MapData.Themes.find(function(x){return x.CleanUrl==$scope.searchTerm})){var getwms=WMSService.GetCapabilities($scope.searchTerm);getwms.success(function(data,status,headers,config){$scope.previewTheme(data)}).error(function(data,status,headers,config){$window.alert("error")})}else alert("Deze is al toegevoegd aan de map.")},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){console.log("themeChanged"),console.log(theme),$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null},$scope.geopuntThemeChanged=function(theme){console.log(theme);var url=theme.Url.trim().replace("?","");if(void 0==MapData.Themes.find(function(x){return x.CleanUrl==url})){var getwms=WMSService.GetCapabilities(url);getwms.success(function(data,status,headers,config){$scope.previewTheme(data)}).error(function(data,status,headers,config){$window.alert("error")})}else alert("Deze is al toegevoegd aan de map.")},$scope.AddOrUpdateTheme=function(){console.log("AddOrUpdateTheme");for(var allChecked=!0,noneChecked=!0,x=0;x<$scope.copySelectedTheme.AllLayers.length;x++){var copyLayer=$scope.copySelectedTheme.AllLayers[x],realLayer=$scope.selectedTheme.AllLayers[x];realLayer.enabled=copyLayer.enabled,copyLayer.enabled===!1?allChecked=!1:noneChecked=!1}var alreadyAdded=void 0!=LayerManagementService.EnabledThemes.find(function(x){return x.CleanUrl===$scope.selectedTheme.CleanUrl});if(noneChecked){if($scope.selectedTheme.Added=!1,$scope.selectedTheme.status!=ThemeStatus.NEW)$scope.selectedTheme.status=ThemeStatus.DELETED;else if(alreadyAdded){var index=LayerManagementService.EnabledThemes.indexOf($scope.selectedTheme);index>-1&&LayerManagementService.EnabledThemes.splice(index,1)}}else allChecked?$scope.selectedTheme.Added=!0:$scope.selectedTheme.Added=null,0==alreadyAdded?LayerManagementService.EnabledThemes.push($scope.selectedTheme):$scope.selectedTheme.status!=ThemeStatus.NEW?($scope.selectedTheme.status=ThemeStatus.UPDATED,console.log("changed naar updated")):console.log("Hij is al new, dus moet hij niet naar updated changen.");console.log("AddOrUpdateTheme"),$scope.selectedTheme=null,$scope.copySelectedTheme=null},$scope.ok=function(){console.log(LayerManagementService.EnabledThemes),$modalInstance.$close(LayerManagementService.EnabledThemes)},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("LayerManagerController",["$scope","$modalInstance","LayerManagementService",function($scope,$modalInstance,LayerManagementService){$scope.ok=function(){$modalInstance.$close(LayerManagementService.EnabledThemes)},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("solrGISController",["$scope","ThemeHelper","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService",function($scope,ThemeHelper,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService){$scope.searchIsUrl=!1,$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.EnabledThemes.length=0,LayerManagementService.AvailableThemes.length=0,LayerManagementService.EnabledThemes=angular.copy(MapData.Themes),$scope.availableThemes=[];(function(){$scope.searchTerm="",$scope.searchIsUrl=!1})();$scope.searchChanged=function(){null!=$scope.searchTerm&&""!=$scope.searchTerm&&$scope.searchTerm.length>2?($scope.clearPreview(),$scope.searchTerm.startsWith("http")?$scope.searchIsUrl=!0:($scope.searchIsUrl=!1,$scope.QueryGISSOLR($scope.searchTerm,1))):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0)},$scope.QueryGISSOLR=function(searchterm,page){var prom=GISService.QuerySOLRGIS(searchterm,5*(page-1)+1,5);prom.then(function(data){var items=data.data.response.docs;$scope.availableThemes=items,console.log(data)},function(reason){console.log(reason)})},$scope.pageChanged=function(page,recordsAPage){$scope.QueryGISSOLR($scope.searchTerm,page)},$scope.laadUrl=function(){if($scope.searchTerm=$scope.searchTerm.trim().replace("?",""),void 0==MapData.Themes.find(function(x){return x.CleanUrl==$scope.searchTerm})){var getwms=WMSService.GetCapabilities($scope.searchTerm);getwms.success(function(data,status,headers,config){$scope.previewTheme(data)}).error(function(data,status,headers,config){$window.alert("error")})}else alert("Deze is al toegevoegd aan de map.")},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){console.log("themeChanged"),console.log(theme),$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null},$scope.geopuntThemeChanged=function(theme){var url=theme.url.trim().replace("?",""),lastslash=url.lastIndexOf("/");url=url.substring(0,lastslash),GISService.GetThemeData(url).success(function(data,statuscode,functie,getdata){var convertedTheme=ThemeHelper.createThemeFromJson(data,getdata);$scope.previewTheme(convertedTheme)})},$scope.AddOrUpdateTheme=function(){console.log("AddOrUpdateTheme");for(var allChecked=!0,noneChecked=!0,x=0;x<$scope.copySelectedTheme.AllLayers.length;x++){var copyLayer=$scope.copySelectedTheme.AllLayers[x],realLayer=$scope.selectedTheme.AllLayers[x];realLayer.enabled=copyLayer.enabled,copyLayer.enabled===!1?allChecked=!1:noneChecked=!1}var alreadyAdded=void 0!=LayerManagementService.EnabledThemes.find(function(x){return x.CleanUrl===$scope.selectedTheme.CleanUrl});if(noneChecked){if($scope.selectedTheme.Added=!1,$scope.selectedTheme.status!=ThemeStatus.NEW)$scope.selectedTheme.status=ThemeStatus.DELETED;else if(alreadyAdded){var index=LayerManagementService.EnabledThemes.indexOf($scope.selectedTheme);index>-1&&LayerManagementService.EnabledThemes.splice(index,1)}}else allChecked?$scope.selectedTheme.Added=!0:$scope.selectedTheme.Added=null,0==alreadyAdded?LayerManagementService.EnabledThemes.push($scope.selectedTheme):$scope.selectedTheme.status!=ThemeStatus.NEW?($scope.selectedTheme.status=ThemeStatus.UPDATED,console.log("changed naar updated")):console.log("Hij is al new, dus moet hij niet naar updated changen.");console.log("AddOrUpdateTheme"),$scope.selectedTheme=null,$scope.copySelectedTheme=null},$scope.ok=function(){console.log(LayerManagementService.EnabledThemes),$modalInstance.$close(LayerManagementService.EnabledThemes)},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){module=angular.module("tink.gis"),module.directive("geoPunt",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/geoPuntTemplate.html",controller:"geoPuntController",controllerAs:"geoPuntctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("solrGis",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/solrGISTemplate.html",controller:"solrGISController",controllerAs:"solrGISctrl"}})}(),function(){var module=angular.module("tink.gis"),service=function($http,map,MapData,$rootScope,$q){var _service={};return _service.getMetaData=function(){var searchterm=arguments.length<=0||void 0===arguments[0]?"water":arguments[0],startpos=arguments.length<=1||void 0===arguments[1]?1:arguments[1],recordsAPage=arguments.length<=2||void 0===arguments[2]?10:arguments[2],url="https://metadata.geopunt.be/zoekdienst/srv/dut/csw?service=CSW&version=2.0.2&request=GetRecords&namespace=xmlns%28csw=http://www.opengis.net/cat/csw%29&resultType=results&outputSchema=http://www.opengis.net/cat/csw/2.0.2&outputFormat=application/xml&startPosition="+startpos+"&maxRecords="+recordsAPage+"&typeNames=csw:Record&elementSetName=full&constraintLanguage=CQL_TEXT&constraint_language_version=1.1.0&constraint=AnyText+LIKE+%27%25"+searchterm+"%25%27AND%20Type%20=%20%27service%27%20AND%20Servicetype%20=%27view%27&sortBy=title";console.log("GETTING METADATA WITH ULR:",url);var prom=$q.defer();return $http.get(url).success(function(data,status,headers,config){if(data){var returnjson=JXON.stringToJs(data),getResults=returnjson["csw:getrecordsresponse"]["csw:searchresults"],returnObject={};returnObject.searchTerm=searchterm,returnObject.currentrecord=startpos,returnObject.recordsAPage=recordsAPage,returnObject.nextrecord=getResults.nextrecord,returnObject.numberofrecordsmatched=getResults.numberofrecordsmatched,returnObject.numberofrecordsreturned=getResults.numberofrecordsreturned,returnObject.results=[],0!=returnObject.numberofrecordsmatched&&getResults["csw:record"].forEach(function(record){if(record["dc:uri"]instanceof Array==0){var tmpdata=record["dc:uri"];record["dc:uri"]=[],record["dc:uri"].push(tmpdata)}var tmptheme={};tmptheme.Added=!1,tmptheme.Naam=record["dc:title"];var wmsinfo=record["dc:uri"].find(function(x){return"WMS"==x.protocol||"OGC:WMS"==x.protocol});wmsinfo?(tmptheme.Url=wmsinfo.keyValue,tmptheme.Type=ThemeType.WMS):tmptheme.Type="DONTKNOW",tmptheme.TMPMETADATA=record,returnObject.results.push(tmptheme)}),prom.resolve(returnObject)}else prom.reject(null),console.log("EMPTY RESULT")}).error(function(data,status,headers,config){prom.reject(null),console.log("ERROR!",data,status,headers,config)}),prom.promise},_service};module.$inject=["$http","map","MapData","$rootScope","$q"],module.factory("GeopuntService",service)}(),function(){var module=angular.module("tink.gis"),service=function(MapData,$http,$q,GISService,ThemeHelper){var _service={};return _service.EnabledThemes=[],_service.AvailableThemes=[],_service.ProcessUrls=function(urls){var promises=[];return _.each(urls,function(url){var AlreadyAddedTheme=null;if(_service.EnabledThemes.forEach(function(theme){theme.CleanUrl==url&&(AlreadyAddedTheme=theme)}),null==AlreadyAddedTheme){var prom=GISService.GetThemeData(url+"?f=pjson");prom.success(function(data,statuscode,functie,getdata){var convertedTheme=ThemeHelper.createThemeFromJson(data,getdata);_service.AvailableThemes.push(convertedTheme),convertedTheme.status=ThemeStatus.NEW}),promises.push(prom)}else AlreadyAddedTheme.status=ThemeStatus.UNMODIFIED,_service.AvailableThemes.push(AlreadyAddedTheme)}),$q.all(promises)},_service.GetAditionalLayerInfo=function(theme){var promLegend=GISService.GetLegendData(theme.CleanUrl);promLegend.success(function(data,statuscode,functie,getdata){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.layerId==layerid});layer.legend=[],layerInfo&&(layer.legend=layerInfo.legend,layer.legend.forEach(function(legenditem){legenditem.fullurl=theme.CleanUrl+"/"+layerInfo.layerId+"/images/"+legenditem.url}))})});var promLayerData=GISService.GetThemeLayerData(theme.CleanUrl);promLayerData.success(function(data,statuscode,functie,getdata){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.id==layerid});layer.displayField=layerInfo.displayField,layer.fields=layerInfo.fields})})},_service};module.$inject=["MapData","$http","$q","GISService","ThemeHelper"],module.factory("LayerManagementService",service)}(),function(module){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}module=angular.module("tink.gis"),module.controller("groupLayerController",function($scope){var vm=this;vm.grouplayer=$scope.grouplayer,vm.chkChanged=function(){$scope.$emit("groupCheckboxChangedEvent",$scope.grouplayer)}})}(),function(module){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var theController=module.controller("layerController",function($scope){var vm=this;vm.layer=$scope.layer,vm.chkChanged=function(){$scope.$emit("layerCheckboxChangedEvent",$scope.layer)}});theController.$inject=[]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("layersController",function($scope,MapData,map,ThemeService,$modal){var vm=this;vm.themes=MapData.Themes,vm.selectedLayers=[],vm.sortableOptions={stop:function(e,ui){MapData.SetZIndexes()}},$scope.$watch(function(){return MapData.Themes},function(newVal,oldVal){console.log("WATCH OP MAPDATATHEMES IN LAYERSCONTROLLER"),MapData.SetZIndexes(newVal)}),vm.AddLayers=function(){var addLayerInstance=$modal.open({templateUrl:"templates/layermanagement/layerManagerTemplate.html",controller:"LayerManagerController",resolve:{backdrop:!1,keyboard:!0}});addLayerInstance.result.then(function(selectedThemes){ThemeService.AddAndUpdateThemes(selectedThemes)},function(obj){console.log("Modal dismissed at: "+new Date)})}});theController.$inject=["MapData","map","ThemeService","$modal"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("mapController",function($scope,BaseLayersService,MapService,MapData,map,MapEvents,DrawService,HelperService){var vm=this;vm.layerId="",vm.activeInteractieKnop=MapData.ActiveInteractieKnop,vm.SelectableLayers=MapData.VisibleLayers,vm.selectedLayer=MapData.SelectedLayer,vm.drawingType=MapData.DrawingType,vm.showMetenControls=!1,vm.showDrawControls=!1,vm.interactieButtonChanged=function(ActiveButton){switch(MapData.CleanMap(),MapData.ActiveInteractieKnop=ActiveButton,vm.activeInteractieKnop=ActiveButton,vm.showMetenControls=!1,vm.showDrawControls=!1,ActiveButton){case ActiveInteractieButton.SELECT:vm.showDrawControls=!0,vm.selectpunt();break;case ActiveInteractieButton.METEN:vm.showMetenControls=!0,vm.drawingButtonChanged(DrawingOption.AFSTAND)}},vm.zoekEnter=function(search){search=search.trim();var WGS84Check=HelperService.getWGS84CordsFromString(search);if(WGS84Check.hasCordinates)map.setView(L.latLng(WGS84Check.X,WGS84Check.Y),12);else{var lambertCheck=HelperService.getLambartCordsFromString(search);if(lambertCheck.hasCordinates){var xyWGS84=HelperService.ConvertLambert72ToWSG84({x:lambertCheck.X,y:lambertCheck.Y});map.setView(L.latLng(xyWGS84.x,xyWGS84.y),12)}else console.log("NIET GEVONDEN")}},vm.zoekLocChanged=function(search){},vm.drawingButtonChanged=function(drawOption){MapData.CleanMap(),MapData.DrawingType=drawOption,vm.drawingType=drawOption,DrawService.StartDraw(drawOption)},vm.Loading=0,vm.MaxLoading=0,$scope.$watch(function(){return MapData.Loading},function(newVal,oldVal){vm.Loading=newVal,0==oldVal&&(vm.MaxLoading=newVal),vm.MaxLoading<oldVal&&(vm.MaxLoading=oldVal),0==newVal&&(vm.MaxLoading=0),console.log("MapLoading val: "+newVal+"/"+vm.MaxLoading)}),vm.selectpunt=function(){MapData.CleanMap(),MapData.DrawingType=DrawingOption.NIETS,vm.drawingType=DrawingOption.NIETS},vm.layerChange=function(){MapData.CleanMap(),MapData.SelectedLayer=vm.selectedLayer},vm.zoomIn=function(){map.zoomIn()},vm.zoomOut=function(){map.zoomOut()},vm.fullExtent=function(){map.setView(new L.LatLng(51.2192159,4.4028818),16)},vm.kaartIsGetoond=!0,vm.toonKaart=function(){vm.kaartIsGetoond=!0,map.removeLayer(BaseLayersService.luchtfoto),map.addLayer(BaseLayersService.kaart)},vm.toonLuchtfoto=function(){vm.kaartIsGetoond=!1,map.removeLayer(BaseLayersService.kaart),map.addLayer(BaseLayersService.luchtfoto)}});theController.$inject=["BaseLayersService","MapService","MapData","map","MapEvents","DrawService","HelperService"]}(),function(module){module=angular.module("tink.gis"),module.controller("themeController",["$scope","MapService","ThemeService",function($scope,MapService,ThemeService){var vm=this;console.log("Theme geladen"),vm.theme=$scope.theme,$scope.$on("groupCheckboxChangedEvent",function(event,groupLayer){MapService.UpdateGroupLayerStatus(groupLayer,vm.theme),ThemeService.UpdateThemeVisibleLayers(vm.theme)}),$scope.$on("layerCheckboxChangedEvent",function(event,layer){MapService.UpdateLayerStatus(layer,vm.theme),ThemeService.UpdateThemeVisibleLayers(vm.theme)}),vm.chkChanged=function(){MapService.UpdateThemeStatus(vm.theme),ThemeService.UpdateThemeVisibleLayers(vm.theme)},vm.deleteTheme=function(){swal({title:"Verwijderen?",text:"U staat op het punt om "+vm.theme.Naam+" te verwijderen.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Verwijder",closeOnConfirm:!0},function(){ThemeService.DeleteTheme(vm.theme),$scope.$apply()}),console.log(vm.theme)}}])}(),function(module){module=angular.module("tink.gis"),module.directive("tinkGrouplayer",function(){return{replace:!0,scope:{grouplayer:"="},templateUrl:"templates/other/groupLayerTemplate.html",controller:"groupLayerController",controllerAs:"grplyrctrl"}})}(),function(module){angular.module("tink.gis").directive("indeterminateCheckbox",[function(){return{scope:!0,require:"?ngModel",link:function(scope,element,attrs,modelCtrl){function watchChildrenListWithProperty(){return scope.$eval(childList).map(function(x){return x[property]})}var childList=attrs.childList,property=attrs.property;element.bind("change",function(){scope.$apply(function(){var isChecked=element.prop("checked");angular.forEach(scope.$eval(childList),function(child){child[property]=isChecked})})}),scope.$watch(watchChildrenListWithProperty,function(newValue,oldValue){if(newValue!==oldValue){var hasChecked=!1,hasUnchecked=!1;angular.forEach(newValue,function(child){child?hasChecked=!0:hasUnchecked=!0}),hasChecked&&hasUnchecked?(element.prop("checked",!0),element.prop("indeterminate",!0),modelCtrl&&modelCtrl.$setViewValue(!0)):(element.prop("checked",hasChecked),element.prop("indeterminate",!1),modelCtrl&&modelCtrl.$setViewValue(hasChecked))}},!0)}}}])}(),function(module){module=angular.module("tink.gis"),module.directive("tinkLayer",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/other/layerTemplate.html",controller:"layerController",controllerAs:"lyrctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkLayers",function(){return{replace:!0,templateUrl:"templates/other/layersTemplate.html",controller:"layersController",controllerAs:"lyrsctrl"}})}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.directive("tinkMap",function(){return{replace:!0,templateUrl:"templates/other/mapTemplate.html",controller:"mapController",controllerAs:"mapctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkTheme",function(){return{replace:!0,scope:{theme:"="},templateUrl:"templates/other/themeTemplate.html",controller:"themeController",controllerAs:"thmctrl"}})}(),function(){var module=angular.module("tink.gis"),service=function($http,map,MapData,HelperService){var _service={};_service.ReverseGeocode=function(event){var lambert72Cords=HelperService.ConvertWSG84ToLambert72(event.latlng),loc=lambert72Cords.x+","+lambert72Cords.y,urlloc=encodeURIComponent(loc);MapData.CleanWatIsHier(),$http.get("http://app10.p.gis.local/arcgissql/rest/services/COMLOC_CRAB_NAVTEQ/GeocodeServer/reverseGeocode?location="+urlloc+"&distance=50&outSR=&f=json").success(function(data,status,headers,config){data.error?MapData.CreateOrigineleMarker(event.latlng,!1):(MapData.CreateWatIsHierMarker(data),console.log(data),MapData.CreateOrigineleMarker(event.latlng,!0))}).error(function(data,status,headers,config){console.log("ERROR!",status,headers,data)})},_service.QuerySOLRGIS=function(searchterm){var prom=$http.get("http://esb-app1-o.antwerpen.be/v1/giszoek/solr/search?q=*"+searchterm+"*&wt=json&indent=true");return prom};var baseurl="http://app10.p.gis.local/arcgissql/rest/";return _service.GetThemeData=function(mapserver){var prom=$http.get(baseurl+mapserver+"?f=pjson");return prom},_service.GetThemeLayerData=function(cleanurl){var prom=$http.get(cleanurl+"/layers?f=pjson");return prom},_service.GetLegendData=function(cleanurl){var prom=$http.get(cleanurl+"/legend?f=pjson");return prom},_service};module.$inject=["$http","map","MapData","HelperService","$rootScope"],module.factory("GISService",service)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}var service=function($http,$window,map){var _service={};return _service.GetCapabilities=function(url){var posturl="?request=GetCapabilities&service=WMS&callback=foo",prom=$http({method:"GET",url:url+posturl,timeout:1e4,transformResponse:function(data){var wmstheme={};if(data){var returnjson=JXON.stringToJs(data).wms_capabilities;console.log(returnjson),wmstheme.Version=returnjson.version,wmstheme.name=returnjson.service.title,wmstheme.Naam=returnjson.service.title,wmstheme.enabled=!0,wmstheme.Visible=!0,wmstheme.Layers=[],wmstheme.AllLayers=[],wmstheme.Groups=[],wmstheme.CleanUrl=url,wmstheme.Added=!1,wmstheme.status=ThemeStatus.NEW,wmstheme.Description=returnjson.service.abstract,wmstheme.Type=ThemeType.WMS,wmstheme.VisibleLayerIds=[],wmstheme.VisibleLayers=[];var createLayer=function(layer){var tmplayer={};tmplayer.visible=!0,tmplayer.enabled=!0,tmplayer.parent=null,tmplayer.displayed=!0,tmplayer.theme=wmstheme,tmplayer.name=layer.name,tmplayer.title=layer.title,tmplayer.queryable=layer.queryable,tmplayer.type=LayerType.LAYER,tmplayer.id=layer.name,wmstheme.Layers.push(tmplayer),wmstheme.AllLayers.push(tmplayer)},layers=returnjson.capability.layer.layer;layers?void 0!=layers.length?layers.forEach(function(layer){createLayer(layer)}):createLayer(layers):createLayer(returnjson.capability.layer),wmstheme.UpdateMap=function(){wmstheme.RecalculateVisibleLayerIds(),map.removeLayer(wmstheme.MapData),map.addLayer(wmstheme.MapData)},wmstheme.RecalculateVisibleLayerIds=function(){wmstheme.VisibleLayerIds.length=0,_.forEach(wmstheme.VisibleLayers,function(visLayer){wmstheme.VisibleLayerIds.push(visLayer.id)}),0===wmstheme.VisibleLayerIds.length&&wmstheme.VisibleLayerIds.push(-1)},wmstheme.RecalculateVisibleLayerIds()}return wmstheme}}).success(function(data,status,headers,config){console.dir(data)}).error(function(data,status,headers,config){console.log("error: data, status, headers, config:"),console.log(data),console.log(status),console.log(headers),console.log(config),$window.alert("error")});return prom},_service};module.factory("WMSService",service)}(),function(){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var baseLayersService=function(map){var _baseLayersService={};return _baseLayersService.kaart=L.esri.tiledMapLayer({url:"http://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/P_basemap/MapServer",maxZoom:19,minZoom:0,continuousWorld:!0}),_baseLayersService.luchtfoto=L.esri.tiledMapLayer({url:"http://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/Luchtfoto_2015/MapServer",maxZoom:19,minZoom:0,continuousWorld:!0}),_baseLayersService.kaart.addTo(map),_baseLayersService};module.factory("BaseLayersService",baseLayersService)}(),function(){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var service=function(MapData,map){var _service={};return _service.StartDraw=function(DrawingOptie){switch(MapData.DrawingType){case DrawingOption.LIJN:case DrawingOption.AFSTAND:MapData.DrawingObject=new L.Draw.Polyline(map),MapData.DrawingObject.enable();break;case DrawingOption.POLYGON:case DrawingOption.OPPERVLAKTE:var polygon_options={showArea:!0,shapeOptions:{stroke:!0,color:"#22528b",weight:4,opacity:.6,fill:!0,fillColor:null,fillOpacity:.4,clickable:!0}};MapData.DrawingObject=new L.Draw.Polygon(map,polygon_options),MapData.DrawingObject.enable();break;case DrawingOption.VIERKANT:MapData.DrawingObject=new L.Draw.Rectangle(map),MapData.DrawingObject.enable()}},_service};module.factory("DrawService",service)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var externService=function(MapData,map,GISService,ThemeHelper,WMSService,ThemeService,$q){var _externService={};return _externService.Export=function(){var exportObject={},arr=MapData.Themes.map(function(theme){var returnitem={};return returnitem.Naam=theme.Naam,returnitem.CleanUrl=theme.CleanUrl,returnitem.Type=theme.Type,returnitem.Visible=theme.Visible,returnitem.Layers=theme.AllLayers.filter(function(x){return 1==x.enabled}).map(function(layer){var returnlayer={};return returnlayer.visible=layer.visible,theme.Type==ThemeType.ESRI?(returnlayer.name=layer.name,returnlayer.id=layer.id):(returnlayer.name=layer.title,returnlayer.id=layer.title),returnlayer}),returnitem});return exportObject.Themes=arr,exportObject.Extent=map.getBounds(),exportObject.IsKaart=!0,exportObject},_externService.Import=function(project){console.log(project),_externService.setExtent(project.extent);var themesArray=[],promises=[];project.themes.forEach(function(theme){if(theme.type==ThemeType.ESRI){var prom=GISService.GetThemeData(theme.cleanUrl+"?f=pjson");promises.push(prom),prom.success(function(data,statuscode,functie,getdata){themesArray.push(ThemeHelper.createThemeFromJson(data,getdata))})}else{var _prom=WMSService.GetCapabilities(theme.cleanUrl);promises.push(_prom),_prom.success(function(data,status,headers,config){themesArray.push(data)}).error(function(data,status,headers,config){console.log("error!!!!!!!",data,status,headers,config)})}}),$q.all(promises).then(function(){var orderedArray=[],errorMessages=[];project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.CleanUrl==theme.cleanUrl});realTheme.Visible=theme.visible,console.log(theme," vs real theme: ",realTheme),realTheme.AllLayers.length==theme.layers.length?realTheme.Added=!0:realTheme.Added=null,realTheme.AllLayers.forEach(function(layer){layer.enabled=!1}),theme.layers.forEach(function(layer){var realLayer=realTheme.AllLayers.find(function(x){return x.title==layer.name});realLayer?(realLayer.visible=layer.visible,realLayer.enabled=!0):errorMessages.push('"'+layer.name+'" not found in mapserver: '+realTheme.Naam+".")})}),project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.CleanUrl==theme.cleanUrl});orderedArray.unshift(realTheme)}),ThemeService.AddAndUpdateThemes(orderedArray),console.log("all loaded"),errorMessages.length>0&&alert(errorMessages.join("\n"))})},_externService.setExtent=function(extent){map.fitBounds([[extent._northEast.lat,extent._northEast.lng],[extent._southWest.lat,extent._southWest.lng]])},_externService.CleanMapAndThemes=function(){MapData.CleanMap(),ThemeService.CleanThemes()},_externService};module.$inject=["MapData","map","GISService","ThemeHelper","WMSService","ThemeService","$q"],module.factory("ExternService",externService)}(),function(){var module=angular.module("tink.gis"),service=function(){var _service={};proj4.defs("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs"),_service.ConvertWSG84ToLambert72=function(coordinates){var result=proj4("EPSG:31370",[coordinates.lng||coordinates.x,coordinates.lat||coordinates.y]);
return{x:result[0],y:result[1]}},_service.ConvertLambert72ToWSG84=function(coordinates){var x=coordinates.lng||coordinates.x||coordinates[0],y=coordinates.lat||coordinates.y||coordinates[1],result=proj4("EPSG:31370","WGS84",[x,y]);return{y:result[0],x:result[1]}};var isCharDigit=function(n){return" "!=n&&n>-1};return _service.getWGS84CordsFromString=function(search){var returnobject={};returnobject.hasCordinates=!1,returnobject.error=null,returnobject.X=null,returnobject.Y=null;var currgetal="",samegetal=!1,aantalmetcorrectesize=0,hasaseperater=!1,getals=[];if((search.contains("51.")||search.contains("51,"))&&(search.contains("4.")||search.contains("4,"))){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=search[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var char=_step.value;isCharDigit(char)?samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0):"51"!=currgetal&&"4"!=currgetal||"."!=char&&","!=char||0!=hasaseperater?(""!=currgetal&&getals.push(currgetal),currgetal="",samegetal=!1,hasaseperater=!1):(currgetal+=char,aantalmetcorrectesize++,hasaseperater=!0)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}""!=currgetal&&getals.push(currgetal)}return 2==aantalmetcorrectesize&&2==getals.length?(returnobject.X=getals[0].replace(",","."),returnobject.Y=getals[1].replace(",","."),returnobject.hasCordinates=!0,returnobject):(returnobject.error="Incorrect format: X,Y is required",returnobject)},_service.getLambartCordsFromString=function(search){var returnobject={};returnobject.hasCordinates=!1,returnobject.error=null,returnobject.X=null,returnobject.Y=null;var getals=[],currgetal="",samegetal=!1,aantalmet6size=0,hasaseperater=!1,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=search[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var char=_step2.value;if(isCharDigit(char))samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0);else{if(6==currgetal.length){if(!(currgetal>125e3&&175e3>currgetal||currgetal>18e4&&24e4>currgetal))return returnobject.error="Out of bounds cordinaten voor Antwerpen.",returnobject;aantalmet6size++}","!=char&&"."!=char||0!=hasaseperater?(hasaseperater=!1,getals.push(currgetal),currgetal="",samegetal=!1):(hasaseperater=!0,currgetal+=char)}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return""!=currgetal&&(6==currgetal.length&&aantalmet6size++,getals.push(currgetal)),2==aantalmet6size&&2==getals.length?(returnobject.X=getals[0].replace(",","."),returnobject.Y=getals[1].replace(",","."),returnobject.hasCordinates=!0,returnobject):(returnobject.error="Incorrect format: Lat,Lng is required",returnobject)},_service};module.factory("HelperService",service)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi",["ui.sortable"]])}var layersService=function($http,map){var _layersService={};return _layersService};module.$inject=["$http","map"],module.factory("LayersService",layersService)}(),function(){var module=angular.module("tink.gis"),mapData=function(map,$rootScope,HelperService,ResultsData){var _data={};_data.VisibleLayers=[],_data.SelectableLayers=[],_data.VisibleFeatures=[],_data.Loading=0,_data.IsDrawing=!1,_data.ThemeUrls=["http://app11.p.gis.local/arcgissql/rest/services/P_Stad/Afval/MapServer/","http://app11.p.gis.local/arcgissql/rest/services/P_Stad/Cultuur/MapServer/","http://app11.p.gis.local/arcgissql/rest/services/P_Stad/Jeugd/MapServer/","http://app11.p.gis.local/arcgissql/rest/services/P_Stad/Onderwijs/MapServer/","http://app11.p.gis.local/arcgissql/rest/services/P_Stad/stad/MapServer/"],_data.Themes=[],_data.defaultlayer={id:"",name:"Alle Layers"},_data.SelectedLayer=_data.defaultlayer,_data.VisibleLayers.unshift(_data.defaultlayer),_data.ActiveInteractieKnop=ActiveInteractieButton.IDENTIFY,_data.DrawingType=DrawingOption.NIETS,_data.DrawingObject=null,_data.LastIdentifyBounds=null,_data.CleanDrawings=function(){_data.DrawingObject&&(_data.DrawingObject.layer&&(_data.DrawingObject.layer._popup=null),_data.DrawingObject.disable(),_data.DrawingObject=null,map.clearDrawings())};var WatIsHierMarker=null,WatIsHierOriginalMarker=null;_data.CleanMap=function(){_data.CleanDrawings(),_data.CleanWatIsHier(),_data.CleanSearch()},_data.GetZoomLevel=function(){return map.getZoom()},_data.GetScale=function(){return Scales[_data.GetZoomLevel()]},_data.CleanWatIsHier=function(){WatIsHierOriginalMarker&&(WatIsHierOriginalMarker.clearAllEventListeners(),WatIsHierOriginalMarker.closePopup(),map.removeLayer(WatIsHierOriginalMarker),WatIsHierOriginalMarker=null),WatIsHierMarker&&(map.removeLayer(WatIsHierMarker),WatIsHierMarker=null),straatNaam=null},_data.UpdateDisplayed=function(Themes){var currentScale=_data.GetScale();_data.Themes.forEach(function(theme){theme.Type==ThemeType.ESRI&&theme.UpdateDisplayed(currentScale)})},_data.Apply=function(){console.log("apply"),$rootScope.$apply()},_data.CreateOrigineleMarker=function(latlng,addressFound){if(addressFound){var foundMarker=L.AwesomeMarkers.icon({icon:"fa-map-marker",markerColor:"orange"});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:foundMarker,opacity:.5}).addTo(map)}else{var notFoundMarker=L.AwesomeMarkers.icon({icon:"fa-question",markerColor:"red",spin:!0});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:notFoundMarker}).addTo(map)}var convertedxy=HelperService.ConvertWSG84ToLambert72(latlng);if(straatNaam){var html='<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-4"><a href="templates/external/streetView.html?lat='+latlng.lat+"&lng="+latlng.lng+'" + target="_blank" ><img src="https://maps.googleapis.com/maps/api/streetview?size=100x50&location='+latlng.lat+","+latlng.lng+'&pitch=-0.76" /></a></div><div class="col-sm-8"><div class="col-sm-12"><b>'+straatNaam+'</b></div><div class="col-sm-3">WGS84:</div><div class="col-sm-8" style="text-align: left;">'+latlng.lat.toFixed(6)+", "+latlng.lng.toFixed(6)+'</div><div class="col-sm-1"><i class="fa fa-files-o"></i></div><div class="col-sm-3">Lambert:</div><div class="col-sm-8" style="text-align: left;">'+convertedxy.x.toFixed(1)+", "+convertedxy.y.toFixed(1)+'</div><div class="col-sm-1"><i class="fa fa-files-o"></i></div></div></div></div>';WatIsHierOriginalMarker.bindPopup(html,{minWidth:300}).openPopup()}else{var html='<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-3">WGS84:</div><div class="col-sm-8" style="text-align: left;">'+latlng.lat.toFixed(6)+", "+latlng.lng.toFixed(6)+'</div><div class="col-sm-1"><i class="fa fa-files-o"></i></div><div class="col-sm-3">Lambert:</div><div class="col-sm-8" style="text-align: left;">'+convertedxy.x.toFixed(1)+", "+convertedxy.y.toFixed(1)+'</div><div class="col-sm-1"><i class="fa fa-files-o"></i></div></div></div>';WatIsHierOriginalMarker.bindPopup(html,{minWidth:200}).openPopup()}};var straatNaam=null;return _data.CreateWatIsHierMarker=function(data){var convertedBackToWSG84=HelperService.ConvertLambert72ToWSG84(data.location);straatNaam=data.address.Street+" ("+data.address.Postal+")";var greenIcon=L.icon({iconUrl:"styles/fa-dot-circle-o_24_0_000000_none.png",iconSize:[24,24]});WatIsHierMarker=L.marker([convertedBackToWSG84.x,convertedBackToWSG84.y],{icon:greenIcon}).addTo(map)},_data.CleanSearch=function(){ResultsData.CleanSearch();for(var x=0;x<_data.VisibleFeatures.length;x++)map.removeLayer(_data.VisibleFeatures[x]);_data.VisibleFeatures.length=0},_data.PanToFeature=function(feature){var tmplayer=feature.mapItem._layers[Object.keys(feature.mapItem._layers)[0]];tmplayer._latlngs&&map.fitBounds(tmplayer.getBounds(),{paddingTopLeft:L.point(25,25),paddingBottomRight:L.point(25,25)})},_data.GoToLastClickBounds=function(){map.fitBounds(_data.LastIdentifyBounds,{paddingTopLeft:L.point(0,0),paddingBottomRight:L.point(0,0)})},_data.SetZIndexes=function(){var counter=_data.Themes.length+3;_data.Themes.forEach(function(theme){theme.MapData.ZIndex=counter,theme.Type==ThemeType.ESRI?theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=counter):(theme.MapData.bringToFront(),theme.MapData.setZIndex(counter)),counter--})},_data.AddFeatures=function(features,theme,layerId){if(null==features||0==features.features.length)ResultsData.EmptyResult=!0;else{ResultsData.EmptyResult=!1;for(var x=0;x<features.features.length;x++){var featureItem=features.features[x],layer={};if(void 0!=featureItem.layerId&&null!=featureItem.layerId?layer=theme.AllLayers.find(function(x){return x.id===featureItem.layerId}):void 0!=layerId&&null!=layerId?layer=theme.AllLayers.find(function(x){return x.id===layerId}):console.log("NO LAYER ID WAS GIVEN EITHER FROM FEATURE ITEM OR FROM PARAMETER"),featureItem.theme=theme,featureItem.layerName=layer.name,theme.Type===ThemeType.ESRI){layer.fields.forEach(function(field){if("esriFieldTypeDate"==field.type){var date=new Date(featureItem.properties[field.name]),date_string=date.getDate()+1+"/"+(date.getMonth()+1)+"/"+date.getFullYear();featureItem.properties[field.name]=date_string}}),featureItem.displayValue=featureItem.properties[layer.displayField];var mapItem=L.geoJson(featureItem,{style:Style.DEFAULT}).addTo(map);_data.VisibleFeatures.push(mapItem),featureItem.mapItem=mapItem}else featureItem.displayValue=featureItem.properties[Object.keys(featureItem.properties)[0]];ResultsData.JsonFeatures.push(featureItem)}$rootScope.$apply()}},_data};module.$inject=["ResultsData"],module.factory("MapData",mapData)}(),function(){var module=angular.module("tink.gis"),mapEvents=function(map,MapService,MapData){var _mapEvents={};map.on("draw:drawstart",function(event){console.log("draw started"),MapData.IsDrawing=!0}),map.on("draw:drawstop",function(event){console.log("draw stopped"),MapData.IsDrawing=!1});var berkenOmtrek=function(layer){var tempLatLng=null,totalDistance=0;return _.each(layer._latlngs,function(latlng){return null==tempLatLng?void(tempLatLng=latlng):(totalDistance+=tempLatLng.distanceTo(latlng),void(tempLatLng=latlng))}),totalDistance.toFixed(2)};return map.on("zoomend",function(event){console.log("Zoomend!!!"),MapData.UpdateDisplayed(),MapData.Apply()}),map.on("click",function(event){if(event.originalEvent instanceof MouseEvent)if(console.log("click op map! Is drawing: "+MapData.IsDrawing),MapData.IsDrawing)switch(console.log("DrawingObject: "),console.log(MapData.DrawingObject),MapData.DrawingType){case DrawingOption.AFSTAND:break;case DrawingOption.OPPERVLAKTE:break;default:console.log("Aant drawen zonder een gekent type!!!!!!")}else switch(MapData.CleanMap(),MapData.ActiveInteractieKnop){case ActiveInteractieButton.IDENTIFY:MapData.LastIdentifyBounds=map.getBounds(),MapService.Identify(event,10);break;case ActiveInteractieButton.SELECT:MapData.DrawingType===DrawingOption.NIETS&&MapService.Select(event);break;case ActiveInteractieButton.WATISHIER:MapService.WatIsHier(event);break;case ActiveInteractieButton.METEN:break;default:console.log("MAG NIET!!!!!!!!")}}),map.on("draw:created",function(e){switch(console.log("draw created"),console.log(e),MapData.ActiveInteractieKnop){case ActiveInteractieButton.SELECT:switch(MapData.DrawingType){case DrawingOption.LIJN:break;case DrawingOption.VIERKANT:break;case DrawingOption.POLYGON:}MapService.Query(e);break;case ActiveInteractieButton.METEN:switch(MapData.DrawingType){case DrawingOption.AFSTAND:var omtrek=berkenOmtrek(e.layer),popup=e.layer.bindPopup("Afstand (m): "+omtrek+" ");popup.on("popupclose",function(event){MapData.CleanMap()}),e.layer.openPopup();break;case DrawingOption.OPPERVLAKTE:var omtrek=berkenOmtrek(e.layer),popuptekst="<p>Opp  (m<sup>2</sup>): "+LGeo.area(e.layer).toFixed(2)+"</p><p>Omtrek (m): "+omtrek+" </p>",popup=e.layer.bindPopup(popuptekst);popup.on("popupclose",function(event){MapData.CleanMap()}),e.layer.openPopup()}break;default:console.log("MAG NIET!!!!!!!!")}MapData.IsDrawing=!1}),_mapEvents};module.factory("MapEvents",mapEvents)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var mapService=function($rootScope,MapData,map,ThemeHelper,$q,GISService,WMSService,ResultsData){var _mapService={};return _mapService.Identify=function(event,tolerance){"undefined"==typeof tolerance&&(tolerance=10),_.each(MapData.Themes,function(theme){theme.RecalculateVisibleLayerIds();var identifOnThisTheme=!0;if(1===theme.VisibleLayerIds.length&&-1===theme.VisibleLayerIds[0]&&(identifOnThisTheme=!1),identifOnThisTheme)switch(theme.Type){case ThemeType.ESRI:var layersVoorIdentify="visible: "+theme.VisibleLayerIds;ResultsData.Loading++,theme.MapData.identify().on(map).at(event.latlng).layers(layersVoorIdentify).tolerance(tolerance).run(function(error,featureCollection){ResultsData.Loading--,MapData.AddFeatures(featureCollection,theme)});break;case ThemeType.WMS:var layersVoorIdentify=theme.VisibleLayerIds;theme.VisibleLayers.forEach(function(lay){console.log(lay),1==lay.queryable&&(ResultsData.Loading++,theme.MapData.getFeatureInfo(event.latlng,lay.name).success(function(data,status,xhr){ResultsData.Loading--,console.log("minus");var xmlstring=JXON.xmlToString(data),returnjson=JXON.stringToJs(xmlstring),processedjson=null;returnjson.featureinforesponse&&(processedjson=returnjson.featureinforesponse.fields);var returnitem={type:"FeatureCollection",features:[]};if(processedjson){var featureArr=[];"object"===("undefined"==typeof processedjson?"undefined":_typeof(processedjson))?featureArr.push(processedjson):featureArr=processedjson,featureArr.forEach(function(feat){var tmpitem={layerName:lay.name,name:lay.name,layerId:lay.name,properties:feat,type:"Feature"};returnitem.features.push(tmpitem)}),console.log(lay.name+" item info: "),console.log(returnitem),MapData.AddFeatures(returnitem,theme)}else $rootScope.$apply()}))});break;default:console.log("UNKNOW TYPE!!!!:"),console.log(Theme.Type)}})},_mapService.Select=function(event){""==MapData.SelectedLayer.id?MapData.Themes.filter(function(x){return x.Type==ThemeType.ESRI}).forEach(function(theme){ResultsData.Loading++,theme.MapData.identify().on(map).at(event.latlng).layers("visible: "+theme.VisibleLayerIds).run(function(error,featureCollection){ResultsData.Loading--,MapData.AddFeatures(featureCollection,theme)})}):(ResultsData.Loading++,MapData.SelectedLayer.theme.MapData.identify().on(map).at(event.latlng).layers("visible: "+MapData.SelectedLayer.id).run(function(error,featureCollection){ResultsData.Loading--,MapData.AddFeatures(featureCollection,MapData.SelectedLayer.theme)}))},_mapService.WatIsHier=function(event){var prom=GISService.ReverseGeocode(event);prom.success(function(data,status,headers,config){data.error?MapData.CreateOrigineleMarker(event.latlng,!1):(MapData.CreateWatIsHierMarker(data),MapData.CreateOrigineleMarker(event.latlng,!0))}).error(function(data,status,headers,config){console.log(data,status,headers,config)})},_mapService.Query=function(event){""==MapData.SelectedLayer.id?MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){ResultsData.Loading++,theme.MapData.query().layer(lay.id).intersects(event.layer).run(function(error,featureCollection,response){ResultsData.Loading--,MapData.AddFeatures(featureCollection,theme,lay.id)})})}):(ResultsData.Loading++,MapData.SelectedLayer.theme.MapData.query().layer(MapData.SelectedLayer.id).intersects(event.layer).run(function(error,featureCollection,response){ResultsData.Loading--,MapData.AddFeatures(featureCollection,MapData.SelectedLayer.theme,MapData.SelectedLayer.id)}))},_mapService.UpdateThemeStatus=function(theme){_.each(theme.Groups,function(layerGroup){_mapService.UpdateGroupLayerStatus(layerGroup,theme)}),_.each(theme.Layers,function(layer){_mapService.UpdateLayerStatus(layer,theme)})},_mapService.UpdateGroupLayerStatus=function(groupLayer,theme){_.each(groupLayer.Layers,function(childlayer){_mapService.UpdateLayerStatus(childlayer,theme)})},_mapService.UpdateLayerStatus=function(layer,theme){var visibleOnMap=theme.Visible&&layer.visible&&(layer.parent&&layer.parent.visible||!layer.parent),indexOfLayerInVisibleLayers=theme.VisibleLayers.indexOf(layer);if(visibleOnMap)-1===indexOfLayerInVisibleLayers&&layer.enabled&&(theme.VisibleLayers.push(layer),theme.Type==ThemeType.ESRI&&MapData.VisibleLayers.push(layer));else if(indexOfLayerInVisibleLayers>-1&&(theme.VisibleLayers.splice(indexOfLayerInVisibleLayers,1),theme.Type==ThemeType.ESRI)){var indexOfLayerInVisibleLayersOfMap=MapData.VisibleLayers.indexOf(layer);MapData.VisibleLayers.splice(indexOfLayerInVisibleLayersOfMap,1)}},_mapService};module.$inject=["$rootScope","MapData","map","ThemeHelper","$q","GISService","WMSService","ResultsData"],module.factory("MapService",mapService)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var service=function(){var themeHelper={};return themeHelper.createThemeFromJson=function(rawdata,getData){var thema={};try{var rawlayers=rawdata.layers,cleanUrl=getData.url.substring(0,getData.url.indexOf("?"));thema.Naam=rawdata.documentInfo.Title,thema.name=rawdata.documentInfo.Title,thema.Description=rawdata.documentInfo.Subject,thema.Layers=[],thema.AllLayers=[],thema.Groups=[],thema.CleanUrl=cleanUrl,thema.Url=getData.url,thema.VisibleLayers=[],thema.VisibleLayerIds=[],thema.Visible=!0,thema.Added=!1,thema.enabled=!0,thema.Type=ThemeType.ESRI,thema.status=ThemeStatus.NEW,thema.MapData={},_.each(rawlayers,function(x){x.visible=x.defaultVisibility,x.enabled=!0,x.parent=null,x.title=x.name,x.theme=thema,x.displayed=!0,x.UpdateDisplayed=function(currentScale){(x.maxScale>0||x.minScale>0)&&(console.log("MinMaxandCurrentScale",x.maxScale,x.minScale,currentScale),currentScale>x.maxScale&&currentScale<x.minScale?x.displayed=!0:x.displayed=!1)},x.type=LayerType.LAYER,thema.AllLayers.push(x),-1===x.parentLayerId&&(null===x.subLayerIds?thema.Layers.push(x):(thema.Groups.push(x),x.type=LayerType.GROUP))}),_.each(thema.Groups,function(layerGroup){null!==layerGroup.subLayerIds&&(layerGroup.Layers=[],_.each(rawlayers,function(rawlayer){layerGroup.id===rawlayer.parentLayerId&&(rawlayer.parent=layerGroup,layerGroup.Layers.push(rawlayer))}))}),thema.UpdateDisplayed=function(currentScale){thema.AllLayers.forEach(function(layer){layer.UpdateDisplayed(currentScale)})},thema.UpdateMap=function(){thema.RecalculateVisibleLayerIds(),thema.MapData.setLayers(thema.VisibleLayerIds)},thema.RecalculateVisibleLayerIds=function(){thema.VisibleLayerIds.length=0,thema.VisibleLayers.forEach(function(visLayer){thema.VisibleLayerIds.push(visLayer.id)}),0===thema.VisibleLayerIds.length&&thema.VisibleLayerIds.push(-1)},thema.RecalculateVisibleLayerIds()}catch(ex){console.log("Error when creating theme from url: "+getData.url+" Exeption: "+ex+" Data: "),console.log(rawdata)}return thema},themeHelper};module.$inject=["map"],module.factory("ThemeHelper",service)}(),function(){var module=angular.module("tink.gis"),service=function(map,ThemeHelper,MapData,LayerManagementService){var _service={};return _service.AddAndUpdateThemes=function(themesBatch){console.log("Themes batch for add and updates..."),console.log(themesBatch),themesBatch.forEach(function(theme){var existingTheme=MapData.Themes.find(function(x){return x.CleanUrl==theme.CleanUrl});switch(console.log("addorupdate or del theme, ",theme,theme.status),theme.status){case ThemeStatus.NEW:theme.Type==ThemeType.ESRI&&(LayerManagementService.GetAditionalLayerInfo(theme),theme.UpdateDisplayed(MapData.GetScale())),_service.AddNewTheme(theme);break;case ThemeStatus.DELETED:_service.DeleteTheme(existingTheme);break;case ThemeStatus.UNMODIFIED:break;case ThemeStatus.UPDATED:_service.UpdateTheme(theme,existingTheme),_service.UpdateThemeVisibleLayers(existingTheme);break;default:console.log("Er is iets fout, status niet bekend!!!: "+theme.status)}theme.status=ThemeStatus.UNMODIFIED}),console.log("refresh of sortableThemes"),$("#sortableThemes").sortable("refresh"),MapData.SetZIndexes()},_service.UpdateThemeVisibleLayers=function(theme){theme.UpdateMap()},_service.UpdateTheme=function(updatedTheme,existingTheme){for(var x=0;x<updatedTheme.AllLayers.length;x++){var updatedLayer=updatedTheme.AllLayers[x],existingLayer=existingTheme.AllLayers[x];updatedLayer.enabled&&updatedLayer.visible?(existingTheme.Type==ThemeType.ESRI&&-1==MapData.VisibleLayers.indexOf(existingLayer)&&MapData.VisibleLayers.push(existingLayer),-1==existingTheme.VisibleLayers.indexOf(existingLayer)&&existingTheme.VisibleLayers.push(existingLayer)):(existingTheme.Type==ThemeType.ESRI&&-1!=MapData.VisibleLayers.indexOf(existingLayer)&&MapData.VisibleLayers.splice(MapData.VisibleLayers.indexOf(existingLayer),1),-1!=existingTheme.VisibleLayers.indexOf(existingLayer)&&existingTheme.VisibleLayers.splice(existingTheme.VisibleLayers.indexOf(existingLayer),1)),existingLayer.enabled=updatedLayer.enabled,existingLayer.visible=updatedLayer.visible}existingTheme.RecalculateVisibleLayerIds()},_service.AddNewTheme=function(theme){switch(MapData.Themes.unshift(theme),console.log("Adding THEME!!!",theme),_.each(theme.AllLayers,function(layer){layer.enabled&&layer.visible&&layer.type===LayerType.LAYER&&theme.Visible&&(null==layer.parent||void 0==layer.parent||1==layer.parent.visible)&&(console.log("LAYERINFO: ",layer),theme.VisibleLayers.push(layer),theme.Type==ThemeType.ESRI&&MapData.VisibleLayers.push(layer))}),theme.RecalculateVisibleLayerIds(),theme.Type){case ThemeType.ESRI:theme.MapData=L.esri.dynamicMapLayer({maxZoom:19,minZoom:0,url:theme.CleanUrl,opacity:1,layers:theme.VisibleLayerIds,continuousWorld:!0,useCors:!0}).addTo(map),theme.MapData.on("load",function(e){theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=theme.MapData.ZIndex,console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;case ThemeType.WMS:theme.MapData=L.tileLayer.betterWms(theme.CleanUrl,{maxZoom:19,minZoom:0,format:"image/png",layers:theme.VisibleLayerIds,transparent:!0,continuousWorld:!0,useCors:!0}).addTo(map),theme.MapData.on("load",function(e){console.log("LOAD VAN "+theme.Naam),console.log(theme.MapData),theme.MapData._container.childNodes&&([].slice.call(theme.MapData._container.childNodes).forEach(function(imgNode){imgNode.style.zIndex=theme.MapData.ZIndex}),console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;default:console.log("UNKNOW TYPE")}},_service.CleanThemes=function(){for(;0!=MapData.Themes.length;)console.log("DELETING THIS THEME",MapData.Themes[0]),_service.DeleteTheme(MapData.Themes[0])},_service.DeleteTheme=function(theme){map.removeLayer(theme.MapData);var themeIndex=MapData.Themes.indexOf(theme);themeIndex>-1&&MapData.Themes.splice(themeIndex,1),theme.VisibleLayers.forEach(function(visLayer){var visLayerIndex=MapData.VisibleLayers.indexOf(visLayer);visLayerIndex>-1&&MapData.VisibleLayers.splice(visLayerIndex,1)}),MapData.CleanSearch()},_service};module.$inject=["map","ThemeHelper","MapData","LayerManagementService"],module.factory("ThemeService",service)}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchController",function($scope,ResultsData,map){var vm=this;vm.features=ResultsData.JsonFeatures,vm.EmptyResult=ResultsData.EmptyResult,vm.Loading=ResultsData.Loading,vm.MaxLoading=0,$scope.$watch(function(){return ResultsData.Loading},function(newVal,oldVal){vm.Loading=newVal,0==oldVal&&(vm.MaxLoading=newVal),oldVal>newVal&&vm.MaxLoading<oldVal&&(vm.MaxLoading=oldVal),0==newVal&&(vm.MaxLoading=0),console.log("Loading val: "+newVal+"/"+vm.MaxLoading)})});theController.$inject=["$scope","ResultsData","map"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchResultsController",function($scope,ResultsData,map,SearchService){var vm=this;vm.features=ResultsData.JsonFeatures,vm.featureLayers=null,vm.selectedResult=null,vm.layerGroupFilter="geenfilter",$scope.$watchCollection(function(){return ResultsData.JsonFeatures},function(newValue,oldValue){vm.featureLayers=_.uniq(_.map(vm.features,"layerName")),vm.layerGroupFilter="geenfilter"}),$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){vm.selectedResult=newVal}),vm.deleteFeature=function(feature){SearchService.DeleteFeature(feature)},vm.aantalFeaturesMetType=function(type){return vm.features.filter(function(x){return x.layerName==type}).length},vm.HoveredFeature=null,vm.HoverOver=function(feature){vm.HoveredFeature&&(vm.HoveredFeature.hoverEdit=!1),feature.hoverEdit=!0,vm.HoveredFeature=feature},vm.deleteFeatureGroup=function(featureGroupName){SearchService.DeleteFeatureGroup(featureGroupName)},vm.showDetails=function(feature){ResultsData.SelectedFeature=feature},vm.exportToCSV=function(){SearchService.ExportToCSV()}});theController.$inject=["$scope","ResultsData","map"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchSelectedController",function($scope,ResultsData,MapData,SearchService){var vm=this;vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,vm.props=[],$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){if(oldVal&&oldVal!=newVal&&oldVal.mapItem){var tmplayer=oldVal.mapItem._layers[Object.keys(oldVal.mapItem._layers)[0]];tmplayer._latlngs&&tmplayer.setStyle(Style.DEFAULT)}if(newVal){if(newVal.mapItem){var tmplayer=newVal.mapItem._layers[Object.keys(newVal.mapItem._layers)[0]];tmplayer._latlngs&&tmplayer.setStyle(Style.HIGHLIGHT)}vm.selectedResult=newVal;var item=Object.getOwnPropertyNames(newVal.properties).map(function(k){return{key:k,value:newVal.properties[k]}});vm.props=item,vm.prevResult=SearchService.GetPrevResult(),vm.nextResult=SearchService.GetNextResult()}else vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null}),vm.toonFeatureOpKaart=function(){"esri"===vm.selectedResult.theme.Type?MapData.PanToFeature(vm.selectedResult):MapData.GoToLastClickBounds()},vm.volgende=function(){ResultsData.SelectedFeature=vm.nextResult},vm.vorige=function(){ResultsData.SelectedFeature=vm.prevResult},vm.buffer=1,vm.doordruk=function(){console.log(vm.buffer),console.log(ResultsData.SelectedFeature)},vm.delete=function(){var prev=SearchService.GetPrevResult(),next=SearchService.GetNextResult();SearchService.DeleteFeature(vm.selectedResult),next?ResultsData.SelectedFeature=next:prev?ResultsData.SelectedFeature=prev:ResultsData.SelectedFeature=null},vm.close=function(feature){vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,ResultsData.SelectedFeature=null}});theController.$inject=["$scope","ResultsData"]}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearch",function(){return{replace:!0,templateUrl:"templates/search/searchTemplate.html",controller:"searchController",controllerAs:"srchctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearchResults",function(){return{replace:!0,templateUrl:"templates/search/searchResultsTemplate.html",controller:"searchResultsController",controllerAs:"srchrsltsctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearchSelected",function(){return{replace:!0,templateUrl:"templates/search/searchSelectedTemplate.html",controller:"searchSelectedController",controllerAs:"srchslctdctrl"}})}(),function(){var module=angular.module("tink.gis"),data=function(){var _data={};return _data.SelectedFeature=null,_data.JsonFeatures=[],_data.Loading=0,_data.EmptyResult=!1,_data.CleanSearch=function(){_data.JsonFeatures.length=0,_data.SelectedFeature=null},_data};module.factory("ResultsData",data)}(),function(){var module=angular.module("tink.gis"),service=function(ResultsData,map){var _service={};return _service.DeleteFeature=function(feature){var featureIndex=ResultsData.JsonFeatures.indexOf(feature);featureIndex>-1&&(feature.mapItem&&map.removeLayer(feature.mapItem),ResultsData.JsonFeatures.splice(featureIndex,1))},_service.DeleteFeatureGroup=function(featureGroupName){var toDelFeatures=[];ResultsData.JsonFeatures.forEach(function(feature){feature.layerName===featureGroupName&&toDelFeatures.push(feature)}),toDelFeatures.forEach(function(feat){_service.DeleteFeature(feat)})},_service.ExportToCSV=function(){var csvContent="",dataString="",layName="";csvContent+="Laag;\n",ResultsData.JsonFeatures.forEach(function(feature,index){if(layName!==feature.layerName){layName=feature.layerName;var tmparr=[];for(var name in feature.properties)tmparr.push(name);var layfirstline=tmparr.join(";");csvContent+=layName+";"+layfirstline+"\n"}var infoArray=_.values(feature.properties);infoArray.unshift(layName),dataString=infoArray.join(";"),console.log(dataString),csvContent+=index<ResultsData.JsonFeatures.length?dataString+"\n":dataString});var a=document.createElement("a");a.href="data:attachment/csv,"+encodeURIComponent(csvContent),a.target="_blank",a.download="exportsik.csv",document.body.appendChild(a),a.click()},_service.GetNextResult=function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(index<ResultsData.JsonFeatures.length-1){var nextItem=ResultsData.JsonFeatures[index+1];if(nextItem.layerName===layerName)return nextItem}return null},_service.GetPrevResult=function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(index>0){var prevItem=ResultsData.JsonFeatures[index-1];if(prevItem.layerName===layerName)return prevItem}return null},_service};module.factory("SearchService",service)}(),L.TileLayer.BetterWMS=L.TileLayer.WMS.extend({getFeatureInfo:function(latlng,layers){var url=this.getFeatureInfoUrl(latlng,layers),prom=$.ajax({url:url,success:function(data,status,xhr){},error:function(xhr,status,_error){}});return prom},getFeatureInfoUrl:function(latlng,layers){var point=this._map.latLngToContainerPoint(latlng,this._map.getZoom()),size=this._map.getSize(),params={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:size.y,width:size.x,layers:layers,query_layers:layers,buffer:100,info_format:"text/xml"};return params["1.3.0"===params.version?"i":"x"]=point.x,params["1.3.0"===params.version?"j":"y"]=point.y,this._url+L.Util.getParamString(params,this._url,!0)}}),L.tileLayer.betterWms=function(url,options){return new L.TileLayer.BetterWMS(url,options)},L.drawVersion="0.3.0-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Tekenen annuleren",text:"Annuleren"},finish:{title:"Tekenen beindigen",text:"Tekenen beindigen"},undo:{title:"Verwijder laatst getekende punt",text:"Verwijder laatste punt"},buttons:{polyline:"Teken een lijn",polygon:"Teken een veelhoek",rectangle:"Teken een rechthoek",circle:"Teken een cirkel",marker:"Teken een markering"}},handlers:{circle:{tooltip:{start:"Klik en sleep om een cirkel te tekenen."},radius:"Straal"},marker:{tooltip:{start:"Klik om een markering te plaatsen."}},polygon:{tooltip:{start:"Klik om een veelhoek  te tekenen.",cont:"Klik om de veelhoek verder te tekenen.",
end:"Klik op het eerste punt om de veelhoek te sluiten."}},polyline:{error:"<strong>Error:</strong> figuur randen mogen niet kruisen!",tooltip:{start:"Klik om een lijn te tekenen.",cont:"Klik om de lijn verder te tekenen.",end:"Klik op het laatste punt om de lijn af te sluiten."}},rectangle:{tooltip:{start:"Klik en sleep om een rechthoek te tekenen."}},simpleshape:{tooltip:{end:"Laat de muis los om het tekenen te beindigen."}}}},edit:{toolbar:{actions:{save:{title:"Aanpassingen bewaren.",text:"Bewaren"},cancel:{title:"Tekenen annuleren, aanpassingen verwijderen.",text:"Annuleren"}},buttons:{edit:"Lagen bewerken.",editDisabled:"Geen lagen om te bewerken.",remove:"Lagen verwijderen.",removeDisabled:"Geen lagen om te verwijderen."}},handlers:{edit:{tooltip:{text:"Versleep ankerpunt of markering om het object aan te passen.",subtext:"Klink Annuleer om de aanpassingen ongedaan te maken."}},remove:{tooltip:{text:"Klik op object om te verwijderen"}}}}},angular.module("tink.gis").run(["$templateCache",function($templateCache){$templateCache.put("templates/external/streetView.html","<html>\n<head>\n<meta charset=utf-8>\n<title>Street View side-by-side</title>\n<style>\nhtml, body {\r\n        height: 100%;\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n      #map,  {\r\n        float: left;\r\n        height: 0%;\r\n        width: 0%;\r\n      }\r\n       #pano {\r\n        float: left;\r\n        height: 100%;\r\n        width: 100%;\r\n      }\n</style>\n</head>\n<body>\n<div id=map></div>\n<div id=pano></div>\n<script>\nfunction initialize() {\r\n        \r\n        var urlLat = parseFloat((location.search.split('lat=')[1]||'').split('&')[0]);\r\n        var urlLng = parseFloat((location.search.split('lng=')[1]||'').split('&')[0]);\r\n        var fenway = {lat:urlLat, lng: urlLng};\r\n        var map = new google.maps.Map(document.getElementById('map'), {\r\n          center: fenway,\r\n          zoom: 14\r\n        });\r\n        var panorama = new google.maps.StreetViewPanorama(\r\n            document.getElementById('pano'), {\r\n              position: fenway,\r\n              pov: {\r\n                heading: 34,\r\n                pitch: 10\r\n              }\r\n            });\r\n        map.setStreetView(panorama);\r\n      }\n</script>\n<script async defer src=\"https://maps.googleapis.com/maps/api/js?callback=initialize\">\n</script>\n</body>\n</html>"),$templateCache.put("templates/layermanagement/geoPuntTemplate.html",'<div class=row>\n<div class=col-md-4>\n<input class=searchbox ng-model=searchTerm ng-change=searchChanged() ng-model-options="{debounce: 500}" placeholder="Geef een trefwoord of een url in">\n<input disabled value=https://geodata.antwerpen.be/arcgissql/services/P_SiK/Groeninventaris/MapServer/WMSServer>\n<div ng-if=!searchIsUrl ng-repeat="theme in availableThemes">\n<div ng-click=geopuntThemeChanged(theme) ng-class="{\'greytext\': theme.Type != \'wms\' &&  theme.Type != \'esri\'}">\n{{theme.Naam}}\n<i ng-if="theme.Added == true" class="fa fa-check-circle"></i>\n<i ng-if="theme.Added == null" class="fa fa-check-circle-o"></i>\n</div>\n</div>\n<tink-pagination ng-hide="numberofrecordsmatched == 0" tink-items-per-page-values=[5] tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div class=col-md-8>\n<div ng-if=searchIsUrl>\n<button ng-click=laadUrl()>Laad url</button>\n</div>\n<div ng-if="copySelectedTheme !== null">\n<button ng-if="copySelectedTheme.Added != false" data-ng-click=AddOrUpdateTheme()>Update</button>\n<p>{{copySelectedTheme.Description}}</p>\n<p><small><a ng-href={{copySelectedTheme.CleanUrl}} target=_blank>Details</a></small></p>\n<div class=layercontroller-checkbox>\n<input indeterminate-checkbox child-list=copySelectedTheme.AllLayers property=enabled type=checkbox ng-model=copySelectedTheme.enabled id={{copySelectedTheme.name}}>\n<label for={{copySelectedTheme.name}}> {{copySelectedTheme.name | limitTo: 99}}</label>\n<div ng-repeat="mainlayer in copySelectedTheme.Layers">\n<div class=layercontroller-checkbox>\n<input type=checkbox ng-model=mainlayer.enabled id={{mainlayer.name}}{{mainlayer.id}}>\n<label for={{mainlayer.name}}{{mainlayer.id}}> {{mainlayer.title | limitTo: 99}}</label>\n</div>\n</div>\n<div ng-repeat="groupLayer in copySelectedTheme.Groups">\n<div class=layercontroller-checkbox>\n<input indeterminate-checkbox child-list=groupLayer.Layers property=enabled type=checkbox ng-model=groupLayer.enabled id={{groupLayer.name}}{{groupLayer.id}}>\n<label for={{groupLayer.name}}{{groupLayer.id}}> {{groupLayer.title | limitTo: 99}}</label>\n<div ng-repeat="layer in groupLayer.Layers">\n<div class=layercontroller-checkbox>\n<input type=checkbox ng-model=layer.enabled ng-change=layer.chkChanged() id={{layer.name}}{{layer.id}}>\n<label for={{layer.name}}{{layer.id}}> {{layer.title | limitTo: 99}}</label>\n</div>\n</div>\n</div>\n</div>\n</div>\n<button ng-if="copySelectedTheme.Added == false" data-ng-click=AddOrUpdateTheme()>Toevoegen</button>\n</div>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/layerManagerTemplate.html","<div>\n<div class=modal-header>\n<button type=button style=float:right data-ng-click=cancel()><i class=\"fa fa-times\"></i></button>\n<h4 class=model-title>Laag toevoegen\n</h4></div>\n<div class=modal-content>\n<ul class=nav-tabs>\n<li role=presentation ng-class=\"{'active': active=='geopunt'}\"><a href=# ng-click=\"active='geopunt'\">GeoPunt</a></li>\n<li role=presentation ng-class=\"{'active': active=='solr'}\"><a href=\"\" ng-click=\"active='solr'\">SOLR</a></li>\n<li role=presentation ng-class=\"{'active': active=='url'}\"><a href=\"\" ng-click=\"active='url'\">Url</a></li>\n</ul>\n<geo-punt ng-show=\"active=='geopunt'\"></geo-punt>\n<solr-gis ng-show=\"active=='solr'\"></solr-gis>\n</div>\n<div class=modal-footer>\n<button data-ng-click=ok()>Klaar</button>\n</div>\n</div>"),$templateCache.put("templates/layermanagement/solrGISTemplate.html",'<div class=row>\n<div class=col-md-4>\n<input class=searchbox ng-model=searchTerm ng-change=searchChanged() ng-model-options="{debounce: 500}" placeholder="Geef een trefwoord of een url in">\n<input disabled value=https://geodata.antwerpen.be/arcgissql/services/P_SiK/Groeninventaris/MapServer/WMSServer>\n<div ng-if=!searchIsUrl ng-repeat="theme in availableThemes">\n<div ng-click=geopuntThemeChanged(theme) ng-class="{\'greytext\': theme.Type != \'wms\' &&  theme.Type != \'esri\'}">\n{{theme.key}}\n<i ng-if="theme.Added == true" class="fa fa-check-circle"></i>\n<i ng-if="theme.Added == null" class="fa fa-check-circle-o"></i>\n</div>\n</div>\n<tink-pagination ng-hide="numberofrecordsmatched == 0" tink-items-per-page-values=[5] tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div class=col-md-8>\n<div ng-if=searchIsUrl>\n<button ng-click=laadUrl()>Laad url</button>\n</div>\n<div ng-if="copySelectedTheme !== null">\n<button ng-if="copySelectedTheme.Added != false" data-ng-click=AddOrUpdateTheme()>Update</button>\n<p>{{copySelectedTheme.Description}}</p>\n<p><small><a ng-href={{copySelectedTheme.CleanUrl}} target=_blank>Details</a></small></p>\n<div class=layercontroller-checkbox>\n<input indeterminate-checkbox child-list=copySelectedTheme.AllLayers property=enabled type=checkbox ng-model=copySelectedTheme.enabled id={{copySelectedTheme.name}}>\n<label for={{copySelectedTheme.name}}> {{copySelectedTheme.name | limitTo: 99}}</label>\n<div ng-repeat="mainlayer in copySelectedTheme.Layers">\n<div class=layercontroller-checkbox>\n<input type=checkbox ng-model=mainlayer.enabled id={{mainlayer.name}}{{mainlayer.id}}>\n<label for={{mainlayer.name}}{{mainlayer.id}}> {{mainlayer.title | limitTo: 99}}</label>\n</div>\n</div>\n<div ng-repeat="groupLayer in copySelectedTheme.Groups">\n<div class=layercontroller-checkbox>\n<input indeterminate-checkbox child-list=groupLayer.Layers property=enabled type=checkbox ng-model=groupLayer.enabled id={{groupLayer.name}}{{groupLayer.id}}>\n<label for={{groupLayer.name}}{{groupLayer.id}}> {{groupLayer.title | limitTo: 99}}</label>\n<div ng-repeat="layer in groupLayer.Layers">\n<div class=layercontroller-checkbox>\n<input type=checkbox ng-model=layer.enabled ng-change=layer.chkChanged() id={{layer.name}}{{layer.id}}>\n<label for={{layer.name}}{{layer.id}}> {{layer.title | limitTo: 99}}</label>\n</div>\n</div>\n</div>\n</div>\n</div>\n<button ng-if="copySelectedTheme.Added == false" data-ng-click=AddOrUpdateTheme()>Toevoegen</button>\n</div>\n</div>\n</div>'),$templateCache.put("templates/other/groupLayerTemplate.html",'<div class=layercontroller-checkbox>\n<input class=visible-box type=checkbox id={{grplyrctrl.grouplayer.name}}{{grplyrctrl.grouplayer.id}} ng-model=grplyrctrl.grouplayer.visible ng-change=grplyrctrl.chkChanged()>\n<label for={{grplyrctrl.grouplayer.name}}{{grplyrctrl.grouplayer.id}}>{{grplyrctrl.grouplayer.name}}</label>\n<div ng-repeat="layer in grplyrctrl.grouplayer.Layers | filter :  { enabled: true }">\n<tink-layer layer=layer>\n</tink-layer>\n</div>\n</div>'),$templateCache.put("templates/other/layerTemplate.html",'<div class=layercontroller-checkbox>\n<img style="width:20px; height:20px" ng-if="lyrctrl.layer.theme.Type == \'esri\' && lyrctrl.layer.legend.length == 1" ng-src={{lyrctrl.layer.legend[0].fullurl}}>\n<input class=visible-box type=checkbox ng-model=lyrctrl.layer.visible ng-change=lyrctrl.chkChanged() id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}>\n<label ng-class="{\'greytext\': lyrctrl.layer.displayed == false}" for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}> {{lyrctrl.layer.title | limitTo: 23}}<span ng-show="lyrctrl.layer.theme.Type == \'wms\' && lyrctrl.layer.queryable">(i)</span></label>\n<img ng-if="lyrctrl.layer.theme.Type == \'wms\'" ng-src="{{layer.theme.CleanUrl}}?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=20&HEIGHT=20&LAYER={{lyrctrl.layer.id}}"><img>\n<div ng-if="lyrctrl.layer.theme.Type == \'esri\' && lyrctrl.layer.legend.length > 1" ng-repeat="legend in lyrctrl.layer.legend">\n<img style="width:20px; height:20px" ng-src={{legend.fullurl}}><img><span> {{legend.label}}</span>\n</div>\n</div>'),$templateCache.put("templates/other/layersTemplate.html",'<div data-tink-nav-aside="" id=rightaside data-auto-select=true data-toggle-id=asideNavRight class="nav-aside nav-right">\n<aside>\n<div class=nav-aside-section>\n<ul id=sortableThemes ui-sortable=lyrsctrl.sortableOptions ng-model=lyrsctrl.themes>\n<div ng-repeat="theme in lyrsctrl.themes">\n<tink-theme theme=theme>\n</tink-theme>\n</div>\n</ul>\n<button class="btn btn-primary addlayerbtn" ng-click=lyrsctrl.AddLayers()>Voeg laag toe</button>\n</div>\n</aside>\n</div>'),$templateCache.put("templates/other/mapTemplate.html",'<div class=tink-map>\n<div id=map class=leafletmap>\n<div class="btn-group ll searchbtns">\n<button type=button class=btn ng-class="{active: mapctrl.IsKnop1==true}" ng-click="mapctrl.IsKnop1=true" prevent-default><i class="fa fa-map-marker"></i></button>\n<button type=button class=btn ng-class="{active: mapctrl.IsKnop1==false}" ng-click="mapctrl.IsKnop1=false" prevent-default><i class="fa fa-download"></i></button>\n</div>\n<div class="ll zoekbalken">\n<input class=zoekbalk ng-show="mapctrl.IsKnop1 == true" placeholder="Geef een X,Y / locatie of POI in." ng-change=mapctrl.zoekLocChanged(mapctrl.zoekLoc) ng-keyup="$event.keyCode == 13 && mapctrl.zoekEnter(mapctrl.zoekLoc)" ng-model=mapctrl.zoekLoc prevent-default>\n<input class=zoekbalk ng-show="mapctrl.IsKnop1 == false" placeholder="Zoek in je lagen?" prevent-default>\n<select ng-options="layer as layer.name for layer in mapctrl.SelectableLayers" ng-model=mapctrl.selectedLayer ng-show="mapctrl.IsKnop1 == true" ng-change=mapctrl.layerChange() ng-class="{invisible: mapctrl.activeInteractieKnop!=\'select\' || mapctrl.SelectableLayers.length<=1}" prevent-default></select>\n</div>\n<div class="btn-group btn-group-vertical ll interactiebtns">\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'identify\')" ng-class="{active: mapctrl.activeInteractieKnop==\'identify\'}" prevent-default><i class="fa fa-info"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'select\')" ng-class="{active: mapctrl.activeInteractieKnop==\'select\'}" prevent-default><i class="fa fa-mouse-pointer"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'meten\')" ng-class="{active: mapctrl.activeInteractieKnop==\'meten\'}" prevent-default><i class="fa fa-expand"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'watishier\')" ng-class="{active: mapctrl.activeInteractieKnop==\'watishier\'}" prevent-default><i class="fa fa-thumb-tack"></i></button>\n</div>\n<div class="btn-group ll metenbtns" ng-show=mapctrl.showMetenControls>\n<button ng-click="mapctrl.drawingButtonChanged(\'afstand\')" ng-class="{active: mapctrl.drawingType==\'afstand\'}" type=button class=btn prevent-default><i class="fa fa-arrows-h"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'oppervlakte\')" ng-class="{active: mapctrl.drawingType==\'oppervlakte\'}" type=button class=btn prevent-default><i class="fa fa-star-o"></i></button>\n</div>\n<div class="btn-group ll drawingbtns" ng-show=mapctrl.showDrawControls>\n<button ng-click=mapctrl.selectpunt() ng-class="{active: mapctrl.drawingType==\'\'}" type=button class=btn prevent-default><i class="fa fa-mouse-pointer"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'lijn\')" ng-class="{active: mapctrl.drawingType==\'lijn\'}" type=button class=btn prevent-default><i class="fa fa-minus"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'vierkant\')" ng-class="{active: mapctrl.drawingType==\'vierkant\'}" type=button class=btn prevent-default><i class="fa fa-square-o"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'polygon\')" ng-class="{active: mapctrl.drawingType==\'polygon\'}" type=button class=btn prevent-default><i class="fa fa-star-o"></i></button>\n</div>\n<div class="ll btn-group kaarttypes">\n<button class=btn ng-class="{active: mapctrl.kaartIsGetoond==true}" ng-click=mapctrl.toonKaart() prevent-default>Kaart</button>\n<button class=btn ng-class="{active: mapctrl.kaartIsGetoond==false}" ng-click=mapctrl.toonLuchtfoto() prevent-default>Luchtfoto</button>\n</div>\n<div class="btn-group btn-group-vertical ll viewbtns">\n<button type=button class=btn ng-click=mapctrl.zoomIn() prevent-default><i class="fa fa-plus"></i></button>\n<button type=button class=btn ng-click=mapctrl.zoomOut() prevent-default><i class="fa fa-minus"></i></button>\n<button type=button class=btn ng-click="" prevent-default><i class="fa fa-crosshairs"></i></button>\n<button type=button class=btn ng-click=mapctrl.fullExtent() prevent-default><i class="fa fa-home"></i></button>\n</div>\n<div class="btn-group btn-group-vertical ll localiseerbtn">\n<button type=button class=btn prevent-default><i class="fa fa-male"></i></button>\n</div>\n<div class="ll loading" ng-show="mapctrl.Loading > 0">\n<div class=loader></div> {{mapctrl.MaxLoading - mapctrl.Loading}}/ {{mapctrl.MaxLoading}}\n</div>\n</div>\n<tink-search></tink-search>\n<tink-layers></tink-layers>\n</div>'),$templateCache.put("templates/other/themeTemplate.html",'<div>\n<input class=visible-box type=checkbox id=chk{{thmctrl.theme.Naam}} ng-model=thmctrl.theme.Visible ng-change=thmctrl.chkChanged()>\n<label for=chk{{thmctrl.theme.Naam}}> {{thmctrl.theme.Naam}} <span ng-show="thmctrl.theme.Type==\'esri\'">(stad)</span><span ng-hide="thmctrl.theme.Type==\'esri\'">({{thmctrl.theme.Type}})</span></label><i class="fa fa-trash pull-right" ng-click=thmctrl.deleteTheme()></i>\n<div class=layercontroller-checkbox ng-repeat="layer in thmctrl.theme.Layers | filter: { enabled: true }">\n<tink-layer layer=layer>\n</tink-layer>\n</div>\n<div class=layercontroller-checkbox ng-repeat="group in thmctrl.theme.Groups | filter: { enabled: true }">\n<tink-grouplayer grouplayer=group>\n</tink-grouplayer>\n</div>\n</div>'),$templateCache.put("templates/search/searchResultsTemplate.html",'<div ng-if="!srchrsltsctrl.selectedResult && srchrsltsctrl.featureLayers.length > 0">\n<select ng-model=srchrsltsctrl.layerGroupFilter>\n<option value=geenfilter selected>Geen filter ({{srchrsltsctrl.features.length}})</option>\n<option ng-repeat="feat in srchrsltsctrl.featureLayers" value={{feat}}>{{feat}} ({{srchrsltsctrl.aantalFeaturesMetType(feat)}})</option>\n</select>\n<ul ng-repeat="layerGroupName in srchrsltsctrl.featureLayers">\n<tink-accordion ng-if="srchrsltsctrl.layerGroupFilter==\'geenfilter\' || srchrsltsctrl.layerGroupFilter==layerGroupName " data-start-open=true data-one-at-a-time=false>\n<tink-accordion-panel>\n<data-header>\n<p class=nav-aside-title>{{layerGroupName}} ({{srchrsltsctrl.aantalFeaturesMetType(layerGroupName)}})\n<button prevent-default ng-click=srchrsltsctrl.deleteFeatureGroup(layerGroupName) class=pull-right><i class="fa fa-trash"></i></button>\n</p>\n</data-header>\n<data-content>\n<li ng-repeat="feature in srchrsltsctrl.features | filter: { layerName:layerGroupName } :true" ng-mouseover=srchrsltsctrl.HoverOver(feature)>\n<a ng-if=!feature.hoverEdit ng-click=srchrsltsctrl.showDetails(feature)>{{ feature.displayValue | limitTo : 23}}<br>DETAILS</a>\n<div ng-if=feature.hoverEdit>\n<a ng-click=srchrsltsctrl.showDetails(feature)>{{ feature.displayValue}}\n<br>DETAILS</a>\n<a prevent-default ng-click=srchrsltsctrl.deleteFeature(feature)><i class="fa fa-trash"></i></a>\n</div>\n</li>\n</data-content>\n</tink-accordion-panel>\n</tink-accordion>\n</ul>\n<p></p><a ng-click=srchrsltsctrl.exportToCSV()>Export to CSV</a><p></p>\n</div>'),$templateCache.put("templates/search/searchSelectedTemplate.html",'<div ng-if=srchslctdctrl.selectedResult>\n<div class=row>\n<div class=col-md-4>\n<button class="pull-left srchbtn" ng-if=srchslctdctrl.prevResult ng-click=srchslctdctrl.vorige()>Vorige</button>\n</div>\n<div class=col-md-4>\n<button class=srchbtn ng-click=srchslctdctrl.delete()>Delete</button>\n</div>\n<div class=col-md-4>\n<button class="pull-right srchbtn" ng-if=srchslctdctrl.nextResult ng-click=srchslctdctrl.volgende()>Volgende</button>\n</div>\n</div>\n<div class=row ng-repeat="prop in srchslctdctrl.props">\n<div class=col-md-5> {{ prop.key}} </div>\n<div class=col-md-7 ng-if="prop.value.toLowerCase() != \'null\'">\n<a ng-if=" prop.value.indexOf( \'https://\')==0 || prop.value.indexOf( \'http://\')==0 " ng-href={{prop.value}} target=_blank>Link</a>\n<div ng-if="prop.value.indexOf( \'https://\') !=0 && prop.value.indexOf( \'http://\') !=0 ">{{ prop.value }}</div>\n</div>\n</div>\n<div class=row>\n<div class=col-md-6>\n<button class="pull-left srchbtn" ng-click=srchslctdctrl.toonFeatureOpKaart()>Tonen</button>\n</div>\n<div class=col-md-6>\n<button class="pull-right srchbtn" ng-click=srchslctdctrl.doordruk()>Buffer</button>\n<input type=number class=pull-left ng-model=srchslctdctrl.buffer>\n</div>\n</div>\n<button class=srchbtn ng-click="srchslctdctrl.close(srchslctdctrl.selectedResult) ">Terug naar resultaten</button>\n</div>'),$templateCache.put("templates/search/searchTemplate.html",'<div data-tink-nav-aside="" id=leftaside data-auto-select=true data-toggle-id=asideNavLeft class="nav-aside nav-left">\n<aside>\n<div class=nav-aside-section ng-show="srchctrl.Loading == 0">\n<tink-search-results></tink-search-results>\n<tink-search-selected></tink-search-selected>\n</div>\n<div class=nav-aside-section ng-show="srchctrl.Loading > 0">\n<div class=loader></div> {{srchctrl.MaxLoading - srchctrl.Loading}}/ {{srchctrl.MaxLoading}}\n</div>\n</aside>\n</div>')}]);
//# sourceMappingURL=tink-gis-angular.min.js.map